"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}function square(){var e,t=[1,1],n=arguments,r=n[0];return r&&Number.isFinite(r)&&(t=[r,r]),r&&r.length&&(t=n[0],r=n[1]),r&&r.size&&r.size.length&&(t=r.size),e=[t[0]/2,t[1]/2],r&&!0===r.center&&(e=[0,0]),_jscad_csg.CAG.rectangle({center:e,radius:[t[0]/2,t[1]/2]})}function circle(){var e,t=1,n=32,r=arguments,o=r[0];return o&&o.r&&(t=o.r),o&&o.fn&&(n=o.fn),!o||o.r||o.fn||o.center||(t=o),e=[t,t],o&&!0===o.center&&(e=[0,0]),_jscad_csg.CAG.circle({center:e,radius:t,resolution:n})}function polygon(e){var t=[];if(e.paths&&e.paths.length&&e.paths[0].length)for(var n=0;n<e.paths.length;n++)for(var r=0;r<e.paths[n].length;r++)t[r]=e.points[e.paths[n][r]];else if(e.paths&&e.paths.length)for(var r=0;r<e.paths.length;r++)t[r]=e.points[e.paths[r]];else t=e.length?e:e.points;return _jscad_csg.CAG.fromPoints(t)}function triangle(){var e=arguments;return e[0]&&e[0].length&&(e=e[0]),_jscad_csg.CAG.fromPoints(e)}function linear_extrude(e,t){var n=1,r=0,o=0,i=10;e.height&&(n=e.height),e.twist&&(o=e.twist),e.slices&&(i=e.slices);var s=t.extrude({offset:[0,0,n],twistangle:o,twiststeps:i});if(!0===e.center){var a=[];a=s.getBounds(),r=a[1].plus(a[0]),r=r.times(-.5),s=s.translate(r)}return s}function rotate_extrude(e,t){var n=32;arguments.length<2?t=e:void 0!==e&&(n=e.fn),n<3&&(n=3);for(var r=[],o=0;o<n;o++)for(var i=0;i<t.sides.length;i++){var s,e=[];s=new _jscad_csg.CSG.Matrix4x4.rotationZ(o/n*360),e[0]=new _jscad_csg.CSG.Vector3D(t.sides[i].vertex0.pos.x,0,t.sides[i].vertex0.pos.y),e[0]=s.rightMultiply1x3Vector(e[0]),e[1]=new _jscad_csg.CSG.Vector3D(t.sides[i].vertex1.pos.x,0,t.sides[i].vertex1.pos.y),e[1]=s.rightMultiply1x3Vector(e[1]),s=new _jscad_csg.CSG.Matrix4x4.rotationZ((o+1)/n*360),e[2]=new _jscad_csg.CSG.Vector3D(t.sides[i].vertex1.pos.x,0,t.sides[i].vertex1.pos.y),e[2]=s.rightMultiply1x3Vector(e[2]),e[3]=new _jscad_csg.CSG.Vector3D(t.sides[i].vertex0.pos.x,0,t.sides[i].vertex0.pos.y),e[3]=s.rightMultiply1x3Vector(e[3]);var a=new _jscad_csg.CSG.Polygon([new _jscad_csg.CSG.Vertex(e[0]),new _jscad_csg.CSG.Vertex(e[1]),new _jscad_csg.CSG.Vertex(e[2]),new _jscad_csg.CSG.Vertex(e[3])]);r.push(a)}return _jscad_csg.CSG.fromPolygons(r)}function rectangular_extrude(e,t){var n=1,r=1,o=8,i=!1,s=!0;return t&&(t.w&&(n=t.w),t.h&&(r=t.h),t.fn&&(o=t.fn),void 0!==t.closed&&(i=t.closed),void 0!==t.round&&(s=t.round)),new _jscad_csg.CSG.Path2D(e,i).rectangularExtrude(n,r,o,s)}function cube(e){var t=1,n=null,r=[0,0,0],o=!1,i=0,s=8;e&&e.length&&(n=e),e&&e.size&&e.size.length&&(n=e.size),e&&e.size&&!e.size.length&&(t=e.size),e&&"object"!=typeof e&&(t=e),e&&1==e.round&&(o=!0,i=n&&n.length?(n[0]+n[1]+n[2])/30:t/10),e&&e.radius&&(o=!0,i=e.radius),e&&e.fn&&(s=e.fn);var a=t,l=t,c=t;n&&n.length&&(a=n[0],l=n[1],c=n[2]),r=[a/2,l/2,c/2];var u=o?_jscad_csg.CSG.roundedCube({radius:[a/2,l/2,c/2],roundradius:i,resolution:s}):_jscad_csg.CSG.cube({radius:[a/2,l/2,c/2]});return e&&e.center&&e.center.length?r=[e.center[0]?0:a/2,e.center[1]?0:l/2,e.center[2]?0:c/2]:e&&1==e.center?r=[0,0,0]:e&&0==e.center&&(r=[a/2,l/2,c/2]),(r[0]||r[1]||r[2])&&(u=u.translate(r)),u}function sphere(e){var t=1,n=32,r=[0,0,0],o="normal";e&&e.r&&(t=e.r),e&&e.fn&&(n=e.fn),e&&e.type&&(o=e.type),e&&"object"!=typeof e&&(t=e),r=[0,0,0];var i;return i="geodesic"==o?geodesicSphere(e):_jscad_csg.CSG.sphere({radius:t,resolution:n}),e&&e.center&&e.center.length?r=[e.center[0]?0:t,e.center[1]?0:t,e.center[2]?0:t]:e&&1==e.center?r=[0,0,0]:e&&0==e.center&&(r=[t,t,t]),(r[0]||r[1]||r[2])&&(i=i.translate(r)),i}function geodesicSphere(e){var t=1,n=5,r=[[.850651,0,-.525731],[.850651,-0,.525731],[-.850651,-0,.525731],[-.850651,0,-.525731],[0,-.525731,.850651],[0,.525731,.850651],[0,.525731,-.850651],[0,-.525731,-.850651],[-.525731,-.850651,-0],[.525731,-.850651,-0],[.525731,.850651,0],[-.525731,.850651,0]],o=[[0,9,1],[1,10,0],[6,7,0],[10,6,0],[7,9,0],[5,1,4],[4,1,9],[5,10,1],[2,8,3],[3,11,2],[2,5,4],[4,8,2],[2,11,5],[3,7,6],[6,11,3],[8,7,3],[9,8,4],[11,10,5],[10,11,6],[8,9,7]],i=function(e,t,n){for(var r=1-n,o=[],i=0;i<3;i++)o[i]=e[i]*r+t[i]*n;return o};e&&(e.fn&&(n=Math.floor(e.fn/6)),e.r&&(t=e.r)),n<=0&&(n=1);for(var s=[],a=[],l=0,c=0;c<o.length;c++){var u=function(e,t,n){for(var r=e[0],o=e[1],s=e[2],a=n,l=[],c=[],u=0;u<t;u++)for(var h=0;h<t-u;h++){var p=u/t,f=(u+1)/t,d=h/(t-u),g=(h+1)/(t-u),m=t-u-1?h/(t-u-1):1,v=[];v[0]=i(i(r,o,d),s,p),v[1]=i(i(r,o,g),s,p),v[2]=i(i(r,o,m),s,f);for(var C=0;C<3;C++)for(var S=Math.sqrt(v[C][0]*v[C][0]+v[C][1]*v[C][1]+v[C][2]*v[C][2]),y=0;y<3;y++)v[C][y]/=S;if(l.push(v[0],v[1],v[2]),c.push([a,a+1,a+2]),a+=3,h<t-u-1){var w=t-u-1?(h+1)/(t-u-1):1;v[0]=i(i(r,o,g),s,p),v[1]=i(i(r,o,w),s,f),v[2]=i(i(r,o,m),s,f);for(var C=0;C<3;C++)for(var S=Math.sqrt(v[C][0]*v[C][0]+v[C][1]*v[C][1]+v[C][2]*v[C][2]),y=0;y<3;y++)v[C][y]/=S;l.push(v[0],v[1],v[2]),c.push([a,a+1,a+2]),a+=3}}return{points:l,triangles:c,off:a}}([r[o[c][0]],r[o[c][1]],r[o[c][2]]],n,l);s=s.concat(u.points),a=a.concat(u.triangles),l=u.off}return polyhedron({points:s,triangles:a}).scale(t)}function cylinder(e){var t=1,n=1,r=1,o=32,i=!1,s=arguments,a=[0,0,0];e&&e.d&&(t=n=e.d/2),e&&e.r&&(t=e.r,n=e.r),e&&e.h&&(r=e.h),e&&(e.r1||e.r2)&&(t=e.r1,n=e.r2,e.h&&(r=e.h)),e&&(e.d1||e.d2)&&(t=e.d1/2,n=e.d2/2),s&&s[0]&&s[0].length&&(s=s[0],t=s[0],n=s[1],r=s[2],4===s.length&&(o=s[3])),e&&e.fn&&(o=e.fn),e&&!0===e.round&&(i=!0);var l;if(e&&e.start&&e.end)l=i?_jscad_csg.CSG.roundedCylinder({start:e.start,end:e.end,radiusStart:t,radiusEnd:n,resolution:o}):_jscad_csg.CSG.cylinder({start:e.start,end:e.end,radiusStart:t,radiusEnd:n,resolution:o});else{l=i?_jscad_csg.CSG.roundedCylinder({start:[0,0,0],end:[0,0,r],radiusStart:t,radiusEnd:n,resolution:o}):_jscad_csg.CSG.cylinder({start:[0,0,0],end:[0,0,r],radiusStart:t,radiusEnd:n,resolution:o});var c=t>n?t:n;e&&e.center&&e.center.length?a=[e.center[0]?0:c,e.center[1]?0:c,e.center[2]?-r/2:0]:e&&!0===e.center?a=[0,0,-r/2]:e&&!1===e.center&&(a=[0,0,0]),(a[0]||a[1]||a[2])&&(l=l.translate(a))}return l}function torus(e){var t=1,n=4,r=16,o=32,i=0;e&&(e.ri&&(t=e.ri),e.fni&&(r=e.fni),e.roti&&(i=e.roti),e.ro&&(n=e.ro),e.fno&&(o=e.fno)),r<3&&(r=3),o<3&&(o=3);var s=circle({r:t,fn:r,center:!0});return i&&(s=s.rotateZ(i)),rotate_extrude({fn:o},s.translate([n,0,0]))}function polyhedron(e){for(var t=[],n=e.triangles||e.polygons,r=e.colors||null,o=0;o<n.length;o++){for(var i=[],s=0;s<n[o].length;s++)i[s]=e.points[n[o][s]];var a=[];for(s=n[o].length-1;s>=0;s--)a.push(new _jscad_csg.CSG.Vertex(new _jscad_csg.CSG.Vector3D(i[s][0],i[s][1],i[s][2])));var l=_jscad_csg.CSG.Polygon.defaultShared;r&&r[o]&&(l=_jscad_csg.CSG.Polygon.Shared.fromColor(r[o])),t.push(new _jscad_csg.CSG.Polygon(a,l))}return _jscad_csg.CSG.fromPolygons(t)}function union(){var e,t=0,n=arguments;for(n[0].length&&(n=n[0]),e=n[t++];t<n.length;t++){var r=n[t];e=e.union(r)}return e}function difference(){var e,t=0,n=arguments;for(n[0].length&&(n=n[0]),e=n[t++];t<n.length;t++)e=n[t]instanceof _jscad_csg.CAG?e.subtract(n[t]):e.subtract(n[t].setColor(1,1,0));return e}function intersection(){var e,t=0,n=arguments;for(n[0].length&&(n=n[0]),e=n[t++];t<n.length;t++)e=n[t]instanceof _jscad_csg.CAG?e.intersect(n[t]):e.intersect(n[t].setColor(1,1,0));return e}function translate(){var e,t=arguments,n=t[0],r=1;for(t[1].length&&(t=t[1],r=0),e=t[r++];r<t.length;r++)e=e.union(t[r]);return e.translate(n)}function center(){var e,t=arguments,n=t[0],r=1;for(t[1].length&&(t=t[1],r=0),e=t[r++];r<t.length;r++)e=e.union(t[r]);return e.center(n)}function scale(){var e,t=arguments,n=t[0],r=1;for(t[1].length&&(t=t[1],r=0),e=t[r++];r<t.length;r++)e=e.union(t[r]);return e.scale(n)}function rotate(){var e,t,n,r=1,o=arguments;for(o[0].length?(n=o[0],t=1,o[1].length&&(o=o[1],t=0)):(r=o[0],n=o[1],t=2,o[2].length&&(o=o[2],t=0)),e=o[t++];t<o.length;t++)e=e.union(o[t]);return 1!=r?e.rotateX(n[0]*r).rotateY(n[1]*r).rotateZ(n[2]*r):e.rotateX(n[0]).rotateY(n[1]).rotateZ(n[2])}function mirror(e,t){for(var n=Array.prototype.slice.call(arguments,1,arguments.length),t=n[0],r=1;r<n.length;r++)t=t.union(n[r]);var o=new _jscad_csg.CSG.Plane(new _jscad_csg.CSG.Vector3D(e[0],e[1],e[2]).unit(),0);return t.mirrored(o)}function expand(e,t,n){return n.expand(e,t)}function contract(e,t,n){return n.contract(e,t)}function multmatrix(e,t){console.log("multmatrix() not yet implemented")}function minkowski(){console.log("minkowski() not yet implemented")}function hull(){var e=[],t=arguments;t[0].length&&(t=t[0]);for(var n=[],r=0;r<t.length;r++){var o=t[r];if(!(o instanceof _jscad_csg.CAG))throw"ERROR: hull() accepts only 2D forms / CAG";for(var i=0;i<o.sides.length;i++){var s=o.sides[i].vertex0.pos.x,a=o.sides[i].vertex0.pos.y;n[s+","+a]||(e.push({x:s,y:a}),n[s+","+a]++)}}var l=function(e,t,n){this.index=e,this.angle=t,this.distance=n,this.compare=function(e){return this.angle<e.angle?-1:this.angle>e.angle?1:this.distance<e.distance?-1:this.distance>e.distance?1:0}},c=function(){this.points=null,this.indices=null,this.getIndices=function(){return this.indices},this.clear=function(){this.indices=null,this.points=null},this.ccw=function(e,t,n){var r=(this.points[t].x-this.points[e].x)*(this.points[n].y-this.points[e].y)-(this.points[t].y-this.points[e].y)*(this.points[n].x-this.points[e].x);return r<1e-5?0:r},this.angle=function(e,t){return Math.atan2(this.points[t].y-this.points[e].y,this.points[t].x-this.points[e].x)},this.distance=function(e,t){return(this.points[t].x-this.points[e].x)*(this.points[t].x-this.points[e].x)+(this.points[t].y-this.points[e].y)*(this.points[t].y-this.points[e].y)},this.compute=function(e){var t=this;if(this.indices=null,!(e.length<3)){this.points=e;for(var n=0,r=1;r<this.points.length;r++)t.points[r].y==t.points[n].y?t.points[r].x<t.points[n].x&&(n=r):t.points[r].y<t.points[n].y&&(n=r);var o=new Array,i=0,s=0;for(r=0;r<this.points.length;r++)r!=n&&(i=t.angle(n,r),i<0&&(i+=Math.PI),s=t.distance(n,r),o.push(new l(r,i,s)));o.sort(function(e,t){return e.compare(t)});var a=new Array(this.points.length+1),c=2;for(r=0;r<this.points.length;r++)r!=n&&(a[c]=o[c-2].index,c++);a[0]=a[this.points.length],a[1]=n;var u,h=2;for(r=3;r<=this.points.length;r++){for(;this.ccw(a[h-1],a[h],a[r])<=0;)h--;h++,u=a[r],a[r]=a[h],a[h]=u}for(this.indices=new Array(h),r=0;r<h;r++)t.indices[r]=a[r+1]}}},u=new c;u.compute(e);var h=u.getIndices();if(h&&h.length>0){for(var p=[],r=0;r<h.length;r++)p.push(e[h[r]]);return _jscad_csg.CAG.fromPoints(p)}}function chain_hull(){var e=arguments,t=0,n=!1;void 0!==e[t].closed&&(n=e[t++].closed),e[t].length&&(e=e[t]);for(var r=[],o=e.length-(n?0:1),i=0;i<o;i++)r.push(hull(e[i],e[(i+1)%e.length]));return union(r)}function css2rgb(e){return cssColors[e.toLowerCase()]}function color(){var e,t=1,n=arguments,r=n[0];for("string"==typeof r&&(r=css2rgb(r)),Number.isFinite(n[t])&&(r=r.concat(n[t]),t++),Array.isArray(n[t])&&(n=n[t],t=0),e=n[t++];t<n.length;t++)e=e.union(n[t]);return e.setColor(r)}function rgb2hsl(e,t,n){e.length&&(n=e[2],t=e[1],e=e[0]);var r,o,i=Math.max(e,t,n),s=Math.min(e,t,n),a=(i+s)/2;if(i==s)r=o=0;else{var l=i-s;switch(o=a>.5?l/(2-i-s):l/(i+s),i){case e:r=(t-n)/l+(t<n?6:0);break;case t:r=(n-e)/l+2;break;case n:r=(e-t)/l+4}r/=6}return[r,o,a]}function hsl2rgb(e,t,n){function r(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}e.length&&(n=e[2],t=e[1],e=e[0]);var o,i,s;if(0==t)o=i=s=n;else{var a=n<.5?n*(1+t):n+t-n*t,l=2*n-a;o=r(l,a,e+1/3),i=r(l,a,e),s=r(l,a,e-1/3)}return[o,i,s]}function rgb2hsv(e,t,n){e.length&&(n=e[2],t=e[1],e=e[0]);var r,o,i=Math.max(e,t,n),s=Math.min(e,t,n),a=i,l=i-s;if(o=0==i?0:l/i,i==s)r=0;else{switch(i){case e:r=(t-n)/l+(t<n?6:0);break;case t:r=(n-e)/l+2;break;case n:r=(e-t)/l+4}r/=6}return[r,o,a]}function hsv2rgb(e,t,n){e.length&&(n=e[2],t=e[1],e=e[0]);var r,o,i,s=Math.floor(6*e),a=6*e-s,l=n*(1-t),c=n*(1-a*t),u=n*(1-(1-a)*t);switch(s%6){case 0:r=n,o=u,i=l;break;case 1:r=c,o=n,i=l;break;case 2:r=l,o=n,i=u;break;case 3:r=l,o=c,i=n;break;case 4:r=u,o=l,i=n;break;case 5:r=n,o=l,i=c}return[r,o,i]}function html2rgb(e){var t=0,n=0,r=0;return 7==e.length&&(t=parseInt("0x"+e.slice(1,3))/255,n=parseInt("0x"+e.slice(3,5))/255,r=parseInt("0x"+e.slice(5,7))/255),[t,n,r]}function rgb2html(e,t,n){return e.length&&(n=e[2],t=e[1],e=e[0]),"#"+Number(16777216+255*e*65536+255*t*256+255*n).toString(16).substring(1,7)}function sin(e){return Math.sin(e/360*Math.PI*2)}function cos(e){return Math.cos(e/360*Math.PI*2)}function asin(e){return Math.asin(e)/(2*Math.PI)*360}function acos(e){return Math.acos(e)/(2*Math.PI)*360}function tan(e){return Math.tan(e/360*Math.PI*2)}function atan(e){return Math.atan(e)/(2*Math.PI)*360}function atan2(e,t){return Math.atan2(e,t)/(2*Math.PI)*360}function ceil(e){return Math.ceil(e)}function floor(e){return Math.floor(e)}function abs(e){return Math.abs(e)}function min(e,t){return e<t?e:t}function max(e,t){return e>t?e:t}function rands(e,t,n,r){for(var o=new Array(n),i=0;i<n;i++)o[i]=Math.random()*(t-e)+e}function log(e){return Math.log(e)}function lookup(e,t){for(var n=0,r=0;r<t.length;r++){var o=t[r];if(o[0]>=e){r--,o=t[r];var i=t[r+1],s=0;return o[0]!==i[0]&&(s=abs((e-o[0])/(i[0]-o[0]))),n=s>0?o[1]*(1-s)+i[1]*s:o[1]}}return n}function pow(e,t){return Math.pow(e,t)}function sign(e){return e<0?-1:e>1?1:0}function sqrt(e){return Math.sqrt(e)}function round(e){return floor(e+.5)}function vector_char(e,t,n){if(n=n.charCodeAt(0),(n-=32)<0||n>=95)return{width:0,segments:[]};for(var r=112*n,o=simplexFont[r++],i=simplexFont[r++],s=[],a=[],l=0;l<o;l++){var c=simplexFont[r+2*l],u=simplexFont[r+2*l+1];-1==c&&-1==u?(a.push(s),s=[]):s.push([c+e,u+t])}return s.length&&a.push(s),{width:i,segments:a}}function vector_text(e,t,n){for(var r=[],o=e,i=0;i<n.length;i++){var s=n.charAt(i);if("\n"==s)e=o,t-=30;else{var a=vector_char(e,t,s);e+=a.width,r=r.concat(a.segments)}}return r}function echo(){console.warn("echo() will be deprecated in the near future: please use console.log/warn/error instead");for(var e="",t=arguments,n=0;n<t.length;n++)n&&(e+=", "),e+=t[n];console.log(e)}function log$1(e){var t=Date.now(),n=void 0;n||(n=t);var r=t-n;if(log$1.prevLogTime=t,e="["+(.001*r).toFixed(3)+"] "+e,"object"==typeof console&&"function"==typeof console.log)console.log(e);else{if("object"!=typeof self||"function"!=typeof self.postMessage)throw new Error("Cannot log");self.postMessage({cmd:"log",txt:e})}}function createCommonjsModule(e,t){return t={exports:{}},e(t,t.exports),t.exports}function fnNumberSort(e,t){return e-t}function insertSorted(e,t,n){for(var r=0,o=e.length;o>r;){var i=Math.floor((r+o)/2);n(t,e[i])>0?r=i+1:o=i}e.splice(r,0,t)}function fnSortByIndex(e,t){return e.index-t.index}function toArray(e){return e?e.constructor!==Array?[e]:e:[]}function convertToBlob(e,t){var n=t.format,r=t.formatInfo,o=t.version;void 0===o&&(o="0.0.0");var i;if("jscad"===n)i=e;else{e=toArray(e);for(var s=!1,a=!1,l=0;l<e.length;l++)e[l]instanceof _jscad_csg.CSG&&(s=!0),e[l]instanceof _jscad_csg.CAG&&(a=!0);s=s&&r.convertCSG,a=a&&r.convertCAG,s&&a&&(a=!1),i=s?new _jscad_csg.CSG:new _jscad_csg.CAG;for(var c=0;c<e.length;c++)!0===s&&e[c]instanceof _jscad_csg.CAG?i=i.union(e[c].extrude({offset:[0,0,.1]})):!0===a&&e[c]instanceof _jscad_csg.CSG||(i=i.union(e[c]))}var u={producer:"OpenJSCAD.org "+o,date:new Date},h={amf:function(e){return index_6(e,u)},stl:function(e){return index_8(e,{version:o})},stla:function(e){return index_8(e,{version:o})},stlb:function(e){return index_9(e,{webBlob:!0,version:o})},dxf:function(e){return index_3(e,{version:o})},svg:function(e){return index_5(e,{version:o})},x3d:function(e){return index_10(e.fixTJunctions(),{version:o})},json:function(e){return index_4(e,{version:o})},js:function(e){return e},jscad:function(e){return e},undefined:function(){throw new Error("Not supported : only jscad, stl, amf, dxf, svg or json as output format")}},p=h[n](i);return"jscad"===n&&(p=new Blob$1([p],{type:r.mimetype})),p}function createJscadFunction(e,t){var n="";Object.keys(t).forEach(function(e){var r=t[e];Object.keys(r).forEach(function(t){var o=r[t];Object.keys(o).forEach(function(r){n+="const "+r+" = globals['"+e+"']['"+t+"']['"+r+"']\n"})})});var r="// SYNC WORKER\n    "+n+"\n\n    //user defined script(s)\n    "+e+"\n\n    if (typeof (main) !== 'function') {\n      throw new Error('The JSCAD script must contain a function main() which returns one or more CSG or CAG solids.')\n    }\n\n    return main(params)\n  ";return new Function("params","include","globals",r)}function replaceIncludes(e,t,n,r){var o=r.memFs,i=r.includeResolver;return new Promise(function(r,s){var a=astFromSource(e),l=findIncludes(a).map(function(e){return e.value}),c=l.map(function(e,r){return i(t,e,o).then(function(r){return replaceIncludes(r,t,n+"/"+e,{memFs:o,includeResolver:i})}).then(function(t){return t.moduleCache[e]=t.source,t})});Promise.all(c).then(function(t){var o=e,i=t.reduce(function(e,t){return Object.keys(t.moduleCache).forEach(function(n){e[n]=t.moduleCache[n]}),e},{});if(""===n){o="globals['includedFiles'] || (globals['includedFiles'] = {})\nglobals['includesSource'] || (globals['includesSource'] = {})\nif (!globals['originalIncludeFunction']) {\n  globals['originalIncludeFunction'] = include\n  include = function(file) {\n    if (!globals['includedFiles'][file]) {\n      globals['includesSource'][file]()\n      globals['includedFiles'][file] = true\n    }\n  }\n}\n"+Object.keys(i).map(function(e){return"globals['includesSource']['"+e+"'] = function() {"+i[e]+"}"}).join("\n")+"\n"+o+"\n"}r({source:o,moduleCache:i})}).catch(s)})}function isInclude(e){return"CallExpression"===e.type&&e.callee&&e.callee.name&&"include"===e.callee.name}function astFromSource(e,t){var n={loc:!0,range:!0,tolerant:!0};t=Object.assign({},n,t);var r;try{r=esprima.parse(e,t)}catch(e){console.error("failed to generate ast:",e),r={}}return r}function findIncludes(e){var t=[];return estraverse.traverse(e,{enter:function(e,n){if(isInclude(e)){if(e.arguments&&arguments.length>0){var r=e.arguments[0],o=r.raw,i=r.value;t.push({raw:o,value:i})}return estraverse.VisitorOption.Skip}}}),t}function resolveIncludes(e,t,n){return new Promise(function(r,o){if("object"==typeof n)for(var i in n)if(n[i].fullpath===t||"./"+n[i].fullpath===t||n[i].name===t)return void r(n[i].source);var s=new XMLHttpRequest,a=e+t;t.match(/^(https:|http:)/i)&&(a=t),s.open("GET",a,!0),s.onload=function(e){var t=""+e.currentTarget.status;t.length>0&&"2"===t[0]?r(this.responseText):o(this.responseText)},s.onerror=function(e){o(e)},s.send()})}function rebuildSolid(e,t,n,r,o){var i=t;i.lastIndexOf("/")>=0&&(i=i.substring(0,i.lastIndexOf("/")+1));var s={implicitGlobals:!0,memFs:void 0,includeResolver:resolveIncludes};return o=Object.assign({},s,o),replaceIncludes(e,i,"",{includeResolver:o.includeResolver,memFs:o.memFs}).then(function(e){var t=e.source,i=o.implicitGlobals?o.globals?o.globals:{oscad:exportedApi}:{},s=createJscadFunction(t,i),a=function(e){return e};try{var l=s(n,a,i);if(l=toArray(l),0===l.length)throw new Error("The JSCAD script must return one or more CSG or CAG solids.");r(void 0,l)}catch(e){r(e,void 0)}}).catch(function(e){return r(e,void 0)}),{cancel:function(){console.log("cannot stop work in main thread, sorry")}}}function resolveIncludesFs(e,t,n){return new Promise(function(n,r){var o=path.resolve(e,t);console.log("relpath",e,"scriptPath",t,"fullPath",o),fs.readFile(o,"UTF8",function(e,t){return e?r(e):n(t)})})}function compile(e,t,n){t=t||{};var r={implicitGlobals:!0,rootPath:""};n=Object.assign({},r,n);var o=n.implicitGlobals,i=n.rootPath,s={};return o&&(s.oscad=exportedApi),new Promise(function(n,r){rebuildSolid(e,i,t,function(e,t){if(!e)return n(t);r(e)},{implicitGlobals:o,globals:s,includeResolver:resolveIncludesFs})})}function generateOutput(e,t){return convertToBlob(t,{format:e,formatInfo:{convertCAG:!0,convertCSG:!0}})}var _jscad_csg=require("@jscad/csg"),stream=_interopDefault(require("stream")),string_decoder=_interopDefault(require("string_decoder")),fs=_interopDefault(require("fs")),path=_interopDefault(require("path")),primitives2d=Object.freeze({square:square,circle:circle,polygon:polygon,triangle:triangle}),extrusions=Object.freeze({linear_extrude:linear_extrude,rotate_extrude:rotate_extrude,rectangular_extrude:rectangular_extrude}),primitives3d=Object.freeze({cube:cube,sphere:sphere,geodesicSphere:geodesicSphere,cylinder:cylinder,torus:torus,polyhedron:polyhedron}),booleanOps=Object.freeze({union:union,difference:difference,intersection:intersection}),transformations=Object.freeze({translate:translate,center:center,scale:scale,rotate:rotate,mirror:mirror,expand:expand,contract:contract,multmatrix:multmatrix,minkowski:minkowski,hull:hull,chain_hull:chain_hull}),cssColors={black:[0,0,0],silver:[192/255,192/255,192/255],gray:[128/255,128/255,128/255],white:[1,1,1],maroon:[128/255,0,0],red:[1,0,0],purple:[128/255,0,128/255],fuchsia:[1,0,1],green:[0,128/255,0],lime:[0,1,0],olive:[128/255,128/255,0],yellow:[1,1,0],navy:[0,0,128/255],blue:[0,0,1],teal:[0,128/255,128/255],aqua:[0,1,1],aliceblue:[240/255,248/255,1],antiquewhite:[250/255,235/255,215/255],aquamarine:[127/255,1,212/255],azure:[240/255,1,1],beige:[245/255,245/255,220/255],bisque:[1,228/255,196/255],blanchedalmond:[1,235/255,205/255],blueviolet:[138/255,43/255,226/255],brown:[165/255,42/255,42/255],burlywood:[222/255,184/255,135/255],cadetblue:[95/255,158/255,160/255],chartreuse:[127/255,1,0],chocolate:[210/255,105/255,30/255],coral:[1,127/255,80/255],cornflowerblue:[100/255,149/255,237/255],cornsilk:[1,248/255,220/255],crimson:[220/255,20/255,60/255],cyan:[0,1,1],darkblue:[0,0,139/255],darkcyan:[0,139/255,139/255],darkgoldenrod:[184/255,134/255,11/255],darkgray:[169/255,169/255,169/255],darkgreen:[0,100/255,0],darkgrey:[169/255,169/255,169/255],darkkhaki:[189/255,183/255,107/255],darkmagenta:[139/255,0,139/255],darkolivegreen:[85/255,107/255,47/255],darkorange:[1,140/255,0],darkorchid:[.6,50/255,.8],darkred:[139/255,0,0],darksalmon:[233/255,150/255,122/255],darkseagreen:[143/255,188/255,143/255],darkslateblue:[72/255,61/255,139/255],darkslategray:[47/255,79/255,79/255],darkslategrey:[47/255,79/255,79/255],darkturquoise:[0,206/255,209/255],darkviolet:[148/255,0,211/255],deeppink:[1,20/255,147/255],deepskyblue:[0,191/255,1],dimgray:[105/255,105/255,105/255],dimgrey:[105/255,105/255,105/255],dodgerblue:[30/255,144/255,1],firebrick:[178/255,34/255,34/255],floralwhite:[1,250/255,240/255],forestgreen:[34/255,139/255,34/255],gainsboro:[220/255,220/255,220/255],ghostwhite:[248/255,248/255,1],gold:[1,215/255,0],goldenrod:[218/255,165/255,32/255],greenyellow:[173/255,1,47/255],grey:[128/255,128/255,128/255],honeydew:[240/255,1,240/255],hotpink:[1,105/255,180/255],indianred:[205/255,92/255,92/255],indigo:[75/255,0,130/255],ivory:[1,1,240/255],khaki:[240/255,230/255,140/255],lavender:[230/255,230/255,250/255],lavenderblush:[1,240/255,245/255],lawngreen:[124/255,252/255,0],lemonchiffon:[1,250/255,205/255],lightblue:[173/255,216/255,230/255],lightcoral:[240/255,128/255,128/255],lightcyan:[224/255,1,1],lightgoldenrodyellow:[250/255,250/255,210/255],lightgray:[211/255,211/255,211/255],lightgreen:[144/255,238/255,144/255],lightgrey:[211/255,211/255,211/255],lightpink:[1,182/255,193/255],lightsalmon:[1,160/255,122/255],lightseagreen:[32/255,178/255,170/255],lightskyblue:[135/255,206/255,250/255],lightslategray:[119/255,136/255,.6],lightslategrey:[119/255,136/255,.6],lightsteelblue:[176/255,196/255,222/255],lightyellow:[1,1,224/255],limegreen:[50/255,205/255,50/255],linen:[250/255,240/255,230/255],magenta:[1,0,1],mediumaquamarine:[.4,205/255,170/255],mediumblue:[0,0,205/255],mediumorchid:[186/255,85/255,211/255],mediumpurple:[147/255,112/255,219/255],mediumseagreen:[60/255,179/255,113/255],mediumslateblue:[123/255,104/255,238/255],mediumspringgreen:[0,250/255,154/255],mediumturquoise:[72/255,209/255,.8],mediumvioletred:[199/255,21/255,133/255],midnightblue:[25/255,25/255,112/255],mintcream:[245/255,1,250/255],mistyrose:[1,228/255,225/255],moccasin:[1,228/255,181/255],navajowhite:[1,222/255,173/255],oldlace:[253/255,245/255,230/255],olivedrab:[107/255,142/255,35/255],orange:[1,165/255,0],orangered:[1,69/255,0],orchid:[218/255,112/255,214/255],palegoldenrod:[238/255,232/255,170/255],palegreen:[152/255,251/255,152/255],paleturquoise:[175/255,238/255,238/255],palevioletred:[219/255,112/255,147/255],papayawhip:[1,239/255,213/255],peachpuff:[1,218/255,185/255],peru:[205/255,133/255,63/255],pink:[1,192/255,203/255],plum:[221/255,160/255,221/255],powderblue:[176/255,224/255,230/255],rosybrown:[188/255,143/255,143/255],royalblue:[65/255,105/255,225/255],saddlebrown:[139/255,69/255,19/255],salmon:[250/255,128/255,114/255],sandybrown:[244/255,164/255,96/255],seagreen:[46/255,139/255,87/255],seashell:[1,245/255,238/255],sienna:[160/255,82/255,45/255],skyblue:[135/255,206/255,235/255],slateblue:[106/255,90/255,205/255],slategray:[112/255,128/255,144/255],slategrey:[112/255,128/255,144/255],snow:[1,250/255,250/255],springgreen:[0,1,127/255],steelblue:[70/255,130/255,180/255],tan:[210/255,180/255,140/255],thistle:[216/255,191/255,216/255],tomato:[1,99/255,71/255],turquoise:[64/255,224/255,208/255],violet:[238/255,130/255,238/255],wheat:[245/255,222/255,179/255],whitesmoke:[245/255,245/255,245/255],yellowgreen:[154/255,205/255,50/255]},color$1=Object.freeze({css2rgb:css2rgb,color:color,rgb2hsl:rgb2hsl,hsl2rgb:hsl2rgb,rgb2hsv:rgb2hsv,hsv2rgb:hsv2rgb,html2rgb:html2rgb,rgb2html:rgb2html}),maths=Object.freeze({sin:sin,cos:cos,asin:asin,acos:acos,tan:tan,atan:atan,atan2:atan2,ceil:ceil,floor:floor,abs:abs,min:min,max:max,rands:rands,log:log,lookup:lookup,pow:pow,sign:sign,sqrt:sqrt,round:round
}),simplexFont=[0,16,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,10,5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,16,4,21,4,14,-1,-1,12,21,12,14,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,21,11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,26,20,8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,31,24,21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,34,26,23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,5,19,4,20,5,21,6,20,6,18,5,16,4,15,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,14,11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,14,3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,16,8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,26,13,18,13,0,-1,-1,4,9,22,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,10,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,26,4,9,22,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,10,5,2,4,1,5,0,6,1,5,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,22,20,25,2,-7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,17,20,9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,20,6,17,8,18,11,21,11,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,14,20,4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,15,20,5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,20,13,21,3,7,18,7,-1,-1,13,21,13,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,17,20,15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,20,16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,20,17,21,7,0,-1,-1,3,21,17,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,29,20,8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,20,16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,10,5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,14,10,5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,24,20,18,4,9,20,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,26,4,12,22,12,-1,-1,4,6,22,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,24,4,18,20,9,4,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,20,18,3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,27,18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5,8,18,9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,21,4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,18,21,18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,15,21,4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,19,4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,18,4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,22,21,18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,22,4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,4,21,4,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,16,12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,21,4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,17,4,21,4,0,-1,-1,4,0,16,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,24,4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,22,4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,22,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13,21,4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,22,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,16,21,4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,20,20,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,16,8,21,8,0,-1,-1,1,21,15,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,22,4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,18,1,21,9,0,-1,-1,17,21,9,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,24,2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,20,3,21,17,0,-1,-1,17,21,3,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,18,1,21,9,11,9,0,-1,-1,17,21,9,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,20,17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,14,4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,14,0,21,14,-3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,14,9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,16,6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,16,0,-2,16,-2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,6,21,5,20,4,18,4,16,5,15,6,16,5,17,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,17,19,15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,17,19,4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,14,18,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,17,19,15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,17,18,3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,12,10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,22,19,15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,19,4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,8,3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,10,5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,17,4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,4,21,4,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,18,30,4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,19,4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,17,19,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,17,19,4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,17,19,15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,13,4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,17,17,14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,12,5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,19,4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,16,2,14,8,0,-1,-1,14,14,8,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,22,3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,17,3,14,14,0,-1,-1,14,14,3,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,16,2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,17,14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,39,14,9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,4,25,4,-7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,39,14,5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,24,3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],text=Object.freeze({vector_char:vector_char,vector_text:vector_text}),sprintf=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function t(e,t){for(var n=[];t>0;n[--t]=e);return n.join("")}var n=function(){return n.cache.hasOwnProperty(arguments[0])||(n.cache[arguments[0]]=n.parse(arguments[0])),n.format.call(null,n.cache[arguments[0]],arguments)};return n.format=function(n,r){var o,i,s,a,l,c,u,h=1,p=n.length,f="",d=[];for(i=0;i<p;i++)if("string"===(f=e(n[i])))d.push(n[i]);else if("array"===f){if(a=n[i],a[2])for(o=r[h],s=0;s<a[2].length;s++){if(!o.hasOwnProperty(a[2][s]))throw sprintf('[sprintf] property "%s" does not exist',a[2][s]);o=o[a[2][s]]}else o=a[1]?r[a[1]]:r[h++];if(/[^s]/.test(a[8])&&"number"!=e(o))throw sprintf("[sprintf] expecting number but found %s",e(o));switch(a[8]){case"b":o=o.toString(2);break;case"c":o=String.fromCharCode(o);break;case"d":o=parseInt(o,10);break;case"e":o=a[7]?o.toExponential(a[7]):o.toExponential();break;case"f":o=a[7]?parseFloat(o).toFixed(a[7]):parseFloat(o);break;case"o":o=o.toString(8);break;case"s":o=(o=String(o))&&a[7]?o.substring(0,a[7]):o;break;case"u":o=Math.abs(o);break;case"x":
o=o.toString(16);break;case"X":o=o.toString(16).toUpperCase()}o=/[def]/.test(a[8])&&a[3]&&o>=0?"+"+o:o,c=a[4]?"0"==a[4]?"0":a[4].charAt(1):" ",u=a[6]-String(o).length,l=a[6]?t(c,u):"",d.push(a[5]?o+l:l+o)}return d.join("")},n.cache={},n.parse=function(e){for(var t=e,n=[],r=[],o=0;t;){if(null!==(n=/^[^\x25]+/.exec(t)))r.push(n[0]);else if(null!==(n=/^\x25{2}/.exec(t)))r.push("%");else{if(null===(n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw"[sprintf] huh?";if(n[2]){o|=1;var i=[],s=n[2],a=[];if(null===(a=/^([a-z_][a-z_\d]*)/i.exec(s)))throw"[sprintf] huh?";for(i.push(a[1]);""!==(s=s.substring(a[0].length));)if(null!==(a=/^\.([a-z_][a-z_\d]*)/i.exec(s)))i.push(a[1]);else{if(null===(a=/^\[(\d+)\]/.exec(s)))throw"[sprintf] huh?";i.push(a[1])}n[2]=i}else o|=2;if(3===o)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";r.push(n)}t=t.substring(n[0].length)}return r},n}(),exportedApi={csg:{CAG:_jscad_csg.CAG,CSG:_jscad_csg.CSG},primitives2d:primitives2d,primitives3d:primitives3d,booleanOps:booleanOps,transformations:transformations,extrusions:extrusions,color:color$1,maths:maths,text:text,OpenJsCad:{OpenJsCad:{log:log$1}},debug:{echo:echo}},commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},sax=createCommonjsModule(function(e,t){!function(e){function t(n,o){if(!(this instanceof t))return new t(n,o);var i=this;r(i),i.q=i.c="",i.bufferCheckPosition=e.MAX_BUFFER_LENGTH,i.opt=o||{},i.opt.lowercase=i.opt.lowercase||i.opt.lowercasetags,i.looseCase=i.opt.lowercase?"toLowerCase":"toUpperCase",i.tags=[],i.closed=i.closedRoot=i.sawRoot=!1,i.tag=i.error=null,i.strict=!!n,i.noscript=!(!n&&!i.opt.noscript),i.state=B.BEGIN,i.strictEntities=i.opt.strictEntities,i.ENTITIES=i.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),i.attribList=[],i.opt.xmlns&&(i.ns=Object.create(k)),i.trackPosition=!1!==i.opt.position,i.trackPosition&&(i.position=i.line=i.column=0),p(i,"onready")}function n(t){for(var n=Math.max(e.MAX_BUFFER_LENGTH,10),r=0,o=0,i=D.length;o<i;o++){var s=t[D[o]].length;if(s>n)switch(D[o]){case"textNode":d(t);break;case"cdata":f(t,"oncdata",t.cdata),t.cdata="";break;case"script":f(t,"onscript",t.script),t.script="";break;default:m(t,"Max buffer length exceeded: "+D[o])}r=Math.max(r,s)}var a=e.MAX_BUFFER_LENGTH-r;t.bufferCheckPosition=a+t.position}function r(e){for(var t=0,n=D.length;t<n;t++)e[D[t]]=""}function o(e){d(e),""!==e.cdata&&(f(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(f(e,"onscript",e.script),e.script="")}function i(e,t){return new s(e,t)}function s(e,n){if(!(this instanceof s))return new s(e,n);P.apply(this),this._parser=new t(e,n),this.writable=!0,this.readable=!0;var r=this;this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(e){r.emit("error",e),r._parser.error=null},this._decoder=null,A.forEach(function(e){Object.defineProperty(r,"on"+e,{get:function(){return r._parser["on"+e]},set:function(t){if(!t)return r.removeAllListeners(e),r._parser["on"+e]=t,t;r.on(e,t)},enumerable:!0,configurable:!1})})}function a(e){return e.split("").reduce(function(e,t){return e[t]=!0,e},{})}function l(e,t){return e.test(t)}function c(e,t){return e[t]}function u(e,t){return!l(e,t)}function h(e,t){return!c(e,t)}function p(e,t,n){e[t]&&e[t](n)}function f(e,t,n){e.textNode&&d(e),p(e,t,n)}function d(e){e.textNode=g(e.opt,e.textNode),e.textNode&&p(e,"ontext",e.textNode),e.textNode=""}function g(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function m(e,t){return d(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,p(e,"onerror",t),e}function v(e){return e.sawRoot&&!e.closedRoot&&C(e,"Unclosed root tag"),e.state!==B.BEGIN&&e.state!==B.BEGIN_WHITESPACE&&e.state!==B.TEXT&&m(e,"Unexpected end"),d(e),e.c="",e.closed=!0,p(e,"onend"),t.call(e,e.strict,e.opt),e}function C(e,n){if("object"!=typeof e||!(e instanceof t))throw new Error("bad call to strictFail");e.strict&&m(e,n)}function S(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,n=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(n.ns=t.ns),e.attribList.length=0,f(e,"onopentagstart",n)}function y(e,t){var n=e.indexOf(":"),r=n<0?["",e]:e.split(":"),o=r[0],i=r[1];return t&&"xmlns"===e&&(o="xmlns",i=""),{prefix:o,local:i}}function w(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))return void(e.attribName=e.attribValue="");if(e.opt.xmlns){var t=y(e.attribName,!0),n=t.prefix,r=t.local;if("xmlns"===n)if("xml"===r&&e.attribValue!==M)C(e,"xml: prefix must be bound to "+M+"\nActual: "+e.attribValue);else if("xmlns"===r&&e.attribValue!==F)C(e,"xmlns: prefix must be bound to "+F+"\nActual: "+e.attribValue);else{var o=e.tag,i=e.tags[e.tags.length-1]||e;o.ns===i.ns&&(o.ns=Object.create(i.ns)),o.ns[r]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,f(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}function x(e,t){if(e.opt.xmlns){var n=e.tag,r=y(e.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(C(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),n.uri=r.prefix);var o=e.tags[e.tags.length-1]||e;n.ns&&o.ns!==n.ns&&Object.keys(n.ns).forEach(function(t){f(e,"onopennamespace",{prefix:t,uri:n.ns[t]})});for(var i=0,s=e.attribList.length;i<s;i++){var a=e.attribList[i],l=a[0],c=a[1],u=y(l,!0),h=u.prefix,p=u.local,d=""===h?"":n.ns[h]||"",g={name:l,value:c,prefix:h,local:p,uri:d};h&&"xmlns"!==h&&!d&&(C(e,"Unbound namespace prefix: "+JSON.stringify(h)),g.uri=h),e.tag.attributes[l]=g,f(e,"onattribute",g)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),f(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=B.TEXT:e.state=B.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function G(e){if(!e.tagName)return C(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=B.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=B.SCRIPT);f(e,"onscript",e.script),e.script=""}var t=e.tags.length,n=e.tagName;e.strict||(n=n[e.looseCase]());for(var r=n;t--;){if(e.tags[t].name===r)break;C(e,"Unexpected close tag")}if(t<0)return C(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=B.TEXT);e.tagName=n;for(var o=e.tags.length;o-- >t;){var i=e.tag=e.tags.pop();e.tagName=e.tag.name,f(e,"onclosetag",e.tagName);var s={};for(var a in i.ns)s[a]=i.ns[a];var l=e.tags[e.tags.length-1]||e;e.opt.xmlns&&i.ns!==l.ns&&Object.keys(i.ns).forEach(function(t){var n=i.ns[t];f(e,"onclosenamespace",{prefix:t,uri:n})})}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=B.TEXT}function b(e){var t,n=e.entity,r=n.toLowerCase(),o="";return e.ENTITIES[n]?e.ENTITIES[n]:e.ENTITIES[r]?e.ENTITIES[r]:(n=r,"#"===n.charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),t=parseInt(n,16),o=t.toString(16)):(n=n.slice(1),t=parseInt(n,10),o=t.toString(10))),n=n.replace(/^0+/,""),o.toLowerCase()!==n?(C(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function $(e,t){"<"===t?(e.state=B.OPEN_WAKA,e.startTagPosition=e.position):h(E,t)&&(C(e,"Non-whitespace before first tag."),e.textNode=t,e.state=B.TEXT)}function T(e,t){var n="";return t<e.length&&(n=e.charAt(t)),n}function _(e){var t=this;if(this.error)throw this.error;if(t.closed)return m(t,"Cannot write after close. Assign an onready handler.");if(null===e)return v(t);"object"==typeof e&&(e=e.toString());for(var r=0,o="";;){if(o=T(e,r++),t.c=o,!o)break;switch(t.trackPosition&&(t.position++,"\n"===o?(t.line++,t.column=0):t.column++),t.state){case B.BEGIN:if(t.state=B.BEGIN_WHITESPACE,"\ufeff"===o)continue;$(t,o);continue;case B.BEGIN_WHITESPACE:$(t,o);continue;case B.TEXT:if(t.sawRoot&&!t.closedRoot){for(var i=r-1;o&&"<"!==o&&"&"!==o;)(o=T(e,r++))&&t.trackPosition&&(t.position++,"\n"===o?(t.line++,t.column=0):t.column++);t.textNode+=e.substring(i,r-1)}"<"!==o||t.sawRoot&&t.closedRoot&&!t.strict?(!h(E,o)||t.sawRoot&&!t.closedRoot||C(t,"Text data outside of root node."),"&"===o?t.state=B.TEXT_ENTITY:t.textNode+=o):(t.state=B.OPEN_WAKA,t.startTagPosition=t.position);continue;case B.SCRIPT:"<"===o?t.state=B.SCRIPT_ENDING:t.script+=o;continue;case B.SCRIPT_ENDING:"/"===o?t.state=B.CLOSE_TAG:(t.script+="<"+o,t.state=B.SCRIPT);continue;case B.OPEN_WAKA:if("!"===o)t.state=B.SGML_DECL,t.sgmlDecl="";else if(c(E,o));else if(l(R,o))t.state=B.OPEN_TAG,t.tagName=o;else if("/"===o)t.state=B.CLOSE_TAG,t.tagName="";else if("?"===o)t.state=B.PROC_INST,t.procInstName=t.procInstBody="";else{if(C(t,"Unencoded <"),t.startTagPosition+1<t.position){var s=t.position-t.startTagPosition;o=new Array(s).join(" ")+o}t.textNode+="<"+o,t.state=B.TEXT}continue;case B.SGML_DECL:(t.sgmlDecl+o).toUpperCase()===O?(f(t,"onopencdata"),t.state=B.CDATA,t.sgmlDecl="",t.cdata=""):t.sgmlDecl+o==="--"?(t.state=B.COMMENT,t.comment="",t.sgmlDecl=""):(t.sgmlDecl+o).toUpperCase()===V?(t.state=B.DOCTYPE,(t.doctype||t.sawRoot)&&C(t,"Inappropriately located doctype declaration"),t.doctype="",t.sgmlDecl=""):">"===o?(f(t,"onsgmldeclaration",t.sgmlDecl),t.sgmlDecl="",t.state=B.TEXT):c(N,o)?(t.state=B.SGML_DECL_QUOTED,t.sgmlDecl+=o):t.sgmlDecl+=o;continue;case B.SGML_DECL_QUOTED:o===t.q&&(t.state=B.SGML_DECL,t.q=""),t.sgmlDecl+=o;continue;case B.DOCTYPE:">"===o?(t.state=B.TEXT,f(t,"ondoctype",t.doctype),t.doctype=!0):(t.doctype+=o,"["===o?t.state=B.DOCTYPE_DTD:c(N,o)&&(t.state=B.DOCTYPE_QUOTED,t.q=o));continue;case B.DOCTYPE_QUOTED:t.doctype+=o,o===t.q&&(t.q="",t.state=B.DOCTYPE);continue;case B.DOCTYPE_DTD:t.doctype+=o,"]"===o?t.state=B.DOCTYPE:c(N,o)&&(t.state=B.DOCTYPE_DTD_QUOTED,t.q=o);continue;case B.DOCTYPE_DTD_QUOTED:t.doctype+=o,o===t.q&&(t.state=B.DOCTYPE_DTD,t.q="");continue;case B.COMMENT:"-"===o?t.state=B.COMMENT_ENDING:t.comment+=o;continue;case B.COMMENT_ENDING:"-"===o?(t.state=B.COMMENT_ENDED,t.comment=g(t.opt,t.comment),t.comment&&f(t,"oncomment",t.comment),t.comment=""):(t.comment+="-"+o,t.state=B.COMMENT);continue;case B.COMMENT_ENDED:">"!==o?(C(t,"Malformed comment"),t.comment+="--"+o,t.state=B.COMMENT):t.state=B.TEXT;continue;case B.CDATA:"]"===o?t.state=B.CDATA_ENDING:t.cdata+=o;continue;case B.CDATA_ENDING:"]"===o?t.state=B.CDATA_ENDING_2:(t.cdata+="]"+o,t.state=B.CDATA);continue;case B.CDATA_ENDING_2:">"===o?(t.cdata&&f(t,"oncdata",t.cdata),f(t,"onclosecdata"),t.cdata="",t.state=B.TEXT):"]"===o?t.cdata+="]":(t.cdata+="]]"+o,t.state=B.CDATA);continue;case B.PROC_INST:"?"===o?t.state=B.PROC_INST_ENDING:c(E,o)?t.state=B.PROC_INST_BODY:t.procInstName+=o;continue;case B.PROC_INST_BODY:if(!t.procInstBody&&c(E,o))continue;"?"===o?t.state=B.PROC_INST_ENDING:t.procInstBody+=o;continue;case B.PROC_INST_ENDING:">"===o?(f(t,"onprocessinginstruction",{name:t.procInstName,body:t.procInstBody}),t.procInstName=t.procInstBody="",t.state=B.TEXT):(t.procInstBody+="?"+o,t.state=B.PROC_INST_BODY);continue;case B.OPEN_TAG:l(L,o)?t.tagName+=o:(S(t),">"===o?x(t):"/"===o?t.state=B.OPEN_TAG_SLASH:(h(E,o)&&C(t,"Invalid character in tag name"),t.state=B.ATTRIB));continue;case B.OPEN_TAG_SLASH:">"===o?(x(t,!0),G(t)):(C(t,"Forward-slash in opening tag not followed by >"),t.state=B.ATTRIB);continue;case B.ATTRIB:if(c(E,o))continue;">"===o?x(t):"/"===o?t.state=B.OPEN_TAG_SLASH:l(R,o)?(t.attribName=o,t.attribValue="",t.state=B.ATTRIB_NAME):C(t,"Invalid attribute name");continue;case B.ATTRIB_NAME:"="===o?t.state=B.ATTRIB_VALUE:">"===o?(C(t,"Attribute without value"),t.attribValue=t.attribName,w(t),x(t)):c(E,o)?t.state=B.ATTRIB_NAME_SAW_WHITE:l(L,o)?t.attribName+=o:C(t,"Invalid attribute name");continue;case B.ATTRIB_NAME_SAW_WHITE:if("="===o)t.state=B.ATTRIB_VALUE;else{if(c(E,o))continue;C(t,"Attribute without value"),t.tag.attributes[t.attribName]="",t.attribValue="",f(t,"onattribute",{name:t.attribName,value:""}),t.attribName="",">"===o?x(t):l(R,o)?(t.attribName=o,t.state=B.ATTRIB_NAME):(C(t,"Invalid attribute name"),t.state=B.ATTRIB)}continue;case B.ATTRIB_VALUE:if(c(E,o))continue;c(N,o)?(t.q=o,t.state=B.ATTRIB_VALUE_QUOTED):(C(t,"Unquoted attribute value"),t.state=B.ATTRIB_VALUE_UNQUOTED,t.attribValue=o);continue;case B.ATTRIB_VALUE_QUOTED:if(o!==t.q){"&"===o?t.state=B.ATTRIB_VALUE_ENTITY_Q:t.attribValue+=o;continue}w(t),t.q="",t.state=B.ATTRIB_VALUE_CLOSED;continue;case B.ATTRIB_VALUE_CLOSED:c(E,o)?t.state=B.ATTRIB:">"===o?x(t):"/"===o?t.state=B.OPEN_TAG_SLASH:l(R,o)?(C(t,"No whitespace between attributes"),t.attribName=o,t.attribValue="",t.state=B.ATTRIB_NAME):C(t,"Invalid attribute name");continue;case B.ATTRIB_VALUE_UNQUOTED:if(h(I,o)){"&"===o?t.state=B.ATTRIB_VALUE_ENTITY_U:t.attribValue+=o;continue}w(t),">"===o?x(t):t.state=B.ATTRIB;continue;case B.CLOSE_TAG:if(t.tagName)">"===o?G(t):l(L,o)?t.tagName+=o:t.script?(t.script+="</"+t.tagName,t.tagName="",t.state=B.SCRIPT):(h(E,o)&&C(t,"Invalid tagname in closing tag"),t.state=B.CLOSE_TAG_SAW_WHITE);else{if(c(E,o))continue;u(R,o)?t.script?(t.script+="</"+o,t.state=B.SCRIPT):C(t,"Invalid tagname in closing tag."):t.tagName=o}continue;case B.CLOSE_TAG_SAW_WHITE:if(c(E,o))continue;">"===o?G(t):C(t,"Invalid characters in closing tag");continue;case B.TEXT_ENTITY:case B.ATTRIB_VALUE_ENTITY_Q:case B.ATTRIB_VALUE_ENTITY_U:var a,p;switch(t.state){case B.TEXT_ENTITY:a=B.TEXT,p="textNode";break;case B.ATTRIB_VALUE_ENTITY_Q:a=B.ATTRIB_VALUE_QUOTED,p="attribValue";break;case B.ATTRIB_VALUE_ENTITY_U:a=B.ATTRIB_VALUE_UNQUOTED,p="attribValue"}";"===o?(t[p]+=b(t),t.entity="",t.state=a):l(t.entity.length?z:j,o)?t.entity+=o:(C(t,"Invalid character in entity name"),t[p]+="&"+t.entity+o,t.entity="",t.state=a);continue;default:throw new Error(t,"Unknown state: "+t.state)}}return t.position>=t.bufferCheckPosition&&n(t),t}e.parser=function(e,n){return new t(e,n)},e.SAXParser=t,e.SAXStream=s,e.createStream=i,e.MAX_BUFFER_LENGTH=65536;var D=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),t.prototype={end:function(){v(this)},write:_,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){o(this)}};var P;try{P=stream.Stream}catch(e){P=function(){}}var A=e.EVENTS.filter(function(e){return"error"!==e&&"end"!==e});s.prototype=Object.create(P.prototype,{constructor:{value:s}}),s.prototype.write=function(e){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(e)){if(!this._decoder){var t=string_decoder.StringDecoder;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},s.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},s.prototype.on=function(e,t){var n=this;return n._parser["on"+e]||-1===A.indexOf(e)||(n._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),n.emit.apply(n,t)}),P.prototype.on.call(n,e,t)};var E="\r\n\t ",N="'\"",I=E+">",O="[CDATA[",V="DOCTYPE",M="http://www.w3.org/XML/1998/namespace",F="http://www.w3.org/2000/xmlns/",k={xml:M,xmlns:F};E=a(E);var R=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,L=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,j=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,z=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;N=a(N),I=a(I);var B=0;e.STATE={BEGIN:B++,BEGIN_WHITESPACE:B++,TEXT:B++,TEXT_ENTITY:B++,OPEN_WAKA:B++,SGML_DECL:B++,SGML_DECL_QUOTED:B++,DOCTYPE:B++,DOCTYPE_QUOTED:B++,DOCTYPE_DTD:B++,DOCTYPE_DTD_QUOTED:B++,COMMENT_STARTING:B++,COMMENT:B++,COMMENT_ENDING:B++,COMMENT_ENDED:B++,CDATA:B++,CDATA_ENDING:B++,CDATA_ENDING_2:B++,PROC_INST:B++,PROC_INST_BODY:B++,PROC_INST_ENDING:B++,OPEN_TAG:B++,OPEN_TAG_SLASH:B++,ATTRIB:B++,ATTRIB_NAME:B++,ATTRIB_NAME_SAW_WHITE:B++,ATTRIB_VALUE:B++,ATTRIB_VALUE_QUOTED:B++,ATTRIB_VALUE_CLOSED:B++,ATTRIB_VALUE_UNQUOTED:B++,ATTRIB_VALUE_ENTITY_Q:B++,ATTRIB_VALUE_ENTITY_U:B++,CLOSE_TAG:B++,CLOSE_TAG_SAW_WHITE:B++,SCRIPT:B++,SCRIPT_ENDING:B++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(t){var n=e.ENTITIES[t],r="number"==typeof n?String.fromCharCode(n):n;e.ENTITIES[t]=r});for(var X in e.STATE)e.STATE[e.STATE[X]]=X;B=e.STATE,String.fromCodePoint||function(){var e=String.fromCharCode,t=Math.floor,n=function(){var n,r,o=arguments,i=[],s=-1,a=arguments.length;if(!a)return"";for(var l="";++s<a;){var c=Number(o[s]);if(!isFinite(c)||c<0||c>1114111||t(c)!==c)throw RangeError("Invalid code point: "+c);c<=65535?i.push(c):(c-=65536,n=55296+(c>>10),r=c%1024+56320,i.push(n,r)),(s+1===a||i.length>16384)&&(l+=e.apply(null,i),i.length=0)}return l};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:n,configurable:!0,writable:!0}):String.fromCodePoint=n}()}(void 0===t?commonjsGlobal.sax={}:t)}),_CSGDEBUG=!1,CSG$2=function(){this.polygons=[],this.properties=new CSG$2.Properties,this.isCanonicalized=!0,this.isRetesselated=!0};CSG$2.defaultResolution2D=32,CSG$2.defaultResolution3D=12,CSG$2.fromPolygons=function(e){var t=new CSG$2;return t.polygons=e,t.isCanonicalized=!1,t.isRetesselated=!1,t},CSG$2.fromSlices=function(e){return new CSG$2.Polygon.createFromPoints([[0,0,0],[1,0,0],[1,1,0],[0,1,0]]).solidFromSlices(e)},CSG$2.fromObject=function(e){var t=e.polygons.map(function(e){return CSG$2.Polygon.fromObject(e)}),n=CSG$2.fromPolygons(t);return n.isCanonicalized=e.isCanonicalized,n.isRetesselated=e.isRetesselated,n},CSG$2.fromCompactBinary=function(e){if("CSG"!=e.class)throw new Error("Not a CSG");for(var t,n,r,o,i,s,a=[],l=e.planeData,c=l.length/4,u=0,h=0;h<c;h++)t=l[u++],n=l[u++],r=l[u++],o=l[u++],i=CSG$2.Vector3D.Create(t,n,r),s=new CSG$2.Plane(i,o),a.push(s);var p,f,d=[],g=e.vertexData,m=g.length/3;u=0;for(var v=0;v<m;v++)t=g[u++],n=g[u++],r=g[u++],p=CSG$2.Vector3D.Create(t,n,r),f=new CSG$2.Vertex(p),d.push(f);var C,S,y,w,x=e.shared.map(function(e){return CSG$2.Polygon.Shared.fromObject(e)}),G=[],b=e.numPolygons,$=e.numVerticesPerPolygon,T=e.polygonVertices,_=e.polygonPlaneIndexes,D=e.polygonSharedIndexes;u=0;for(var P=0;P<b;P++){C=$[P],S=[];for(var A=0;A<C;A++)S.push(d[T[u++]]);s=a[_[P]],y=x[D[P]],w=new CSG$2.Polygon(S,y,s),G.push(w)}var E=CSG$2.fromPolygons(G);return E.isCanonicalized=!0,E.isRetesselated=!0,E},CSG$2.prototype={toPolygons:function(){return this.polygons},union:function(e){var t;e instanceof Array?(t=e.slice(0),t.push(this)):t=[this,e];for(var n=1;n<t.length;n+=2)t.push(t[n-1].unionSub(t[n]));return t[n-1].reTesselated().canonicalized()},unionSub:function(e,t,n){if(this.mayOverlap(e)){var r=new CSG$2.Tree(this.polygons),o=new CSG$2.Tree(e.polygons);r.clipTo(o,!1),o.clipTo(r),o.invert(),o.clipTo(r),o.invert();var i=r.allPolygons().concat(o.allPolygons()),s=CSG$2.fromPolygons(i);return s.properties=this.properties._merge(e.properties),t&&(s=s.reTesselated()),n&&(s=s.canonicalized()),s}return this.unionForNonIntersecting(e)},unionForNonIntersecting:function(e){var t=this.polygons.concat(e.polygons),n=CSG$2.fromPolygons(t);return n.properties=this.properties._merge(e.properties),n.isCanonicalized=this.isCanonicalized&&e.isCanonicalized,n.isRetesselated=this.isRetesselated&&e.isRetesselated,n},subtract:function(e){var t;t=e instanceof Array?e:[e];for(var n=this,r=0;r<t.length;r++){var o=r==t.length-1;n=n.subtractSub(t[r],o,o)}return n},subtractSub:function(e,t,n){var r=new CSG$2.Tree(this.polygons),o=new CSG$2.Tree(e.polygons);r.invert(),r.clipTo(o),o.clipTo(r,!0),r.addPolygons(o.allPolygons()),r.invert();var i=CSG$2.fromPolygons(r.allPolygons());return i.properties=this.properties._merge(e.properties),t&&(i=i.reTesselated()),n&&(i=i.canonicalized()),i},intersect:function(e){var t;t=e instanceof Array?e:[e];for(var n=this,r=0;r<t.length;r++){var o=r==t.length-1;n=n.intersectSub(t[r],o,o)}return n},intersectSub:function(e,t,n){var r=new CSG$2.Tree(this.polygons),o=new CSG$2.Tree(e.polygons);r.invert(),o.clipTo(r),o.invert(),r.clipTo(o),o.clipTo(r),r.addPolygons(o.allPolygons()),r.invert();var i=CSG$2.fromPolygons(r.allPolygons());return i.properties=this.properties._merge(e.properties),t&&(i=i.reTesselated()),n&&(i=i.canonicalized()),i},invert:function(){var e=this.polygons.map(function(e){return e.flipped()});return CSG$2.fromPolygons(e)},transform1:function(e){var t=this.polygons.map(function(t){return t.transform(e)}),n=CSG$2.fromPolygons(t);return n.properties=this.properties._transform(e),n.isRetesselated=this.isRetesselated,n},transform:function(e){var t=e.isMirroring(),n={},r={},o=this.polygons.map(function(o){var i,s=o.plane,a=s.getTag();a in r?i=r[a]:(i=s.transform(e),r[a]=i);var l=o.vertices.map(function(t){var r,o=t.getTag();return o in n?r=n[o]:(r=t.transform(e),n[o]=r),r});return t&&l.reverse(),new CSG$2.Polygon(l,o.shared,i)}),i=CSG$2.fromPolygons(o);return i.properties=this.properties._transform(e),i.isRetesselated=this.isRetesselated,i.isCanonicalized=this.isCanonicalized,i},toString:function(){var e="CSG solid:\n";return this.polygons.map(function(t){e+=t.toString()}),e},expand:function(e,t){var n=this.expandedShell(e,t,!0);return n=n.reTesselated(),n.properties=this.properties,n},contract:function(e,t){var n=this.expandedShell(e,t,!1),r=this.subtract(n);return r=r.reTesselated(),r.properties=this.properties,r},stretchAtPlane:function(e,t,n){var r=CSG$2.Plane.fromNormalAndPoint(e,t),o=new CSG$2.OrthoNormalBasis(r),i=this.sectionCut(o),s=i.extrudeInOrthonormalBasis(o,n),a=this.cutByPlane(r),l=this.cutByPlane(r.flipped());return a.union([s,l.translate(r.normal.times(n))])},expandedShell:function(e,t,n){var r,o=this.reTesselated();r=n?o:new CSG$2,o.polygons.map(function(t){var n=t.plane.normal.unit().times(2*e),o=t.translate(n.times(-.5)),i=o.extrude(n);r=r.unionSub(i,!1,!1)});var i={};o.polygons.map(function(e){for(var t=e.vertices.length,n=e.vertices[t-1],r=n.getTag(),o=0;o<t;o++){var s,a=e.vertices[o],l=a.getTag();s=l<r?l+"-"+r:r+"-"+l;var c;s in i?c=i[s]:(c={v1:n,v2:a,planenormals:[]},i[s]=c),c.planenormals.push(e.plane.normal),r=l,n=a}});for(var s in i){for(var a=i[s],l=a.v1.pos,c=a.v2.pos,u=c.minus(l).unit(),h=a.planenormals[0].unit(),p=h.cross(u),f=[],d=0;d<t;d++)f.push(d*Math.PI*2/t);for(var d=0,g=a.planenormals.length;d<g;d++){var m=a.planenormals[d],v=p.dot(m),C=h.dot(m),S=Math.atan2(v,C);S<0&&(S+=2*Math.PI),f.push(S),S=Math.atan2(-v,-C),S<0&&(S+=2*Math.PI),f.push(S)}f=f.sort(fnNumberSort);for(var y,w,x=f.length,G=[],b=[],$=[],d=-1;d<x;d++){var S=f[d<0?d+x:d],v=Math.sin(S),C=Math.cos(S),T=h.times(C*e).plus(p.times(v*e)),_=l.plus(T),D=c.plus(T),P=!1;if(d>=0&&_.distanceTo(y)<1e-5&&(P=!0),!P){if(d>=0){G.push(new CSG$2.Vertex(_)),b.push(new CSG$2.Vertex(D));var A=[new CSG$2.Vertex(w),new CSG$2.Vertex(D),new CSG$2.Vertex(_),new CSG$2.Vertex(y)],E=new CSG$2.Polygon(A);$.push(E)}y=_,w=D}}b.reverse(),$.push(new CSG$2.Polygon(G)),$.push(new CSG$2.Polygon(b));var N=CSG$2.fromPolygons($);r=r.unionSub(N,!1,!1)}var I={};o.polygons.map(function(e){e.vertices.map(function(t){var n,r=t.getTag();r in I?n=I[r]:(n={pos:t.pos,normals:[]},I[r]=n),n.normals.push(e.plane.normal)})});for(var O in I){for(var V=I[O],M=V.normals[0].unit(),F=null,k=0,d=1;d<V.normals.length;d++){var R=V.normals[d].unit(),L=M.cross(R),j=L.length();j>.05&&j>k&&(k=j,F=R)}F||(F=M.randomNonParallelVector());var z=M.cross(F).unit(),B=z.cross(M),X=CSG$2.sphere({center:V.pos,radius:e,resolution:t,axes:[M,z,B]});r=r.unionSub(X,!1,!1)}return r},canonicalized:function(){if(this.isCanonicalized)return this;var e=new CSG$2.fuzzyCSGFactory,t=e.getCSG(this);return t.isCanonicalized=!0,t.isRetesselated=this.isRetesselated,t.properties=this.properties,t},reTesselated:function(){if(this.isRetesselated)return this;var e=this,t={},n=e.isCanonicalized,r=new CSG$2.fuzzyCSGFactory;e.polygons.map(function(e){var o=e.plane,i=e.shared;n||(o=r.getPlane(o),i=r.getPolygonShared(i));var s=o.getTag()+"/"+i.getTag();s in t?t[s].push(e):t[s]=[e]});var o=[];for(var i in t){var s=t[i];if(s.length<2)o=o.concat(s);else{var a=[];CSG$2.reTesselateCoplanarPolygons(s,a),o=o.concat(a)}}var l=CSG$2.fromPolygons(o);return l.isRetesselated=!0,l.properties=this.properties,l},getBounds:function(){if(!this.cachedBoundingBox){for(var e=new CSG$2.Vector3D(0,0,0),t=new CSG$2.Vector3D(0,0,0),n=this.polygons,r=n.length,o=0;o<r;o++){var i=n[o],s=i.boundingBox();0===o?(e=s[0],t=s[1]):(e=e.min(s[0]),t=t.max(s[1]))}this.cachedBoundingBox=[e,t]}return this.cachedBoundingBox},mayOverlap:function(e){if(0===this.polygons.length||0===e.polygons.length)return!1;var t=this.getBounds(),n=e.getBounds();return!(t[1].x<n[0].x)&&(!(t[0].x>n[1].x)&&(!(t[1].y<n[0].y)&&(!(t[0].y>n[1].y)&&(!(t[1].z<n[0].z)&&!(t[0].z>n[1].z)))))},cutByPlane:function(e){if(0===this.polygons.length)return new CSG$2;var t=e.normal.times(e.w),n=0;this.polygons.map(function(e){e.vertices.map(function(e){var r=e.pos.distanceToSquared(t);r>n&&(n=r)})}),n=Math.sqrt(n),n*=1.01;var r=[],o=new CSG$2.OrthoNormalBasis(e);r.push(new CSG$2.Vertex(o.to3D(new CSG$2.Vector2D(n,-n)))),r.push(new CSG$2.Vertex(o.to3D(new CSG$2.Vector2D(-n,-n)))),r.push(new CSG$2.Vertex(o.to3D(new CSG$2.Vector2D(-n,n)))),r.push(new CSG$2.Vertex(o.to3D(new CSG$2.Vector2D(n,n))));var i=new CSG$2.Polygon(r,null,e.flipped()),s=i.extrude(e.normal.times(-n)),a=this.intersect(s);return a.properties=this.properties,a},connectTo:function(e,t,n,r){var o=e.getTransformationTo(t,n,r);return this.transform(o)},setShared:function(e){var t=this.polygons.map(function(t){return new CSG$2.Polygon(t.vertices,e,t.plane)}),n=CSG$2.fromPolygons(t);return n.properties=this.properties,n.isRetesselated=this.isRetesselated,n.isCanonicalized=this.isCanonicalized,n},setColor:function(e){var t=CSG$2.Polygon.Shared.fromColor.apply(this,arguments);return this.setShared(t)},toCompactBinary:function(){var e=this.canonicalized(),t=e.polygons.length,n=0,r=0,o={},i=[],s=0,a={},l=0,c=[],u=[],h={},p=0;e.polygons.map(function(e){e.vertices.map(function(e){++n;var t=e.getTag();t in o||(o[t]=r++,i.push(e))});var t=e.plane.getTag();t in a||(a[t]=s++,c.push(e.plane));var l=e.shared.getTag();l in h||(h[l]=p++,u.push(e.shared))});for(var f=new Uint32Array(t),d=new Uint32Array(t),g=new Uint32Array(n),m=new Uint32Array(t),v=new Float64Array(3*r),C=new Float64Array(4*s),S=0,l=0;l<t;++l){var y=e.polygons[l];f[l]=y.vertices.length,y.vertices.map(function(e){var t=e.getTag(),n=o[t];g[S++]=n});var w=y.plane.getTag(),x=a[w];m[l]=x;var G=y.shared.getTag(),b=h[G];d[l]=b}var $=0;i.map(function(e){var t=e.pos;v[$++]=t._x,v[$++]=t._y,v[$++]=t._z});var T=0;return c.map(function(e){var t=e.normal;C[T++]=t._x,C[T++]=t._y,C[T++]=t._z,C[T++]=e.w}),{class:"CSG",numPolygons:t,numVerticesPerPolygon:f,polygonPlaneIndexes:m,polygonSharedIndexes:d,polygonVertices:g,vertexData:v,planeData:C,shared:u}},toPointCloud:function(e){var t=this.reTesselated(),n=new CSG$2,r={};t.polygons.map(function(e){e.vertices.map(function(e){r[e.getTag()]=e.pos})});for(var o in r){var i=r[o],s=CSG$2.cube({center:i,radius:e});n=n.unionSub(s,!1,!1)}return n=n.reTesselated()},getTransformationAndInverseTransformationToFlatLying:function(){if(0===this.polygons.length){var e=new CSG$2.Matrix4x4;return[e,e]}var t=this.canonicalized(),n={};t.polygons.map(function(e){n[e.plane.getTag()]=e.plane});var r,o,i=new CSG$2.Vector3D(1,0,0),s=new CSG$2.Vector3D(0,1,0),a=new CSG$2.Vector3D(0,0,1),l=new CSG$2.Connector([0,0,0],[0,0,-1],i),c=new CSG$2.Connector([0,0,0],[0,0,-1],s),u=!0,h=0,p=0;for(var f in n){var d,g,m=n[f],v=m.normal.times(m.w);if(m.normal.cross(i).length()>m.normal.cross(s).length()){var C=new CSG$2.Connector(v,m.normal,i);d=C.getTransformationTo(l,!1,0),g=l.getTransformationTo(C,!1,0)}else{var C=new CSG$2.Connector(v,m.normal,s);d=C.getTransformationTo(c,!1,0),g=c.getTransformationTo(C,!1,0)}var S=t.transform(d),y=-m.normal.dot(a),w=S.getBounds(),x=w[1].z-w[0].z,G=u;if(G||(x<h?G=!0:x==h&&y>p&&(G=!0)),G){var b=new CSG$2.Vector3D([-.5*(w[1].x+w[0].x),-.5*(w[1].y+w[0].y),-w[0].z]);d=d.multiply(CSG$2.Matrix4x4.translation(b)),g=CSG$2.Matrix4x4.translation(b.negated()).multiply(g),h=x,p=y,r=d,o=g}u=!1}return[r,o]},getTransformationToFlatLying:function(){return this.getTransformationAndInverseTransformationToFlatLying()[0]},lieFlat:function(){var e=this.getTransformationToFlatLying();return this.transform(e)},
projectToOrthoNormalBasis:function(e){var t=[];return this.polygons.filter(function(t){return t.plane.normal.minus(e.plane.normal).lengthSquared()<1e-5*1e-5}).map(function(n){var r=n.projectToOrthoNormalBasis(e);r.sides.length>0&&t.push(r)}),(new CAG$2).union(t)},sectionCut:function(e){var t=e.plane,n=e.plane.flipped();t=new CSG$2.Plane(t.normal,t.w),n=new CSG$2.Plane(n.normal,n.w+5e-5);var r=this.cutByPlane(t);return r=r.cutByPlane(n),r.projectToOrthoNormalBasis(e)},fixTJunctions:function(){function e(e,n,o){var i=e.getTag(),s=n.getTag();if(i==s)throw new Error("Assertion failed");var a=i+"/"+s;if(s+"/"+i in r)return t(n,e,null),null;var l={vertex0:e,vertex1:n,polygonindex:o};return a in r?r[a].push(l):r[a]=[l],i in v?v[i].push(a):v[i]=[a],s in C?C[s].push(a):C[s]=[a],a}function t(e,t,n){var o=e.getTag(),i=t.getTag(),s=o+"/"+i;if(!(s in r))throw new Error("Assertion failed");for(var a=-1,l=r[s],c=0;c<l.length;c++){var u=l[c];if(u.vertex0==e&&(u.vertex1==t&&(null===n||u.polygonindex==n))){a=c;break}}if(a<0)throw new Error("Assertion failed");if(l.splice(a,1),0===l.length&&delete r[s],(a=v[o].indexOf(s))<0)throw new Error("Assertion failed");if(v[o].splice(a,1),0===v[o].length&&delete v[o],(a=C[i].indexOf(s))<0)throw new Error("Assertion failed");C[i].splice(a,1),0===C[i].length&&delete C[i]}for(var n=this.canonicalized(),r={},o=0;o<n.polygons.length;o++){var i=n.polygons[o],s=i.vertices.length;if(s>=3)for(var a=i.vertices[0],l=a.getTag(),c=0;c<s;c++){var u=c+1;u==s&&(u=0);var h=i.vertices[u],p=h.getTag(),f=l+"/"+p,d=p+"/"+l;if(d in r){var g=r[d];g.splice(-1,1),0===g.length&&delete r[d]}else{var m={vertex0:a,vertex1:h,polygonindex:o};f in r?r[f].push(m):r[f]=[m]}a=h,l=p}}var v={},C={},S={},y=!0;for(var f in r)y=!1,S[f]=!0,r[f].map(function(e){var t=e.vertex0.getTag(),n=e.vertex1.getTag();t in v?v[t].push(f):v[t]=[f],n in C?C[n].push(f):C[n]=[f]});if(!y){for(var w=n.polygons.slice(0);;){var y=!0;for(var f in r)y=!1,S[f]=!0;if(y)break;for(var x=!1;;){var G=null;for(var f in S){G=f;break}if(null===G)break;var b=!0;if(G in r){var $=r[G];if(0===$.length)throw new Error("Assertion failed");for(var m=$[0],T=0;T<2;T++){var _=0===T?m.vertex0:m.vertex1,D=0===T?m.vertex1:m.vertex0,P=_.getTag(),A=D.getTag(),E=[];0===T?P in C&&(E=C[P]):P in v&&(E=v[P]);for(var N=0;N<E.length;N++){var I=E[N],O=r[I][0],V=0===T?O.vertex0:O.vertex1,M=0===T?O.vertex1:O.vertex0,F=V.getTag();if(M.getTag()!=P)throw new Error("Assertion failed");if(F==A){t(_,D,null),t(D,_,null),b=!1,T=2,x=!0;break}var k=_.pos,R=D.pos,L=V.pos,j=L.minus(k),z=R.minus(k).dot(j)/j.dot(j);if(z>0&&z<1){if(k.plus(j.times(z)).distanceToSquared(R)<1e-10){for(var o=O.polygonindex,i=w[o],B=O.vertex1.getTag(),X=-1,Y=0;Y<i.vertices.length;Y++)if(i.vertices[Y].getTag()==B){X=Y;break}if(X<0)throw new Error("Assertion failed");var U=i.vertices.slice(0);U.splice(X,0,D);var q=new CSG$2.Polygon(U,i.shared);if(isNaN(q.plane.w)){var W=!1,H=function(e){q.vertices.forEach(function(t){W||e(t)})};H(function(e){H(function(t){H(function(n){q.plane=CSG$2.Plane.fromPoints(e.pos,t.pos,n.pos),isNaN(q.plane.w)||(W=!0)})})})}w[o]=q,t(O.vertex0,O.vertex1,o);var Z=e(O.vertex0,D,o),J=e(D,O.vertex1,o);null!==Z&&(S[Z]=!0),null!==J&&(S[J]=!0),b=!1,T=2,x=!0;break}}}}}b&&delete S[f]}if(!x)break}var Q=CSG$2.fromPolygons(w);Q.properties=n.properties,Q.isCanonicalized=!0,Q.isRetesselated=!0,n=Q}var y=!0;for(var f in r){y=!1;break}return y||OpenJsCad.log("!sidemapisempty"),n},toTriangles:function(){var e=[];return this.polygons.forEach(function(t){for(var n=t.vertices[0],r=t.vertices.length-3;r>=0;r--)e.push(new CSG$2.Polygon([n,t.vertices[r+1],t.vertices[r+2]],t.shared,t.plane))}),e},getFeatures:function(e){e instanceof Array||(e=[e]);var t=this.toTriangles().map(function(t){return t.getTetraFeatures(e)}).reduce(function(e,t){return t.map(function(t,n){return t+(0===e?0:e[n])})},0);return 1==t.length?t[0]:t}},CSG$2.parseOption=function(e,t,n){var r=n;return e&&t in e&&(r=e[t]),r},CSG$2.parseOptionAs3DVector=function(e,t,n){var r=CSG$2.parseOption(e,t,n);return r=new CSG$2.Vector3D(r)},CSG$2.parseOptionAs3DVectorList=function(e,t,n){return CSG$2.parseOption(e,t,n).map(function(e){return new CSG$2.Vector3D(e)})},CSG$2.parseOptionAs2DVector=function(e,t,n){var r=CSG$2.parseOption(e,t,n);return r=new CSG$2.Vector2D(r)},CSG$2.parseOptionAsFloat=function(e,t,n){var r=CSG$2.parseOption(e,t,n);if("string"==typeof r&&(r=Number(r)),isNaN(r)||"number"!=typeof r)throw new Error("Parameter "+t+" should be a number");return r},CSG$2.parseOptionAsInt=function(e,t,n){var r=CSG$2.parseOption(e,t,n);if(r=Number(Math.floor(r)),isNaN(r))throw new Error("Parameter "+t+" should be a number");return r},CSG$2.parseOptionAsBool=function(e,t,n){var r=CSG$2.parseOption(e,t,n);return"string"==typeof r&&("true"==r?r=!0:"false"==r?r=!1:0==r&&(r=!1)),r=!!r},CSG$2.cube=function(e){var t,n;if("corner1"in(e=e||{})||"corner2"in e){if("center"in e||"radius"in e)throw new Error("cube: should either give a radius and center parameter, or a corner1 and corner2 parameter");corner1=CSG$2.parseOptionAs3DVector(e,"corner1",[0,0,0]),corner2=CSG$2.parseOptionAs3DVector(e,"corner2",[1,1,1]),t=corner1.plus(corner2).times(.5),n=corner2.minus(corner1).times(.5)}else t=CSG$2.parseOptionAs3DVector(e,"center",[0,0,0]),n=CSG$2.parseOptionAs3DVector(e,"radius",[1,1,1]);n=n.abs();var r=CSG$2.fromPolygons([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(e){var r=e[0].map(function(e){var r=new CSG$2.Vector3D(t.x+n.x*(2*!!(1&e)-1),t.y+n.y*(2*!!(2&e)-1),t.z+n.z*(2*!!(4&e)-1));return new CSG$2.Vertex(r)});return new CSG$2.Polygon(r,null)}));return r.properties.cube=new CSG$2.Properties,r.properties.cube.center=new CSG$2.Vector3D(t),r.properties.cube.facecenters=[new CSG$2.Connector(new CSG$2.Vector3D([n.x,0,0]).plus(t),[1,0,0],[0,0,1]),new CSG$2.Connector(new CSG$2.Vector3D([-n.x,0,0]).plus(t),[-1,0,0],[0,0,1]),new CSG$2.Connector(new CSG$2.Vector3D([0,n.y,0]).plus(t),[0,1,0],[0,0,1]),new CSG$2.Connector(new CSG$2.Vector3D([0,-n.y,0]).plus(t),[0,-1,0],[0,0,1]),new CSG$2.Connector(new CSG$2.Vector3D([0,0,n.z]).plus(t),[0,0,1],[1,0,0]),new CSG$2.Connector(new CSG$2.Vector3D([0,0,-n.z]).plus(t),[0,0,-1],[1,0,0])],r},CSG$2.sphere=function(e){e=e||{};var t,n,r,o=CSG$2.parseOptionAs3DVector(e,"center",[0,0,0]),i=CSG$2.parseOptionAsFloat(e,"radius",1),s=CSG$2.parseOptionAsInt(e,"resolution",CSG$2.defaultResolution3D);"axes"in e?(t=e.axes[0].unit().times(i),n=e.axes[1].unit().times(i),r=e.axes[2].unit().times(i)):(t=new CSG$2.Vector3D([1,0,0]).times(i),n=new CSG$2.Vector3D([0,-1,0]).times(i),r=new CSG$2.Vector3D([0,0,1]).times(i)),s<4&&(s=4);for(var a,l=Math.round(s/4),c=[],u=0;u<=s;u++){var h=2*Math.PI*u/s,p=t.times(Math.cos(h)).plus(n.times(Math.sin(h)));if(u>0)for(var f,d,g=[],m=0;m<=l;m++){var v=.5*Math.PI*m/l,C=Math.cos(v),S=Math.sin(v);m>0&&(g=[],g.push(new CSG$2.Vertex(o.plus(a.times(f).minus(r.times(d))))),g.push(new CSG$2.Vertex(o.plus(p.times(f).minus(r.times(d))))),m<l&&g.push(new CSG$2.Vertex(o.plus(p.times(C).minus(r.times(S))))),g.push(new CSG$2.Vertex(o.plus(a.times(C).minus(r.times(S))))),c.push(new CSG$2.Polygon(g)),g=[],g.push(new CSG$2.Vertex(o.plus(a.times(f).plus(r.times(d))))),g.push(new CSG$2.Vertex(o.plus(p.times(f).plus(r.times(d))))),m<l&&g.push(new CSG$2.Vertex(o.plus(p.times(C).plus(r.times(S))))),g.push(new CSG$2.Vertex(o.plus(a.times(C).plus(r.times(S))))),g.reverse(),c.push(new CSG$2.Polygon(g))),f=C,d=S}a=p}var y=CSG$2.fromPolygons(c);return y.properties.sphere=new CSG$2.Properties,y.properties.sphere.center=new CSG$2.Vector3D(o),y.properties.sphere.facepoint=o.plus(t),y},CSG$2.cylinder=function(e){function t(e,t,r){var o=t*Math.PI*a/180,i=h.times(Math.cos(o)).plus(p.times(Math.sin(o))),s=n.plus(c.times(e)).plus(i.times(r));return new CSG$2.Vertex(s)}var n=CSG$2.parseOptionAs3DVector(e,"start",[0,-1,0]),r=CSG$2.parseOptionAs3DVector(e,"end",[0,1,0]),o=CSG$2.parseOptionAsFloat(e,"radius",1),i=CSG$2.parseOptionAsFloat(e,"radiusEnd",o),s=CSG$2.parseOptionAsFloat(e,"radiusStart",o),a=CSG$2.parseOptionAsFloat(e,"sectorAngle",360);if(a=a>360?a%360:a,i<0||s<0)throw new Error("Radius should be non-negative");if(0===i&&0===s)throw new Error("Either radiusStart or radiusEnd should be positive");var l=CSG$2.parseOptionAsInt(e,"resolution",CSG$2.defaultResolution2D),c=r.minus(n),u=c.unit(),h=u.randomNonParallelVector().unit(),p=h.cross(u).unit(),f=new CSG$2.Vertex(n),d=new CSG$2.Vertex(r),g=[];if(a>0){for(var m=0;m<l;m++){var v=m/l,C=(m+1)/l;i==s?(g.push(new CSG$2.Polygon([f,t(0,v,i),t(0,C,i)])),g.push(new CSG$2.Polygon([t(0,C,i),t(0,v,i),t(1,v,i),t(1,C,i)])),g.push(new CSG$2.Polygon([d,t(1,C,i),t(1,v,i)]))):(s>0&&(g.push(new CSG$2.Polygon([f,t(0,v,s),t(0,C,s)])),g.push(new CSG$2.Polygon([t(0,v,s),t(1,v,i),t(0,C,s)]))),i>0&&(g.push(new CSG$2.Polygon([d,t(1,C,i),t(1,v,i)])),g.push(new CSG$2.Polygon([t(1,v,i),t(1,C,i),t(0,C,s)]))))}a<360&&(g.push(new CSG$2.Polygon([f,d,t(0,0,s)])),g.push(new CSG$2.Polygon([t(0,0,s),d,t(1,0,i)])),g.push(new CSG$2.Polygon([f,t(0,1,s),d])),g.push(new CSG$2.Polygon([t(0,1,s),t(1,1,i),d])))}var S=CSG$2.fromPolygons(g);S.properties.cylinder=new CSG$2.Properties,S.properties.cylinder.start=new CSG$2.Connector(n,u.negated(),h),S.properties.cylinder.end=new CSG$2.Connector(r,u,h);var y=n.plus(c.times(.5)),w=h.rotate(n,u,-a/2).times((s+i)/2),x=w.cross(u);return S.properties.cylinder.facepointH=new CSG$2.Connector(y.plus(w),w,u),S.properties.cylinder.facepointH90=new CSG$2.Connector(y.plus(x),x,u),S},CSG$2.roundedCylinder=function(e){var t,n=CSG$2.parseOptionAs3DVector(e,"start",[0,-1,0]),r=CSG$2.parseOptionAs3DVector(e,"end",[0,1,0]),o=CSG$2.parseOptionAsFloat(e,"radius",1),i=r.minus(n);t=Math.abs(i.x)>Math.abs(i.y)?new CSG$2.Vector3D(0,1,0):new CSG$2.Vector3D(1,0,0);var s=CSG$2.parseOptionAs3DVector(e,"normal",t),a=CSG$2.parseOptionAsInt(e,"resolution",CSG$2.defaultResolution3D);a<4&&(a=4);var l=[],c=Math.floor(.25*a);if(i.length()<1e-10)return CSG$2.sphere({center:n,radius:o,resolution:a});for(var u,h=i.unit().times(o),p=h.cross(s).unit().times(o),f=p.cross(h).unit().times(o),d=0;d<=a;d++){var g=2*Math.PI*d/a,m=p.times(Math.cos(g)).plus(f.times(Math.sin(g)));if(d>0){var v=[];v.push(new CSG$2.Vertex(n.plus(m))),v.push(new CSG$2.Vertex(n.plus(u))),v.push(new CSG$2.Vertex(r.plus(u))),v.push(new CSG$2.Vertex(r.plus(m))),l.push(new CSG$2.Polygon(v));for(var C,S,y=0;y<=c;y++){var w=.5*Math.PI*y/c,x=Math.cos(w),G=Math.sin(w);y>0&&(v=[],v.push(new CSG$2.Vertex(n.plus(u.times(C).minus(h.times(S))))),v.push(new CSG$2.Vertex(n.plus(m.times(C).minus(h.times(S))))),y<c&&v.push(new CSG$2.Vertex(n.plus(m.times(x).minus(h.times(G))))),v.push(new CSG$2.Vertex(n.plus(u.times(x).minus(h.times(G))))),l.push(new CSG$2.Polygon(v)),v=[],v.push(new CSG$2.Vertex(r.plus(u.times(C).plus(h.times(S))))),v.push(new CSG$2.Vertex(r.plus(m.times(C).plus(h.times(S))))),y<c&&v.push(new CSG$2.Vertex(r.plus(m.times(x).plus(h.times(G))))),v.push(new CSG$2.Vertex(r.plus(u.times(x).plus(h.times(G))))),v.reverse(),l.push(new CSG$2.Polygon(v))),C=x,S=G}}u=m}var b=CSG$2.fromPolygons(l),$=h.unit(),T=p.unit();return b.properties.roundedCylinder=new CSG$2.Properties,b.properties.roundedCylinder.start=new CSG$2.Connector(n,$.negated(),T),b.properties.roundedCylinder.end=new CSG$2.Connector(r,$,T),b.properties.roundedCylinder.facepoint=n.plus(p),b},CSG$2.roundedCube=function(e){var t,n;if("corner1"in(e=e||{})||"corner2"in e){if("center"in e||"radius"in e)throw new Error("roundedCube: should either give a radius and center parameter, or a corner1 and corner2 parameter");corner1=CSG$2.parseOptionAs3DVector(e,"corner1",[0,0,0]),corner2=CSG$2.parseOptionAs3DVector(e,"corner2",[1,1,1]),t=corner1.plus(corner2).times(.5),n=corner2.minus(corner1).times(.5)}else t=CSG$2.parseOptionAs3DVector(e,"center",[0,0,0]),n=CSG$2.parseOptionAs3DVector(e,"radius",[1,1,1]);n=n.abs();var r=CSG$2.parseOptionAsInt(e,"resolution",CSG$2.defaultResolution3D);r<4&&(r=4),r%2==1&&r<8&&(r=8);var o=CSG$2.parseOptionAs3DVector(e,"roundradius",[.2,.2,.2]);o=CSG$2.Vector3D.Create(Math.max(o.x,.01),Math.max(o.y,.01),Math.max(o.z,.01));var i=n.minus(o);if(i.x<0||i.y<0||i.z<0)throw"roundradius <= radius!";var s=CSG$2.sphere({radius:1,resolution:r});return s=s.scale(o),i.x>1e-5&&(s=s.stretchAtPlane([1,0,0],[0,0,0],2*i.x)),i.y>1e-5&&(s=s.stretchAtPlane([0,1,0],[0,0,0],2*i.y)),i.z>1e-5&&(s=s.stretchAtPlane([0,0,1],[0,0,0],2*i.z)),s=s.translate([-i.x+t.x,-i.y+t.y,-i.z+t.z]),s=s.reTesselated(),s.properties.roundedCube=new CSG$2.Properties,s.properties.roundedCube.center=new CSG$2.Vertex(t),s.properties.roundedCube.facecenters=[new CSG$2.Connector(new CSG$2.Vector3D([n.x,0,0]).plus(t),[1,0,0],[0,0,1]),new CSG$2.Connector(new CSG$2.Vector3D([-n.x,0,0]).plus(t),[-1,0,0],[0,0,1]),new CSG$2.Connector(new CSG$2.Vector3D([0,n.y,0]).plus(t),[0,1,0],[0,0,1]),new CSG$2.Connector(new CSG$2.Vector3D([0,-n.y,0]).plus(t),[0,-1,0],[0,0,1]),new CSG$2.Connector(new CSG$2.Vector3D([0,0,n.z]).plus(t),[0,0,1],[1,0,0]),new CSG$2.Connector(new CSG$2.Vector3D([0,0,-n.z]).plus(t),[0,0,-1],[1,0,0])],s},CSG$2.polyhedron=function(e){if("points"in(e=e||{})!="faces"in e)throw new Error("polyhedron needs 'points' and 'faces' arrays");var t=CSG$2.parseOptionAs3DVectorList(e,"points",[[1,1,0],[1,-1,0],[-1,-1,0],[-1,1,0],[0,0,1]]).map(function(e){return new CSG$2.Vertex(e)}),n=CSG$2.parseOption(e,"faces",[[0,1,4],[1,2,4],[2,3,4],[3,0,4],[1,0,3],[2,1,3]]);n.forEach(function(e){e.reverse()});var r=n.map(function(e){return new CSG$2.Polygon(e.map(function(e){return t[e]}))});return CSG$2.fromPolygons(r).reTesselated()},CSG$2.IsFloat=function(e){return!isNaN(e)||e===1/0||e===-1/0},CSG$2.solve2Linear=function(e,t,n,r,o,i){var s=e*r-t*n,a=1/s,l=o*r-t*i,c=-o*n+e*i;return l*=a,c*=a,[l,c]},CSG$2.Vector3D=function(e,t,n){if(3==arguments.length)this._x=parseFloat(e),this._y=parseFloat(t),this._z=parseFloat(n);else if(2==arguments.length)this._x=parseFloat(e),this._y=parseFloat(t),this._z=0;else{var r=!0;if(1==arguments.length)if("object"==typeof e)e instanceof CSG$2.Vector3D?(this._x=e._x,this._y=e._y,this._z=e._z):e instanceof CSG$2.Vector2D?(this._x=e._x,this._y=e._y,this._z=0):e instanceof Array?e.length<2||e.length>3?r=!1:(this._x=parseFloat(e[0]),this._y=parseFloat(e[1]),3==e.length?this._z=parseFloat(e[2]):this._z=0):"_x"in e&&"_y"in e?(this._x=parseFloat(e._x),this._y=parseFloat(e._y),this._z="_z"in e?parseFloat(e._z):0):r=!1;else{var o=parseFloat(e);this._x=o,this._y=o,this._z=o}else r=!1;if(r&&(CSG$2.IsFloat(this._x)&&CSG$2.IsFloat(this._y)&&CSG$2.IsFloat(this._z)||(r=!1)),!r)throw new Error("wrong arguments")}},CSG$2.Vector3D.Create=function(e,t,n){var r=Object.create(CSG$2.Vector3D.prototype);return r._x=e,r._y=t,r._z=n,r},CSG$2.Vector3D.prototype={get x(){return this._x},get y(){return this._y},get z(){return this._z},set x(e){throw new Error("Vector3D is immutable")},set y(e){throw new Error("Vector3D is immutable")},set z(e){throw new Error("Vector3D is immutable")},clone:function(){return CSG$2.Vector3D.Create(this._x,this._y,this._z)},negated:function(){return CSG$2.Vector3D.Create(-this._x,-this._y,-this._z)},abs:function(){return CSG$2.Vector3D.Create(Math.abs(this._x),Math.abs(this._y),Math.abs(this._z))},plus:function(e){return CSG$2.Vector3D.Create(this._x+e._x,this._y+e._y,this._z+e._z)},minus:function(e){return CSG$2.Vector3D.Create(this._x-e._x,this._y-e._y,this._z-e._z)},times:function(e){return CSG$2.Vector3D.Create(this._x*e,this._y*e,this._z*e)},dividedBy:function(e){return CSG$2.Vector3D.Create(this._x/e,this._y/e,this._z/e)},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z},lerp:function(e,t){return this.plus(e.minus(this).times(t))},lengthSquared:function(){return this.dot(this)},length:function(){return Math.sqrt(this.lengthSquared())},unit:function(){return this.dividedBy(this.length())},cross:function(e){return CSG$2.Vector3D.Create(this._y*e._z-this._z*e._y,this._z*e._x-this._x*e._z,this._x*e._y-this._y*e._x)},distanceTo:function(e){return this.minus(e).length()},distanceToSquared:function(e){return this.minus(e).lengthSquared()},equals:function(e){return this._x==e._x&&this._y==e._y&&this._z==e._z},multiply4x4:function(e){return e.leftMultiply1x3Vector(this)},transform:function(e){return e.leftMultiply1x3Vector(this)},toString:function(){return"("+this._x.toFixed(2)+", "+this._y.toFixed(2)+", "+this._z.toFixed(2)+")"},randomNonParallelVector:function(){var e=this.abs();return e._x<=e._y&&e._x<=e._z?CSG$2.Vector3D.Create(1,0,0):e._y<=e._x&&e._y<=e._z?CSG$2.Vector3D.Create(0,1,0):CSG$2.Vector3D.Create(0,0,1)},min:function(e){return CSG$2.Vector3D.Create(Math.min(this._x,e._x),Math.min(this._y,e._y),Math.min(this._z,e._z))},max:function(e){return CSG$2.Vector3D.Create(Math.max(this._x,e._x),Math.max(this._y,e._y),Math.max(this._z,e._z))}},CSG$2.Vertex=function(e){this.pos=e},CSG$2.Vertex.fromObject=function(e){var t=new CSG$2.Vector3D(e.pos);return new CSG$2.Vertex(t)},CSG$2.Vertex.prototype={flipped:function(){return this},getTag:function(){var e=this.tag;return e||(e=CSG$2.getTag(),this.tag=e),e},interpolate:function(e,t){var n=this.pos.lerp(e.pos,t);return new CSG$2.Vertex(n)},transform:function(e){var t=this.pos.multiply4x4(e);return new CSG$2.Vertex(t)},toString:function(){return this.pos.toString()}},CSG$2.Plane=function(e,t){this.normal=e,this.w=t},CSG$2.Plane.fromObject=function(e){var t=new CSG$2.Vector3D(e.normal),n=parseFloat(e.w);return new CSG$2.Plane(t,n)},CSG$2.Plane.EPSILON=1e-5,CSG$2.Plane.fromVector3Ds=function(e,t,n){var r=t.minus(e).cross(n.minus(e)).unit();return new CSG$2.Plane(r,r.dot(e))},CSG$2.Plane.anyPlaneFromVector3Ds=function(e,t,n){var r=t.minus(e),o=n.minus(e);r.length()<1e-5&&(r=o.randomNonParallelVector()),o.length()<1e-5&&(o=r.randomNonParallelVector());var i=r.cross(o);return i.length()<1e-5&&(o=r.randomNonParallelVector(),i=r.cross(o)),i=i.unit(),new CSG$2.Plane(i,i.dot(e))},CSG$2.Plane.fromPoints=function(e,t,n){return e=new CSG$2.Vector3D(e),t=new CSG$2.Vector3D(t),n=new CSG$2.Vector3D(n),CSG$2.Plane.fromVector3Ds(e,t,n)},CSG$2.Plane.fromNormalAndPoint=function(e,t){e=new CSG$2.Vector3D(e),t=new CSG$2.Vector3D(t),e=e.unit();var n=t.dot(e);return new CSG$2.Plane(e,n)},CSG$2.Plane.prototype={flipped:function(){return new CSG$2.Plane(this.normal.negated(),-this.w)},getTag:function(){var e=this.tag;return e||(e=CSG$2.getTag(),this.tag=e),e},equals:function(e){return this.normal.equals(e.normal)&&this.w==e.w},transform:function(e){var t=e.isMirroring(),n=this.normal.randomNonParallelVector(),r=this.normal.cross(n),o=this.normal.cross(r),i=this.normal.times(this.w),s=i.plus(r),a=i.plus(o);i=i.multiply4x4(e),s=s.multiply4x4(e),a=a.multiply4x4(e);var l=CSG$2.Plane.fromVector3Ds(i,s,a);return t&&(l=l.flipped()),l},splitPolygon:function(e){var t=this,n={type:null,front:null,back:null},r=this.normal,o=e.vertices,i=o.length;if(e.plane.equals(this))n.type=0;else{for(var s=CSG$2.Plane.EPSILON,a=this.w,l=!1,c=!1,u=[],h=-s,p=0;p<i;p++){var f=r.dot(o[p].pos)-a,d=f<0;u.push(d),f>s&&(l=!0),f<h&&(c=!0)}if(l||c)if(c)if(l){n.type=4;for(var g=[],m=[],d=u[0],v=0;v<i;v++){var C=o[v],S=v+1;S>=i&&(S=0);var y=u[S];if(d==y)d?m.push(C):g.push(C);else{var w=C.pos,x=o[S].pos,G=t.splitLineBetweenPoints(w,x),b=new CSG$2.Vertex(G);d?(m.push(C),m.push(b),g.push(b)):(g.push(C),g.push(b),m.push(b))}d=y}var $=CSG$2.Plane.EPSILON*CSG$2.Plane.EPSILON;if(m.length>=3)for(var T=m[m.length-1],v=0;v<m.length;v++){var C=m[v];C.pos.distanceToSquared(T.pos)<$&&(m.splice(v,1),v--),T=C}if(g.length>=3)for(var T=g[g.length-1],v=0;v<g.length;v++){var C=g[v];C.pos.distanceToSquared(T.pos)<$&&(g.splice(v,1),v--),T=C}g.length>=3&&(n.front=new CSG$2.Polygon(g,e.shared,e.plane)),m.length>=3&&(n.back=new CSG$2.Polygon(m,e.shared,e.plane))}else n.type=3;else n.type=2;else{var f=r.dot(e.plane.normal);n.type=f>=0?0:1}}return n},splitLineBetweenPoints:function(e,t){var n=t.minus(e),r=(this.w-this.normal.dot(e))/this.normal.dot(n);return isNaN(r)&&(r=0),r>1&&(r=1),r<0&&(r=0),e.plus(n.times(r))},intersectWithLine:function(e){return e.intersectWithPlane(this)},intersectWithPlane:function(e){return CSG$2.Line3D.fromPlanes(this,e)},signedDistanceToPoint:function(e){return this.normal.dot(e)-this.w},toString:function(){return"[normal: "+this.normal.toString()+", w: "+this.w+"]"},mirrorPoint:function(e){var t=this.signedDistanceToPoint(e);return e.minus(this.normal.times(2*t))}},CSG$2.Polygon=function(e,t,n){this.vertices=e,t||(t=CSG$2.Polygon.defaultShared),this.shared=t,arguments.length>=3?this.plane=n:this.plane=CSG$2.Plane.fromVector3Ds(e[0].pos,e[1].pos,e[2].pos),_CSGDEBUG&&this.checkIfConvex()},CSG$2.Polygon.fromObject=function(e){var t=e.vertices.map(function(e){return CSG$2.Vertex.fromObject(e)}),n=CSG$2.Polygon.Shared.fromObject(e.shared),r=CSG$2.Plane.fromObject(e.plane);return new CSG$2.Polygon(t,n,r)},CSG$2.Polygon.prototype={checkIfConvex:function(){if(!CSG$2.Polygon.verticesConvex(this.vertices,this.plane.normal))throw CSG$2.Polygon.verticesConvex(this.vertices,this.plane.normal),new Error("Not convex!")},setColor:function(e){var t=CSG$2.Polygon.Shared.fromColor.apply(this,arguments);return this.shared=t,this},getSignedVolume:function(){for(var e=this,t=0,n=0;n<this.vertices.length-2;n++)t+=e.vertices[0].pos.dot(e.vertices[n+1].pos.cross(e.vertices[n+2].pos));return t/=6},getArea:function(){for(var e=this,t=0,n=0;n<this.vertices.length-2;n++)t+=e.vertices[n+1].pos.minus(e.vertices[0].pos).cross(e.vertices[n+2].pos.minus(e.vertices[n+1].pos)).length();return t/=2},getTetraFeatures:function(e){var t=[];return e.forEach(function(e){"volume"==e?t.push(this.getSignedVolume()):"area"==e&&t.push(this.getArea())},this),t},extrude:function(e){var t=this,n=[],r=this;r.plane.normal.dot(e)>0&&(r=r.flipped()),n.push(r);for(var o=r.translate(e),i=this.vertices.length,s=0;s<i;s++){var a=[],l=s<i-1?s+1:0;a.push(r.vertices[s].pos),a.push(o.vertices[s].pos),a.push(o.vertices[l].pos),a.push(r.vertices[l].pos);var c=CSG$2.Polygon.createFromPoints(a,t.shared);n.push(c)}return o=o.flipped(),n.push(o),CSG$2.fromPolygons(n)},translate:function(e){return this.transform(CSG$2.Matrix4x4.translation(e))},boundingSphere:function(){if(!this.cachedBoundingSphere){var e=this.boundingBox(),t=e[0].plus(e[1]).times(.5),n=e[1].minus(t),r=n.length();this.cachedBoundingSphere=[t,r]}return this.cachedBoundingSphere},boundingBox:function(){if(!this.cachedBoundingBox){var e,t,n=this.vertices,r=n.length;e=0===r?new CSG$2.Vector3D(0,0,0):n[0].pos,t=e;for(var o=1;o<r;o++){var i=n[o].pos;e=e.min(i),t=t.max(i)}this.cachedBoundingBox=[e,t]}return this.cachedBoundingBox},flipped:function(){var e=this.vertices.map(function(e){return e.flipped()});e.reverse();var t=this.plane.flipped();return new CSG$2.Polygon(e,this.shared,t)},transform:function(e){var t=this.vertices.map(function(t){return t.transform(e)}),n=this.plane.transform(e);return e.isMirroring()&&t.reverse(),new CSG$2.Polygon(t,this.shared,n)},toString:function(){var e="Polygon plane: "+this.plane.toString()+"\n";return this.vertices.map(function(t){e+="  "+t.toString()+"\n"}),e},projectToOrthoNormalBasis:function(e){var t=this.vertices.map(function(t){return e.to2D(t.pos)}),n=CAG$2.fromPointsNoCheck(t),r=n.area();return Math.abs(r)<1e-5?n=new CAG$2:r<0&&(n=n.flipped()),n},solidFromSlices:function(e){var t,n=this,r=[],o=null,i=null,s=null,a=null,l=2,c=!1,u=null;if(e&&(c=Boolean(e.loop),e.numslices&&(l=e.numslices),e.callback&&(t=e.callback)),!t){var h=new CSG$2.Polygon.createFromPoints([[0,0,0],[1,0,0],[1,1,0],[0,1,0]]);t=function(e,t){return 0==e||1==e?h.translate([0,0,e]):null}}for(var p=0,f=l-1;p<=f;p++)if(o=t.call(n,p/f,p)){if(!(o instanceof CSG$2.Polygon))throw new Error("CSG.Polygon.solidFromSlices callback error: CSG.Polygon expected");o.checkIfConvex(),i?(null===u&&(u=i.plane.signedDistanceToPoint(o.vertices[0].pos)<0),n._addWalls(r,i,o,u)):s=o,i=o}if(a=o,c){s.vertices.length==a.vertices.length&&s.vertices.every(function(e,t){return e.pos.equals(a.vertices[t].pos)})||this._addWalls(r,a,s,u)}else r.unshift(u?s:s.flipped()),r.push(u?a.flipped():a);return CSG$2.fromPolygons(r)},_addWalls:function(e,t,n,r){var o=t.vertices.slice(0),i=n.vertices.slice(0),s=n.shared||null;o[0].pos.equals(o[o.length-1].pos)||o.push(o[0]),i[0].pos.equals(i[i.length-1].pos)||i.push(i[0]),r&&(o=o.reverse(),i=i.reverse());for(var a=i.length-1,l=o.length-1,c=a-l,u=c>0,h=c<0,p=[],f=Math.abs(c);f>0;f--)p.push({len:1/0,index:-1});var d;if(h)for(var f=0;f<l;f++){d=o[f].pos.distanceToSquared(o[f+1].pos);for(var g=p.length-1;g>=0;g--)if(p[g].len>d){p[g].len=d,p.index=g;break}}else if(u)for(var f=0;f<a;f++){d=i[f].pos.distanceToSquared(i[f+1].pos);for(var g=p.length-1;g>=0;g--)if(p[g].len>d){p[g].len=d,p.index=g;break}}p.sort(fnSortByIndex);for(var m,v,C,S=function(e,t,n,r){return new CSG$2.Polygon([e,t,n],r)},y=o[0],w=i[0],x=0,G=0,b=a+l;x+G<b;){if(p.length){if(u&&G==p[0].index){m=i[++G],e.push(S(m,w,y,s)),w=m,p.shift();continue}if(h&&x==p[0].index){m=o[++x],e.push(S(w,y,m,s)),y=m,p.shift();continue}}v=x<l?w.pos.distanceToSquared(o[x+1].pos):1/0,C=G<a?y.pos.distanceToSquared(i[G+1].pos):1/0,v<=C?(m=o[++x],e.push(S(w,y,m,s)),y=m):G<a&&(m=i[++G],e.push(S(m,w,y,s)),w=m)}return e}},CSG$2.Polygon.verticesConvex=function(e,t){var n=e.length;if(n>2)for(var r=e[n-2].pos,o=e[n-1].pos,i=0;i<n;i++){var s=e[i].pos;if(!CSG$2.Polygon.isConvexPoint(r,o,s,t))return!1;r=o,o=s}return!0},CSG$2.Polygon.createFromPoints=function(e,t,n){arguments.length<3?new CSG$2.Vector3D(0,0,0):n.normal;var r=[];e.map(function(e){var t=new CSG$2.Vector3D(e),n=new CSG$2.Vertex(t);r.push(n)});return arguments.length<3?new CSG$2.Polygon(r,t):new CSG$2.Polygon(r,t,n)},CSG$2.Polygon.isConvexPoint=function(e,t,n,r){return t.minus(e).cross(n.minus(t)).dot(r)>=0},CSG$2.Polygon.isStrictlyConvexPoint=function(e,t,n,r){return t.minus(e).cross(n.minus(t)).dot(r)>=1e-5},CSG$2.Polygon.Shared=function(e){if(null!==e&&4!=e.length)throw new Error("Expecting 4 element array");this.color=e},CSG$2.Polygon.Shared.fromObject=function(e){return new CSG$2.Polygon.Shared(e.color)},CSG$2.Polygon.Shared.fromColor=function(e){var t,n=arguments;if(1==arguments.length)t=arguments[0].slice();else{t=[];for(var r=0;r<arguments.length;r++)t.push(n[r])}if(3==t.length)t.push(1);else if(4!=t.length)throw new Error("setColor expects either an array with 3 or 4 elements, or 3 or 4 parameters.");return new CSG$2.Polygon.Shared(t)},CSG$2.Polygon.Shared.prototype={getTag:function(){var e=this.tag;return e||(e=CSG$2.getTag(),this.tag=e),e},getHash:function(){return this.color?this.color.join("/"):"null"}},CSG$2.Polygon.defaultShared=new CSG$2.Polygon.Shared(null),CSG$2.PolygonTreeNode=function(){this.parent=null,this.children=[],this.polygon=null,this.removed=!1},CSG$2.PolygonTreeNode.prototype={addPolygons:function(e){if(!this.isRootNode())throw new Error("Assertion failed");var t=this;e.map(function(e){t.addChild(e)})},remove:function(){if(!this.removed){if(this.removed=!0,_CSGDEBUG){if(this.isRootNode())throw new Error("Assertion failed");if(this.children.length)throw new Error("Assertion failed")}var e=this.parent.children,t=e.indexOf(this);if(t<0)throw new Error("Assertion failed");e.splice(t,1),this.parent.recursivelyInvalidatePolygon()}},isRemoved:function(){return this.removed},isRootNode:function(){return!this.parent},invert:function(){if(!this.isRootNode())throw new Error("Assertion failed");this.invertSub()},getPolygon:function(){if(!this.polygon)throw new Error("Assertion failed");return this.polygon},getPolygons:function(e){var t,n,r,o,i=[this],s=[i];for(t=0;t<s.length;++t)for(i=s[t],n=0,r=i.length;n<r;n++)o=i[n],o.polygon?e.push(o.polygon):s.push(o.children)},splitByPlane:function(e,t,n,r,o){if(this.children.length){var i,s,a,l,c,u=[this.children];for(i=0;i<u.length;i++)for(c=u[i],s=0,a=c.length;s<a;s++)l=c[s],l.children.length?u.push(l.children):l._splitByPlane(e,t,n,r,o)}else this._splitByPlane(e,t,n,r,o)},_splitByPlane:function(e,t,n,r,o){var i=this.polygon;if(i){var s=i.boundingSphere(),a=s[1]+1e-4,l=e.normal,c=s[0],u=l.dot(c)-e.w;if(u>a)r.push(this);else if(u<-a)o.push(this);else{var h=e.splitPolygon(i);switch(h.type){case 0:t.push(this);break;case 1:n.push(this);break;case 2:r.push(this);break;case 3:o.push(this);break;case 4:if(h.front){var p=this.addChild(h.front);r.push(p)}if(h.back){var f=this.addChild(h.back);o.push(f)}}}}},addChild:function(e){var t=new CSG$2.PolygonTreeNode;return t.parent=this,t.polygon=e,this.children.push(t),t},invertSub:function(){var e,t,n,r,o=[this],i=[o];for(e=0;e<i.length;e++)for(o=i[e],t=0,n=o.length;t<n;t++)r=o[t],r.polygon&&(r.polygon=r.polygon.flipped()),i.push(r.children)},recursivelyInvalidatePolygon:function(){for(var e=this;e.polygon;)e.polygon=null,e.parent&&(e=e.parent)}},CSG$2.Tree=function(e){this.polygonTree=new CSG$2.PolygonTreeNode,this.rootnode=new CSG$2.Node(null),e&&this.addPolygons(e)},CSG$2.Tree.prototype={invert:function(){this.polygonTree.invert(),this.rootnode.invert()},clipTo:function(e,t){t=!!t,this.rootnode.clipTo(e,t)},allPolygons:function(){var e=[];return this.polygonTree.getPolygons(e),e},addPolygons:function(e){var t=this,n=e.map(function(e){return t.polygonTree.addChild(e)});this.rootnode.addPolygonTreeNodes(n)}},CSG$2.Node=function(e){this.plane=null,this.front=null,this.back=null,this.polygontreenodes=[],this.parent=e},CSG$2.Node.prototype={invert:function(){for(var e,t,n=[this],e=0;e<n.length;e++){t=n[e],t.plane&&(t.plane=t.plane.flipped()),t.front&&n.push(t.front),t.back&&n.push(t.back);var r=t.front;t.front=t.back,t.back=r}},clipPolygons:function(e,t){var n,r={node:this,polygontreenodes:e},o=[];do{if(n=r.node,e=r.polygontreenodes,n.plane){var i=[],s=[],a=t?i:s,l=n.plane,c=e.length;for(p=0;p<c;p++){var u=e[p];u.isRemoved()||u.splitByPlane(l,a,i,s,i)}n.front&&s.length>0&&o.push({node:n.front,polygontreenodes:s});var h=i.length;if(n.back&&h>0)o.push({node:n.back,polygontreenodes:i});else for(var p=0;p<h;p++)i[p].remove()}r=o.pop()}while(void 0!==r)},clipTo:function(e,t){var n=this,r=[];do{n.polygontreenodes.length>0&&e.rootnode.clipPolygons(n.polygontreenodes,t),n.front&&r.push(n.front),n.back&&r.push(n.back),n=r.pop()}while(void 0!==n)},addPolygonTreeNodes:function(e){var t,n={node:this,polygontreenodes:e},r=[];do{if(t=n.node,e=n.polygontreenodes,0!==e.length){var o=t;if(!t.plane){var i=e[0].getPolygon().plane;t.plane=i}for(var s=[],a=[],l=0,c=e.length;l<c;++l)e[l].splitByPlane(o.plane,o.polygontreenodes,a,s,a);s.length>0&&(t.front||(t.front=new CSG$2.Node(t)),r.push({node:t.front,polygontreenodes:s})),a.length>0&&(t.back||(t.back=new CSG$2.Node(t)),r.push({node:t.back,polygontreenodes:a})),n=r.pop()}else n=r.pop()}while(void 0!==n)},getParentPlaneNormals:function(e,t){t>0&&this.parent&&(e.push(this.parent.plane.normal),this.parent.getParentPlaneNormals(e,t-1))}},CSG$2.Matrix4x4=function(e){arguments.length>=1?this.elements=e:this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},CSG$2.Matrix4x4.prototype={plus:function(e){for(var t=this,n=[],r=0;r<16;r++)n[r]=t.elements[r]+e.elements[r];return new CSG$2.Matrix4x4(n)},minus:function(e){for(var t=this,n=[],r=0;r<16;r++)n[r]=t.elements[r]-e.elements[r];return new CSG$2.Matrix4x4(n)},multiply:function(e){var t=this.elements[0],n=this.elements[1],r=this.elements[2],o=this.elements[3],i=this.elements[4],s=this.elements[5],a=this.elements[6],l=this.elements[7],c=this.elements[8],u=this.elements[9],h=this.elements[10],p=this.elements[11],f=this.elements[12],d=this.elements[13],g=this.elements[14],m=this.elements[15],v=e.elements[0],C=e.elements[1],S=e.elements[2],y=e.elements[3],w=e.elements[4],x=e.elements[5],G=e.elements[6],b=e.elements[7],$=e.elements[8],T=e.elements[9],_=e.elements[10],D=e.elements[11],P=e.elements[12],A=e.elements[13],E=e.elements[14],N=e.elements[15],I=[];return I[0]=t*v+n*w+r*$+o*P,I[1]=t*C+n*x+r*T+o*A,I[2]=t*S+n*G+r*_+o*E,I[3]=t*y+n*b+r*D+o*N,I[4]=i*v+s*w+a*$+l*P,I[5]=i*C+s*x+a*T+l*A,I[6]=i*S+s*G+a*_+l*E,I[7]=i*y+s*b+a*D+l*N,I[8]=c*v+u*w+h*$+p*P,I[9]=c*C+u*x+h*T+p*A,
I[10]=c*S+u*G+h*_+p*E,I[11]=c*y+u*b+h*D+p*N,I[12]=f*v+d*w+g*$+m*P,I[13]=f*C+d*x+g*T+m*A,I[14]=f*S+d*G+g*_+m*E,I[15]=f*y+d*b+g*D+m*N,new CSG$2.Matrix4x4(I)},clone:function(){var e=this.elements.map(function(e){return e});return new CSG$2.Matrix4x4(e)},rightMultiply1x3Vector:function(e){var t=e._x,n=e._y,r=e._z,o=t*this.elements[0]+n*this.elements[1]+r*this.elements[2]+1*this.elements[3],i=t*this.elements[4]+n*this.elements[5]+r*this.elements[6]+1*this.elements[7],s=t*this.elements[8]+n*this.elements[9]+r*this.elements[10]+1*this.elements[11],a=t*this.elements[12]+n*this.elements[13]+r*this.elements[14]+1*this.elements[15];if(1!=a){var l=1/a;o*=l,i*=l,s*=l}return new CSG$2.Vector3D(o,i,s)},leftMultiply1x3Vector:function(e){var t=e._x,n=e._y,r=e._z,o=t*this.elements[0]+n*this.elements[4]+r*this.elements[8]+1*this.elements[12],i=t*this.elements[1]+n*this.elements[5]+r*this.elements[9]+1*this.elements[13],s=t*this.elements[2]+n*this.elements[6]+r*this.elements[10]+1*this.elements[14],a=t*this.elements[3]+n*this.elements[7]+r*this.elements[11]+1*this.elements[15];if(1!=a){var l=1/a;o*=l,i*=l,s*=l}return new CSG$2.Vector3D(o,i,s)},rightMultiply1x2Vector:function(e){var t=e.x,n=e.y,r=t*this.elements[0]+n*this.elements[1]+0*this.elements[2]+1*this.elements[3],o=t*this.elements[4]+n*this.elements[5]+0*this.elements[6]+1*this.elements[7],i=t*this.elements[8]+n*this.elements[9]+0*this.elements[10]+1*this.elements[11],s=t*this.elements[12]+n*this.elements[13]+0*this.elements[14]+1*this.elements[15];if(1!=s){var a=1/s;r*=a,o*=a,i*=a}return new CSG$2.Vector2D(r,o)},leftMultiply1x2Vector:function(e){var t=e.x,n=e.y,r=t*this.elements[0]+n*this.elements[4]+0*this.elements[8]+1*this.elements[12],o=t*this.elements[1]+n*this.elements[5]+0*this.elements[9]+1*this.elements[13],i=t*this.elements[2]+n*this.elements[6]+0*this.elements[10]+1*this.elements[14],s=t*this.elements[3]+n*this.elements[7]+0*this.elements[11]+1*this.elements[15];if(1!=s){var a=1/s;r*=a,o*=a,i*=a}return new CSG$2.Vector2D(r,o)},isMirroring:function(){var e=new CSG$2.Vector3D(this.elements[0],this.elements[4],this.elements[8]),t=new CSG$2.Vector3D(this.elements[1],this.elements[5],this.elements[9]),n=new CSG$2.Vector3D(this.elements[2],this.elements[6],this.elements[10]);return e.cross(t).dot(n)<0}},CSG$2.Matrix4x4.unity=function(){return new CSG$2.Matrix4x4},CSG$2.Matrix4x4.rotationX=function(e){var t=e*Math.PI*(1/180),n=Math.cos(t),r=Math.sin(t),o=[1,0,0,0,0,n,r,0,0,-r,n,0,0,0,0,1];return new CSG$2.Matrix4x4(o)},CSG$2.Matrix4x4.rotationY=function(e){var t=e*Math.PI*(1/180),n=Math.cos(t),r=Math.sin(t),o=[n,0,-r,0,0,1,0,0,r,0,n,0,0,0,0,1];return new CSG$2.Matrix4x4(o)},CSG$2.Matrix4x4.rotationZ=function(e){var t=e*Math.PI*(1/180),n=Math.cos(t),r=Math.sin(t),o=[n,r,0,0,-r,n,0,0,0,0,1,0,0,0,0,1];return new CSG$2.Matrix4x4(o)},CSG$2.Matrix4x4.rotation=function(e,t,n){e=new CSG$2.Vector3D(e),t=new CSG$2.Vector3D(t);var r=CSG$2.Plane.fromNormalAndPoint(t,e),o=new CSG$2.OrthoNormalBasis(r),i=CSG$2.Matrix4x4.translation(e.negated());return i=i.multiply(o.getProjectionMatrix()),i=i.multiply(CSG$2.Matrix4x4.rotationZ(n)),i=i.multiply(o.getInverseProjectionMatrix()),i=i.multiply(CSG$2.Matrix4x4.translation(e))},CSG$2.Matrix4x4.translation=function(e){var t=new CSG$2.Vector3D(e),n=[1,0,0,0,0,1,0,0,0,0,1,0,t.x,t.y,t.z,1];return new CSG$2.Matrix4x4(n)},CSG$2.Matrix4x4.mirroring=function(e){var t=e.normal.x,n=e.normal.y,r=e.normal.z,o=e.w,i=[1-2*t*t,-2*n*t,-2*r*t,0,-2*t*n,1-2*n*n,-2*r*n,0,-2*t*r,-2*n*r,1-2*r*r,0,2*t*o,2*n*o,2*r*o,1];return new CSG$2.Matrix4x4(i)},CSG$2.Matrix4x4.scaling=function(e){var t=new CSG$2.Vector3D(e),n=[t.x,0,0,0,0,t.y,0,0,0,0,t.z,0,0,0,0,1];return new CSG$2.Matrix4x4(n)},CSG$2.Vector2D=function(e,t){if(2==arguments.length)this._x=parseFloat(e),this._y=parseFloat(t);else{var n=!0;if(1==arguments.length)if("object"==typeof e)e instanceof CSG$2.Vector2D?(this._x=e._x,this._y=e._y):e instanceof Array?(this._x=parseFloat(e[0]),this._y=parseFloat(e[1])):"x"in e&&"y"in e?(this._x=parseFloat(e.x),this._y=parseFloat(e.y)):n=!1;else{var r=parseFloat(e);this._x=r,this._y=r}else n=!1;if(n&&(CSG$2.IsFloat(this._x)&&CSG$2.IsFloat(this._y)||(n=!1)),!n)throw new Error("wrong arguments")}},CSG$2.Vector2D.fromAngle=function(e){return CSG$2.Vector2D.fromAngleRadians(e)},CSG$2.Vector2D.fromAngleDegrees=function(e){var t=Math.PI*e/180;return CSG$2.Vector2D.fromAngleRadians(t)},CSG$2.Vector2D.fromAngleRadians=function(e){return CSG$2.Vector2D.Create(Math.cos(e),Math.sin(e))},CSG$2.Vector2D.Create=function(e,t){var n=Object.create(CSG$2.Vector2D.prototype);return n._x=e,n._y=t,n},CSG$2.Vector2D.prototype={get x(){return this._x},get y(){return this._y},set x(e){throw new Error("Vector2D is immutable")},set y(e){throw new Error("Vector2D is immutable")},toVector3D:function(e){return new CSG$2.Vector3D(this._x,this._y,e)},equals:function(e){return this._x==e._x&&this._y==e._y},clone:function(){return CSG$2.Vector2D.Create(this._x,this._y)},negated:function(){return CSG$2.Vector2D.Create(-this._x,-this._y)},plus:function(e){return CSG$2.Vector2D.Create(this._x+e._x,this._y+e._y)},minus:function(e){return CSG$2.Vector2D.Create(this._x-e._x,this._y-e._y)},times:function(e){return CSG$2.Vector2D.Create(this._x*e,this._y*e)},dividedBy:function(e){return CSG$2.Vector2D.Create(this._x/e,this._y/e)},dot:function(e){return this._x*e._x+this._y*e._y},lerp:function(e,t){return this.plus(e.minus(this).times(t))},length:function(){return Math.sqrt(this.dot(this))},distanceTo:function(e){return this.minus(e).length()},distanceToSquared:function(e){return this.minus(e).lengthSquared()},lengthSquared:function(){return this.dot(this)},unit:function(){return this.dividedBy(this.length())},cross:function(e){return this._x*e._y-this._y*e._x},normal:function(){return CSG$2.Vector2D.Create(this._y,-this._x)},multiply4x4:function(e){return e.leftMultiply1x2Vector(this)},transform:function(e){return e.leftMultiply1x2Vector(this)},angle:function(){return this.angleRadians()},angleDegrees:function(){return 180*this.angleRadians()/Math.PI},angleRadians:function(){return Math.atan2(this._y,this._x)},min:function(e){return CSG$2.Vector2D.Create(Math.min(this._x,e._x),Math.min(this._y,e._y))},max:function(e){return CSG$2.Vector2D.Create(Math.max(this._x,e._x),Math.max(this._y,e._y))},toString:function(){return"("+this._x.toFixed(2)+", "+this._y.toFixed(2)+")"},abs:function(){return CSG$2.Vector2D.Create(Math.abs(this._x),Math.abs(this._y))}},CSG$2.Line2D=function(e,t){e=new CSG$2.Vector2D(e),t=parseFloat(t);var n=e.length();t*=n,e=e.times(1/n),this.normal=e,this.w=t},CSG$2.Line2D.fromPoints=function(e,t){e=new CSG$2.Vector2D(e),t=new CSG$2.Vector2D(t);var n=t.minus(e),r=n.normal().negated().unit(),o=e.dot(r);return new CSG$2.Line2D(r,o)},CSG$2.Line2D.prototype={reverse:function(){return new CSG$2.Line2D(this.normal.negated(),-this.w)},equals:function(e){return e.normal.equals(this.normal)&&e.w==this.w},origin:function(){return this.normal.times(this.w)},direction:function(){return this.normal.normal()},xAtY:function(e){return(this.w-this.normal._y*e)/this.normal.x},absDistanceToPoint:function(e){e=new CSG$2.Vector2D(e);var t=e.dot(this.normal);return Math.abs(t-this.w)},intersectWithLine:function(e){var t=CSG$2.solve2Linear(this.normal.x,this.normal.y,e.normal.x,e.normal.y,this.w,e.w);return t=new CSG$2.Vector2D(t)},transform:function(e){var t=new CSG$2.Vector2D(0,0),n=this.normal.times(this.w),r=t.multiply4x4(e),o=this.normal.multiply4x4(e),i=o.minus(r),s=n.multiply4x4(e),a=i.dot(s);return new CSG$2.Line2D(i,a)}},CSG$2.Line3D=function(e,t){e=new CSG$2.Vector3D(e),t=new CSG$2.Vector3D(t),this.point=e,this.direction=t.unit()},CSG$2.Line3D.fromPoints=function(e,t){e=new CSG$2.Vector3D(e),t=new CSG$2.Vector3D(t);var n=t.minus(e);return new CSG$2.Line3D(e,n)},CSG$2.Line3D.fromPlanes=function(e,t){var n=e.normal.cross(t.normal),r=n.length();if(r<1e-10)throw new Error("Parallel planes");n=n.times(1/r);var o,i=Math.abs(n.x),s=Math.abs(n.y),a=Math.abs(n.z);if(i>=s&&i>=a){var l=CSG$2.solve2Linear(e.normal.y,e.normal.z,t.normal.y,t.normal.z,e.w,t.w);o=new CSG$2.Vector3D(0,l[0],l[1])}else if(s>=i&&s>=a){var l=CSG$2.solve2Linear(e.normal.x,e.normal.z,t.normal.x,t.normal.z,e.w,t.w);o=new CSG$2.Vector3D(l[0],0,l[1])}else{var l=CSG$2.solve2Linear(e.normal.x,e.normal.y,t.normal.x,t.normal.y,e.w,t.w);o=new CSG$2.Vector3D(l[0],l[1],0)}return new CSG$2.Line3D(o,n)},CSG$2.Line3D.prototype={intersectWithPlane:function(e){var t=(e.w-e.normal.dot(this.point))/e.normal.dot(this.direction);return this.point.plus(this.direction.times(t))},clone:function(e){return new CSG$2.Line3D(this.point.clone(),this.direction.clone())},reverse:function(){return new CSG$2.Line3D(this.point.clone(),this.direction.negated())},transform:function(e){var t=this.point.multiply4x4(e),n=this.point.plus(this.direction),r=n.multiply4x4(e),o=r.minus(t);return new CSG$2.Line3D(t,o)},closestPointOnLine:function(e){e=new CSG$2.Vector3D(e);var t=e.minus(this.point).dot(this.direction)/this.direction.dot(this.direction);return this.point.plus(this.direction.times(t))},distanceToPoint:function(e){e=new CSG$2.Vector3D(e);var t=this.closestPointOnLine(e);return e.minus(t).length()},equals:function(e){return!!this.direction.equals(e.direction)&&!(this.distanceToPoint(e.point)>1e-8)}},CSG$2.OrthoNormalBasis=function(e,t){t=arguments.length<2?e.normal.randomNonParallelVector():new CSG$2.Vector3D(t),this.v=e.normal.cross(t).unit(),this.u=this.v.cross(e.normal),this.plane=e,this.planeorigin=e.normal.times(e.w)},CSG$2.OrthoNormalBasis.GetCartesian=function(e,t){var n,r,o=e+"/"+t;if("X/Y"==o)n=[0,0,1],r=[1,0,0];else if("Y/-X"==o)n=[0,0,1],r=[0,1,0];else if("-X/-Y"==o)n=[0,0,1],r=[-1,0,0];else if("-Y/X"==o)n=[0,0,1],r=[0,-1,0];else if("-X/Y"==o)n=[0,0,-1],r=[-1,0,0];else if("-Y/-X"==o)n=[0,0,-1],r=[0,-1,0];else if("X/-Y"==o)n=[0,0,-1],r=[1,0,0];else if("Y/X"==o)n=[0,0,-1],r=[0,1,0];else if("X/Z"==o)n=[0,-1,0],r=[1,0,0];else if("Z/-X"==o)n=[0,-1,0],r=[0,0,1];else if("-X/-Z"==o)n=[0,-1,0],r=[-1,0,0];else if("-Z/X"==o)n=[0,-1,0],r=[0,0,-1];else if("-X/Z"==o)n=[0,1,0],r=[-1,0,0];else if("-Z/-X"==o)n=[0,1,0],r=[0,0,-1];else if("X/-Z"==o)n=[0,1,0],r=[1,0,0];else if("Z/X"==o)n=[0,1,0],r=[0,0,1];else if("Y/Z"==o)n=[1,0,0],r=[0,1,0];else if("Z/-Y"==o)n=[1,0,0],r=[0,0,1];else if("-Y/-Z"==o)n=[1,0,0],r=[0,-1,0];else if("-Z/Y"==o)n=[1,0,0],r=[0,0,-1];else if("-Y/Z"==o)n=[-1,0,0],r=[0,-1,0];else if("-Z/-Y"==o)n=[-1,0,0],r=[0,0,-1];else if("Y/-Z"==o)n=[-1,0,0],r=[0,1,0];else{if("Z/Y"!=o)throw new Error("CSG.OrthoNormalBasis.GetCartesian: invalid combination of axis identifiers. Should pass two string arguments from [X,Y,Z,-X,-Y,-Z], being two different axes.");n=[-1,0,0],r=[0,0,1]}return new CSG$2.OrthoNormalBasis(new CSG$2.Plane(new CSG$2.Vector3D(n),0),new CSG$2.Vector3D(r))},CSG$2.OrthoNormalBasis.Z0Plane=function(){var e=new CSG$2.Plane(new CSG$2.Vector3D([0,0,1]),0);return new CSG$2.OrthoNormalBasis(e,new CSG$2.Vector3D([1,0,0]))},CSG$2.OrthoNormalBasis.prototype={getProjectionMatrix:function(){return new CSG$2.Matrix4x4([this.u.x,this.v.x,this.plane.normal.x,0,this.u.y,this.v.y,this.plane.normal.y,0,this.u.z,this.v.z,this.plane.normal.z,0,0,0,-this.plane.w,1])},getInverseProjectionMatrix:function(){var e=this.plane.normal.times(this.plane.w);return new CSG$2.Matrix4x4([this.u.x,this.u.y,this.u.z,0,this.v.x,this.v.y,this.v.z,0,this.plane.normal.x,this.plane.normal.y,this.plane.normal.z,0,e.x,e.y,e.z,1])},to2D:function(e){return new CSG$2.Vector2D(e.dot(this.u),e.dot(this.v))},to3D:function(e){return this.planeorigin.plus(this.u.times(e.x)).plus(this.v.times(e.y))},line3Dto2D:function(e){var t=e.point,n=e.direction.plus(t),r=this.to2D(t),o=this.to2D(n);return CSG$2.Line2D.fromPoints(r,o)},line2Dto3D:function(e){var t=e.origin(),n=e.direction().plus(t),r=this.to3D(t),o=this.to3D(n);return CSG$2.Line3D.fromPoints(r,o)},transform:function(e){var t=this.plane.transform(e),n=this.u.transform(e),r=new CSG$2.Vector3D(0,0,0).transform(e),o=n.minus(r);return new CSG$2.OrthoNormalBasis(t,o)}},CSG$2.interpolateBetween2DPointsForY=function(e,t,n){var r=n-e.y,o=t.y-e.y;o<0&&(r=-r,o=-o);var i;return i=r<=0?0:r>=o?1:o<1e-10?.5:r/o,e.x+i*(t.x-e.x)},CSG$2.reTesselateCoplanarPolygons=function(e,t){var n=e.length;if(n>0){for(var r=e[0].plane,o=e[0].shared,i=new CSG$2.OrthoNormalBasis(r),s=[],a=[],l={},c={},u={},h=0;h<n;h++){var p=e[h],f=[],d=p.vertices.length,g=-1;if(d>0){for(var m,v,C=0;C<d;C++){var S,y=i.to2D(p.vertices[C].pos),w=Math.floor(y.y*(1/1e-5*10));w in u?S=u[w]:w+1 in u?S=u[w+1]:w-1 in u?S=u[w-1]:(S=y.y,u[w]=y.y),y=CSG$2.Vector2D.Create(y.x,S),f.push(y);var x=y.y;(0===C||x<m)&&(m=x,g=C),(0===C||x>v)&&(v=x,C),x in c||(c[x]={}),c[x][h]=!0}m>=v?(f=[],d=0,g=-1):(m in l||(l[m]=[]),l[m].push(h))}f.reverse(),g=d-g-1,s.push(f),a.push(g)}var G=[];for(var b in c)G.push(b);G.sort(fnNumberSort);for(var $=[],T=[],_=0;_<G.length;_++){for(var D=[],P=G[_],b=Number(P),A=c[P],E=0;E<$.length;++E){var N=$[E],h=N.polygonindex;if(A[h]){for(var f=s[h],d=f.length,I=N.leftvertexindex,O=N.rightvertexindex;;){var V=I+1;if(V>=d&&(V=0),f[V].y!=b)break;I=V}var M=O-1;if(M<0&&(M=d-1),f[M].y==b&&(O=M),I!=N.leftvertexindex&&I==O)$.splice(E,1),--E;else{N.leftvertexindex=I,N.rightvertexindex=O,N.topleft=f[I],N.topright=f[O];var V=I+1;V>=d&&(V=0),N.bottomleft=f[V];var M=O-1;M<0&&(M=d-1),N.bottomright=f[M]}}}var F;if(_>=G.length-1)$=[],F=null;else{F=Number(G[_+1]);var k=.5*(b+F),R=l[P];for(var L in R){for(var h=R[L],f=s[h],d=f.length,j=a[h],z=j;;){var C=z+1;if(C>=d&&(C=0),f[C].y!=b)break;if(C==j)break;z=C}for(var B=j;;){var C=B-1;if(C<0&&(C=d-1),f[C].y!=b)break;if(C==z)break;B=C}var V=z+1;V>=d&&(V=0);var M=B-1;M<0&&(M=d-1);insertSorted($,{polygonindex:h,leftvertexindex:z,rightvertexindex:B,topleft:f[z],topright:f[B],bottomleft:f[V],bottomright:f[M]},function(e,t){var n=CSG$2.interpolateBetween2DPointsForY(e.topleft,e.bottomleft,k),r=CSG$2.interpolateBetween2DPointsForY(t.topleft,t.bottomleft,k);return n>r?1:n<r?-1:0})}}for(var X in $){var N=$[X],h=N.polygonindex,f=s[h],d=f.length,Y=CSG$2.interpolateBetween2DPointsForY(N.topleft,N.bottomleft,b),U=CSG$2.Vector2D.Create(Y,b);Y=CSG$2.interpolateBetween2DPointsForY(N.topright,N.bottomright,b);var q=CSG$2.Vector2D.Create(Y,b);Y=CSG$2.interpolateBetween2DPointsForY(N.topleft,N.bottomleft,F);var W=CSG$2.Vector2D.Create(Y,F);Y=CSG$2.interpolateBetween2DPointsForY(N.topright,N.bottomright,F);var H=CSG$2.Vector2D.Create(Y,F),Z={topleft:U,topright:q,bottomleft:W,bottomright:H,leftline:CSG$2.Line2D.fromPoints(U,W),rightline:CSG$2.Line2D.fromPoints(H,q)};if(D.length>0){var J=D[D.length-1],Q=Z.topleft.distanceTo(J.topright),K=Z.bottomleft.distanceTo(J.bottomright);Q<1e-5&&K<1e-5&&(Z.topleft=J.topleft,Z.leftline=J.leftline,Z.bottomleft=J.bottomleft,D.splice(D.length-1,1))}D.push(Z)}if(_>0){for(var ee={},te={},C=0;C<D.length;C++)for(var ne=D[C],re=0;re<T.length;re++)if(!te[re]){var oe=T[re];if(oe.bottomleft.distanceTo(ne.topleft)<1e-5&&oe.bottomright.distanceTo(ne.topright)<1e-5){te[re]=!0;var Q=ne.leftline.direction().x-oe.leftline.direction().x,K=ne.rightline.direction().x-oe.rightline.direction().x,ie=Math.abs(Q)<1e-5,se=Math.abs(K)<1e-5,ae=ie||Q>=0,le=se||K>=0;ae&&le&&(ne.outpolygon=oe.outpolygon,ne.leftlinecontinues=ie,ne.rightlinecontinues=se,ee[re]=!0);break}}for(var re=0;re<T.length;re++)if(!ee[re]){var oe=T[re];oe.outpolygon.rightpoints.push(oe.bottomright),oe.bottomright.distanceTo(oe.bottomleft)>1e-5&&oe.outpolygon.leftpoints.push(oe.bottomleft),oe.outpolygon.leftpoints.reverse();var ce=oe.outpolygon.rightpoints.concat(oe.outpolygon.leftpoints),ue=[];ce.map(function(e){var t=i.to3D(e),n=new CSG$2.Vertex(t);ue.push(n)});var he=new CSG$2.Polygon(ue,o,r);t.push(he)}}for(var C=0;C<D.length;C++){var ne=D[C];ne.outpolygon?(ne.leftlinecontinues||ne.outpolygon.leftpoints.push(ne.topleft),ne.rightlinecontinues||ne.outpolygon.rightpoints.push(ne.topright)):(ne.outpolygon={leftpoints:[],rightpoints:[]},ne.outpolygon.leftpoints.push(ne.topleft),ne.topleft.distanceTo(ne.topright)>1e-5&&ne.outpolygon.rightpoints.push(ne.topright))}T=D}}},CSG$2.fuzzyFactory=function(e,t){this.lookuptable={},this.multiplier=1/t},CSG$2.fuzzyFactory.prototype={lookupOrCreate:function(e,t){var n=this,r="",o=this.multiplier;if(e.forEach(function(e){var t=Math.round(e*o);r+=t+"/"}),r in this.lookuptable)return this.lookuptable[r];for(var i=t(e),s=e.map(function(e){var t=Math.floor(e*o);return[t+"/",t+1+"/"]}),a=e.length,l=1<<a,c=0;c<l;++c){var u=c;r="",s.forEach(function(e){r+=e[1&u],u>>=1}),n.lookuptable[r]=i}return i}},CSG$2.fuzzyCSGFactory=function(){this.vertexfactory=new CSG$2.fuzzyFactory(3,1e-5),this.planefactory=new CSG$2.fuzzyFactory(4,1e-5),this.polygonsharedfactory={}},CSG$2.fuzzyCSGFactory.prototype={getPolygonShared:function(e){var t=e.getHash();return t in this.polygonsharedfactory?this.polygonsharedfactory[t]:(this.polygonsharedfactory[t]=e,e)},getVertex:function(e){var t=[e.pos._x,e.pos._y,e.pos._z];return this.vertexfactory.lookupOrCreate(t,function(t){return e})},getPlane:function(e){var t=[e.normal._x,e.normal._y,e.normal._z,e.w];return this.planefactory.lookupOrCreate(t,function(t){return e})},getPolygon:function(e){var t=this.getPlane(e.plane),n=this.getPolygonShared(e.shared),r=this,o=e.vertices.map(function(e){return r.getVertex(e)}),i=[];if(o.length>0){var s=o[o.length-1].getTag();o.forEach(function(e){var t=e.getTag();t!=s&&i.push(e),s=t})}return i.length<3&&(i=[]),new CSG$2.Polygon(i,n,t)},getCSG:function(e){var t=this,n=[];return e.polygons.forEach(function(e){var r=t.getPolygon(e);r.vertices.length>=3&&n.push(r)}),CSG$2.fromPolygons(n)}},CSG$2.staticTag=1,CSG$2.getTag=function(){return CSG$2.staticTag++},CSG$2.Properties=function(){},CSG$2.Properties.prototype={_transform:function(e){var t=new CSG$2.Properties;return CSG$2.Properties.transformObj(this,t,e),t},_merge:function(e){var t=new CSG$2.Properties;return CSG$2.Properties.cloneObj(this,t),CSG$2.Properties.addFrom(t,e),t}},CSG$2.Properties.transformObj=function(e,t,n){for(var r in e)if("_transform"!=r&&"_merge"!=r){var o=e[r],i=o;"object"==typeof o&&("transform"in o&&"function"==typeof o.transform?i=o.transform(n):o instanceof Array?(i=[],CSG$2.Properties.transformObj(o,i,n)):o instanceof CSG$2.Properties&&(i=new CSG$2.Properties,CSG$2.Properties.transformObj(o,i,n))),t[r]=i}},CSG$2.Properties.cloneObj=function(e,t){for(var n in e)if("_transform"!=n&&"_merge"!=n){var r=e[n],o=r;if("object"==typeof r)if(r instanceof Array){o=[];for(var i=0;i<r.length;i++)o.push(r[i])}else r instanceof CSG$2.Properties&&(o=new CSG$2.Properties,CSG$2.Properties.cloneObj(r,o));t[n]=o}},CSG$2.Properties.addFrom=function(e,t){for(var n in t)"_transform"!=n&&"_merge"!=n&&(n in e&&"object"==typeof e[n]&&e[n]instanceof CSG$2.Properties&&"object"==typeof t[n]&&t[n]instanceof CSG$2.Properties?CSG$2.Properties.addFrom(e[n],t[n]):n in e||(e[n]=t[n]))},CSG$2.Connector=function(e,t,n){this.point=new CSG$2.Vector3D(e),this.axisvector=new CSG$2.Vector3D(t).unit(),this.normalvector=new CSG$2.Vector3D(n).unit()},CSG$2.Connector.prototype={normalized:function(){var e=this.axisvector.unit(),t=this.normalvector.cross(e).unit(),n=e.cross(t);return new CSG$2.Connector(this.point,e,n)},transform:function(e){var t=this.point.multiply4x4(e),n=this.point.plus(this.axisvector).multiply4x4(e).minus(t),r=this.point.plus(this.normalvector).multiply4x4(e).minus(t);return new CSG$2.Connector(t,n,r)},getTransformationTo:function(e,t,n){t=!!t,n=n?Number(n):0;var r=this.normalized();e=e.normalized();var o=CSG$2.Matrix4x4.translation(this.point.negated()),i=CSG$2.Plane.anyPlaneFromVector3Ds(new CSG$2.Vector3D(0,0,0),r.axisvector,e.axisvector),s=new CSG$2.OrthoNormalBasis(i),a=s.to2D(r.axisvector).angle(),l=s.to2D(e.axisvector).angle(),c=180*(l-a)/Math.PI;t&&(c+=180),o=o.multiply(s.getProjectionMatrix()),o=o.multiply(CSG$2.Matrix4x4.rotationZ(c)),o=o.multiply(s.getInverseProjectionMatrix());var u=r.transform(o),h=CSG$2.Plane.fromNormalAndPoint(e.axisvector,new CSG$2.Vector3D(0,0,0)),p=new CSG$2.OrthoNormalBasis(h);return a=p.to2D(u.normalvector).angle(),l=p.to2D(e.normalvector).angle(),c=180*(l-a)/Math.PI,c+=n,o=o.multiply(p.getProjectionMatrix()),o=o.multiply(CSG$2.Matrix4x4.rotationZ(c)),o=o.multiply(p.getInverseProjectionMatrix()),o=o.multiply(CSG$2.Matrix4x4.translation(e.point))},axisLine:function(){return new CSG$2.Line3D(this.point,this.axisvector)},extend:function(e){var t=this.point.plus(this.axisvector.unit().times(e));return new CSG$2.Connector(t,this.axisvector,this.normalvector)}},CSG$2.ConnectorList=function(e){this.connectors_=e?e.slice():[]},CSG$2.ConnectorList.defaultNormal=[0,0,1],CSG$2.ConnectorList.fromPath2D=function(e,t,n){if(3===arguments.length)return CSG$2.ConnectorList._fromPath2DTangents(e,t,n);if(2==arguments.length)return CSG$2.ConnectorList._fromPath2DExplicit(e,t);throw"call with path2D and either 2 direction vectors, or a function returning direction vectors"},CSG$2.ConnectorList._fromPath2DTangents=function(e,t,n){var r,o=e.points.length,i=new CSG$2.ConnectorList([new CSG$2.Connector(e.points[0],t,CSG$2.ConnectorList.defaultNormal)]);return e.points.slice(1,o-1).forEach(function(t,n){r=e.points[n+2].minus(e.points[n]).toVector3D(0),i.appendConnector(new CSG$2.Connector(t.toVector3D(0),r,CSG$2.ConnectorList.defaultNormal))},this),i.appendConnector(new CSG$2.Connector(e.points[o-1],n,CSG$2.ConnectorList.defaultNormal)),i.closed=e.closed,i},CSG$2.ConnectorList._fromPath2DExplicit=function(e,t){function n(e,t,n){return"function"==typeof e&&(e=e(t,n)),e}var r=new CSG$2.ConnectorList(e.points.map(function(e,r){return new CSG$2.Connector(e.toVector3D(0),CSG$2.Vector3D.Create(1,0,0).rotateZ(n(t,e,r)),CSG$2.ConnectorList.defaultNormal)},this));return r.closed=e.closed,r},CSG$2.ConnectorList.prototype={setClosed:function(e){this.closed=!!closed},appendConnector:function(e){this.connectors_.push(e)},followWith:function(e){function t(e,t){return"function"==typeof e&&(e=e(t.point,t.axisvector,t.normalvector)),e}this.verify();var n,r=[],o=this.connectors_[this.connectors_.length-1],i=t(e,o);return this.connectors_.forEach(function(s,a){n=t(e,s),a||this.closed?r.push.apply(r,i._toWallPolygons({toConnector1:o,toConnector2:s,cag:n})):r.push.apply(r,n._toPlanePolygons({toConnector:s,flipped:!0})),a!=this.connectors_.length-1||this.closed||r.push.apply(r,n._toPlanePolygons({toConnector:s})),i=n,o=s},this),CSG$2.fromPolygons(r).reTesselated().canonicalized()},verify:function(){for(var e,t,n=this,r=0;r<this.connectors_.length-1;r++){if(e=n.connectors_[r],t=n.connectors_[r+1],t.point.minus(e.point).dot(e.axisvector)<=0)throw"Invalid ConnectorList. Each connectors position needs to be within a <90deg range of previous connectors axisvector";if(e.axisvector.dot(t.axisvector)<=0)throw"invalid ConnectorList. No neighboring connectors axisvectors may span a >=90deg angle"}}},CSG$2.Path2D=function(e,t){t=!!t,e=e||[];var n=null;t&&e.length>0&&(n=new CSG$2.Vector2D(e[e.length-1]));var r=[];e.map(function(e){e=new CSG$2.Vector2D(e);var t=!1;if(null!==n){t=e.distanceTo(n)<1e-5}t||r.push(e),n=e}),this.points=r,this.closed=t},CSG$2.Path2D.arc=function(e){for(var t=CSG$2.parseOptionAs2DVector(e,"center",0),n=CSG$2.parseOptionAsFloat(e,"radius",1),r=CSG$2.parseOptionAsFloat(e,"startangle",0),o=CSG$2.parseOptionAsFloat(e,"endangle",360),i=CSG$2.parseOptionAsInt(e,"resolution",CSG$2.defaultResolution2D),s=CSG$2.parseOptionAsBool(e,"maketangent",!1);o-r>=720;)o-=360;for(;o-r<=-720;)o+=360;var a,l=[],c=Math.abs(o-r);if(c<1e-5)a=CSG$2.Vector2D.fromAngle(r/180*Math.PI).times(n),l.push(a.plus(t));else{var u=Math.floor(i*c/360)+1,h=.5*u/c;h>.25&&(h=.25);for(var p=s?u+2:u,f=0;f<=p;f++){var d=f;s&&(d=(f-1)*(u-2*h)/u+h,d<0&&(d=0),d>u&&(d=u));var g=r+d*(o-r)/u;a=CSG$2.Vector2D.fromAngle(g/180*Math.PI).times(n),l.push(a.plus(t))}}return new CSG$2.Path2D(l,!1)},CSG$2.Path2D.prototype={concat:function(e){if(this.closed||e.closed)throw new Error("Paths must not be closed");var t=this.points.concat(e.points);return new CSG$2.Path2D(t)},appendPoint:function(e){if(this.closed)throw new Error("Path must not be closed");e=new CSG$2.Vector2D(e);var t=this.points.concat([e]);return new CSG$2.Path2D(t)},appendPoints:function(e){if(this.closed)throw new Error("Path must not be closed");var t=this.points;return e.forEach(function(e){t.push(new CSG$2.Vector2D(e))}),new CSG$2.Path2D(t)},close:function(){return new CSG$2.Path2D(this.points,!0)},rectangularExtrude:function(e,t,n){return this.expandToCAG(e/2,n).extrude({offset:[0,0,t]})},expandToCAG:function(e,t){var n=this,r=[],o=this.points.length,i=0;this.closed&&o>2&&(i=-1);for(var s,a=i;a<o;a++){var l=a;l<0&&(l=o-1);var c=n.points[l],u=new CAG$2.Vertex(c);if(a>i){var h=new CAG$2.Side(s,u);r.push(h)}s=u}return CAG$2.fromSides(r).expandedShell(e,t)},innerToCAG:function(){if(!this.closed)throw new Error("The path should be closed!");return CAG$2.fromPoints(this.points)},transform:function(e){var t=this.points.map(function(t){return t.multiply4x4(e)});return new CSG$2.Path2D(t,this.closed)},appendBezier:function(e,t){var n=this;if(arguments.length<2&&(t={}),this.closed)throw new Error("Path must not be closed");if(!(e instanceof Array))throw new Error("appendBezier: should pass an array of control points");if(e.length<1)throw new Error("appendBezier: need at least 1 control point");if(this.points.length<1)throw new Error("appendBezier: path must already contain a point (the endpoint of the path is used as the starting point for the bezier curve)");var r=CSG$2.parseOptionAsInt(t,"resolution",CSG$2.defaultResolution2D);r<4&&(r=4);var o=[],i=[];i.push(this.points[this.points.length-1]);for(var s=0;s<e.length;++s){var a=e[s];if(null===a){if(0!=s)throw new Error("appendBezier: null can only be passed as the first control point");if(e.length<2)throw new Error("appendBezier: null can only be passed if there is at least one more control point");var l;if("lastBezierControlPoint"in n)l=n.lastBezierControlPoint;else{if(n.points.length<2)throw new Error("appendBezier: null is passed as a control point but this requires a previous bezier curve or at least two points in the existing path");l=n.points[n.points.length-2]}a=n.points[n.points.length-1].times(2).minus(l)}else a=new CSG$2.Vector2D(a);i.push(a)}for(var c=i.length-1,u=1,s=0;s<=c;++s)s>0&&(u*=s),o.push(u);for(var h=[],s=0;s<=c;++s){var p=o[c]/(o[s]*o[c-s]);h.push(p)}for(var f=function(e){for(var t=1,n=Math.pow(1-e,c),r=1!=e?1/(1-e):1,o=new CSG$2.Vector2D(0,0),s=0;s<=c;++s){s==c&&(n=1);var a=h[s]*t*n;o=o.plus(i[s].times(a)),t*=e,n*=r}return o},d=[],g=[],m=c+1,s=0;s<m;++s){var v=s/(m-1),C=f(v);d.push(C),g.push(v)}for(var S=1,y=2*Math.PI/r,w=Math.sin(y);S<d.length-1;){var x=d[S].minus(d[S-1]).unit(),G=d[S+1].minus(d[S]).unit(),b=x.cross(G);if(Math.abs(b)>w){var $=g[S-1],T=g[S+1],_=$+1*(T-$)/3,D=$+2*(T-$)/3,P=f(_),A=f(D);d.splice(S,1,P,A),g.splice(S,1,_,D),S--,S<1&&(S=1)}else++S}d=this.points.concat(d.slice(1));var E=new CSG$2.Path2D(d);return E.lastBezierControlPoint=i[i.length-2],E},appendArc:function(e,t){if(arguments.length<2&&(t={}),this.closed)throw new Error("Path must not be closed");if(this.points.length<1)throw new Error("appendArc: path must already contain a point (the endpoint of the path is used as the starting point for the arc)");var n=CSG$2.parseOptionAsInt(t,"resolution",CSG$2.defaultResolution2D);n<4&&(n=4);var r,o;if("xradius"in t||"yradius"in t){if("radius"in t)throw new Error("Should either give an xradius and yradius parameter, or a radius parameter");r=CSG$2.parseOptionAsFloat(t,"xradius",0),o=CSG$2.parseOptionAsFloat(t,"yradius",0)}else r=CSG$2.parseOptionAsFloat(t,"radius",0),o=r;var i=CSG$2.parseOptionAsFloat(t,"xaxisrotation",0),s=CSG$2.parseOptionAsBool(t,"clockwise",!1),a=CSG$2.parseOptionAsBool(t,"large",!1),l=this.points[this.points.length-1];e=new CSG$2.Vector2D(e),r=Math.round(1e5*r)/1e5,o=Math.round(1e5*o)/1e5,e=new CSG$2.Vector2D(Math.round(1e5*e.x)/1e5,Math.round(1e5*e.y)/1e5);var c=!s,u=[];if(0==r||0==o)u.push(e);else{r=Math.abs(r),o=Math.abs(o);var h=i*Math.PI/180,p=Math.cos(h),f=Math.sin(h),d=l.minus(e).times(.5),g=Math.round(1e5*(p*d.x+f*d.y))/1e5,m=Math.round(1e5*(-f*d.x+p*d.y))/1e5,v=new CSG$2.Vector2D(g,m),C=v.x*v.x/(r*r)+v.y*v.y/(o*o);if(C>1){var S=Math.sqrt(C);r*=S,o*=S,r=Math.round(1e5*r)/1e5,o=Math.round(1e5*o)/1e5}var y=Math.sqrt((r*r*o*o-r*r*v.y*v.y-o*o*v.x*v.x)/(r*r*v.y*v.y+o*o*v.x*v.x));c==a&&(y=-y);var w=new CSG$2.Vector2D(r*v.y/o,-o*v.x/r).times(y),x=new CSG$2.Vector2D(p*w.x-f*w.y,f*w.x+p*w.y).plus(l.plus(e).times(.5)),G=new CSG$2.Vector2D((v.x-w.x)/r,(v.y-w.y)/o),b=new CSG$2.Vector2D((-v.x-w.x)/r,(-v.y-w.y)/o),$=G.angleRadians(),T=b.angleRadians(),_=T-$;_%=2*Math.PI,!c&&_>0?_-=2*Math.PI:c&&_<0&&(_+=2*Math.PI);var D=Math.ceil(Math.abs(_)/(2*Math.PI)*n)+1;D<1&&(D=1);for(var P=1;P<=D;P++){var A=$+P/D*_,E=Math.cos(A),N=Math.sin(A),I=new CSG$2.Vector2D(p*r*E-f*o*N,f*r*E+p*o*N).plus(x);u.push(I)}}return u=this.points.concat(u),new CSG$2.Path2D(u)}},CSG$2.addTransformationMethodsToPrototype=function(e){e.mirrored=function(e){return this.transform(CSG$2.Matrix4x4.mirroring(e))},e.mirroredX=function(){var e=new CSG$2.Plane(CSG$2.Vector3D.Create(1,0,0),0);return this.mirrored(e)},e.mirroredY=function(){var e=new CSG$2.Plane(CSG$2.Vector3D.Create(0,1,0),0);return this.mirrored(e)},e.mirroredZ=function(){var e=new CSG$2.Plane(CSG$2.Vector3D.Create(0,0,1),0);return this.mirrored(e)},e.translate=function(e){return this.transform(CSG$2.Matrix4x4.translation(e))},e.scale=function(e){return this.transform(CSG$2.Matrix4x4.scaling(e))},e.rotateX=function(e){return this.transform(CSG$2.Matrix4x4.rotationX(e))},e.rotateY=function(e){return this.transform(CSG$2.Matrix4x4.rotationY(e))},e.rotateZ=function(e){return this.transform(CSG$2.Matrix4x4.rotationZ(e))},e.rotate=function(e,t,n){return this.transform(CSG$2.Matrix4x4.rotation(e,t,n))},e.rotateEulerAngles=function(e,t,n,r){r=r||[0,0,0];var o=CSG$2.Matrix4x4.rotationZ(e),i=CSG$2.Matrix4x4.rotationX(t),s=CSG$2.Matrix4x4.rotationZ(n),a=CSG$2.Matrix4x4.translation(new CSG$2.Vector3D(r));return this.transform(s.multiply(i).multiply(o).multiply(a))}},CSG$2.addCenteringToPrototype=function(e,t){e.center=function(e){e=Array.prototype.map.call(arguments,function(e){return e}),e.length||(e=t.slice());var n=this.getBounds();return this.translate(t.map(function(t){return e.indexOf(t)>-1?-(n[0][t]+n[1][t])/2:0}))}};var CAG$2=function(){this.sides=[],this.isCanonicalized=!1};CAG$2.fromObject=function(e){var t=e.sides.map(function(e){return CAG$2.Side.fromObject(e)});return CAG$2.fromSides(t)},CAG$2.fromSides=function(e){var t=new CAG$2;return t.sides=e,t},CAG$2.fromPoints=function(e){var t=e.length;if(t<3)throw new Error("CAG shape needs at least 3 points");var n=[],r=new CSG$2.Vector2D(e[t-1]),o=new CAG$2.Vertex(r);e.map(function(e){var t=new CSG$2.Vector2D(e),r=new CAG$2.Vertex(t),i=new CAG$2.Side(o,r);n.push(i),o=r});var i=CAG$2.fromSides(n);if(i.isSelfIntersecting())throw new Error("Polygon is self intersecting!");var s=i.area();if(Math.abs(s)<1e-5)throw new Error("Degenerate polygon!");return s<0&&(i=i.flipped()),i=i.canonicalized()},CAG$2.fromPointsNoCheck=function(e){var t=[],n=new CSG$2.Vector2D(e[e.length-1]),r=new CAG$2.Vertex(n);return e.map(function(e){var n=new CSG$2.Vector2D(e),o=new CAG$2.Vertex(n),i=new CAG$2.Side(r,o);t.push(i),r=o}),CAG$2.fromSides(t)},CAG$2.fromFakeCSG=function(e){var t=e.polygons.map(function(e){return CAG$2.Side._fromFakePolygon(e)}).filter(function(e){return null!==e});return CAG$2.fromSides(t)},CAG$2.linesIntersect=function(e,t,n,r){if(t.equals(n)||r.equals(e)){if(r.minus(n).unit().plus(t.minus(e).unit()).length()<1e-5)return!0}else{var o=t.minus(e),i=r.minus(n);if(Math.abs(o.cross(i))<1e-9)return!1;var s=CSG$2.solve2Linear(-o.x,i.x,-o.y,i.y,e.x-n.x,e.y-n.y);if(s[0]>1e-6&&s[0]<.999999&&s[1]>1e-5&&s[1]<.999999)return!0}return!1},CAG$2.circle=function(e){e=e||{}
;for(var t,n=CSG$2.parseOptionAs2DVector(e,"center",[0,0]),r=CSG$2.parseOptionAsFloat(e,"radius",1),o=CSG$2.parseOptionAsInt(e,"resolution",CSG$2.defaultResolution2D),i=[],s=0;s<=o;s++){var a=2*Math.PI*s/o,l=CSG$2.Vector2D.fromAngleRadians(a).times(r).plus(n),c=new CAG$2.Vertex(l);s>0&&i.push(new CAG$2.Side(t,c)),t=c}return CAG$2.fromSides(i)},CAG$2.ellipse=function(e){e=e||{};var t=CSG$2.parseOptionAs2DVector(e,"center",[0,0]),n=CSG$2.parseOptionAs2DVector(e,"radius",[1,1]);n=n.abs();var r=CSG$2.parseOptionAsInt(e,"resolution",CSG$2.defaultResolution2D),o=new CSG$2.Path2D([[t.x,t.y+n.y]]);return o=o.appendArc([t.x,t.y-n.y],{xradius:n.x,yradius:n.y,xaxisrotation:0,resolution:r,clockwise:!0,large:!1}),o=o.appendArc([t.x,t.y+n.y],{xradius:n.x,yradius:n.y,xaxisrotation:0,resolution:r,clockwise:!0,large:!1}),o=o.close(),o.innerToCAG()},CAG$2.rectangle=function(e){e=e||{};var t,n;if("corner1"in e||"corner2"in e){if("center"in e||"radius"in e)throw new Error("rectangle: should either give a radius and center parameter, or a corner1 and corner2 parameter");corner1=CSG$2.parseOptionAs2DVector(e,"corner1",[0,0]),corner2=CSG$2.parseOptionAs2DVector(e,"corner2",[1,1]),t=corner1.plus(corner2).times(.5),n=corner2.minus(corner1).times(.5)}else t=CSG$2.parseOptionAs2DVector(e,"center",[0,0]),n=CSG$2.parseOptionAs2DVector(e,"radius",[1,1]);n=n.abs();var r=new CSG$2.Vector2D(n.x,-n.y),o=[t.plus(n),t.plus(r),t.minus(n),t.minus(r)];return CAG$2.fromPoints(o)},CAG$2.roundedRectangle=function(e){e=e||{};var t,n;if("corner1"in e||"corner2"in e){if("center"in e||"radius"in e)throw new Error("roundedRectangle: should either give a radius and center parameter, or a corner1 and corner2 parameter");corner1=CSG$2.parseOptionAs2DVector(e,"corner1",[0,0]),corner2=CSG$2.parseOptionAs2DVector(e,"corner2",[1,1]),t=corner1.plus(corner2).times(.5),n=corner2.minus(corner1).times(.5)}else t=CSG$2.parseOptionAs2DVector(e,"center",[0,0]),n=CSG$2.parseOptionAs2DVector(e,"radius",[1,1]);n=n.abs();var r=CSG$2.parseOptionAsFloat(e,"roundradius",.2),o=CSG$2.parseOptionAsInt(e,"resolution",CSG$2.defaultResolution2D),i=Math.min(n.x,n.y);i-=.1,r=Math.min(r,i),r=Math.max(0,r),n=new CSG$2.Vector2D(n.x-r,n.y-r);var s=CAG$2.rectangle({center:t,radius:n});return r>0&&(s=s.expand(r,o)),s},CAG$2.fromCompactBinary=function(e){if("CAG"!=e.class)throw new Error("Not a CAG");for(var t=[],n=e.vertexData,r=n.length/2,o=0,i=0;i<r;i++){var s=n[o++],a=n[o++],l=new CSG$2.Vector2D(s,a),c=new CAG$2.Vertex(l);t.push(c)}var u=[],h=e.sideVertexIndices.length/2;o=0;for(var p=0;p<h;p++){var f=e.sideVertexIndices[o++],d=e.sideVertexIndices[o++],g=new CAG$2.Side(t[f],t[d]);u.push(g)}var m=CAG$2.fromSides(u);return m.isCanonicalized=!0,m},CAG$2.prototype={toString:function(){var e="CAG ("+this.sides.length+" sides):\n";return this.sides.map(function(t){e+="  "+t.toString()+"\n"}),e},_toCSGWall:function(e,t){var n=this.sides.map(function(n){return n.toPolygon3D(e,t)});return CSG$2.fromPolygons(n)},_toVector3DPairs:function(e){var t=this.sides.map(function(e){var t=e.vertex0.pos,n=e.vertex1.pos;return[CSG$2.Vector3D.Create(t.x,t.y,0),CSG$2.Vector3D.Create(n.x,n.y,0)]});return void 0!==e&&(t=t.map(function(t){return t.map(function(t){return t.transform(e)})})),t},_toPlanePolygons:function(e){var t=e.flipped||!1,n=[0,0,0],r=[0,0,1],o=[0,1,0],i=new CSG$2.Connector(n,r,o),s=e.translation||n,a=e.axisVector||r,l=e.normalVector||o,c=e.toConnector||new CSG$2.Connector(s,a,l),u=i.getTransformationTo(c,!1,0),h=this.getBounds();h[0]=h[0].minus(new CSG$2.Vector2D(1,1)),h[1]=h[1].plus(new CSG$2.Vector2D(1,1));var p=this._toCSGWall(-1,1),f=CSG$2.fromPolygons([new CSG$2.Polygon([new CSG$2.Vertex(new CSG$2.Vector3D(h[0].x,h[0].y,0)),new CSG$2.Vertex(new CSG$2.Vector3D(h[1].x,h[0].y,0)),new CSG$2.Vertex(new CSG$2.Vector3D(h[1].x,h[1].y,0)),new CSG$2.Vertex(new CSG$2.Vector3D(h[0].x,h[1].y,0))])]);return t&&(f=f.invert()),f=f.intersectSub(p),f.polygons.filter(function(e){return Math.abs(e.plane.normal.z)>.99}).map(function(e){return e.transform(u)})},_toWallPolygons:function(e){var t=[0,0,0],n=[0,0,1],r=[0,1,0],o=new CSG$2.Connector(t,n,r),i=e.toConnector1,s=e.toConnector2;if(!(i instanceof CSG$2.Connector&&s instanceof CSG$2.Connector))throw"could not parse CSG.Connector arguments toConnector1 or toConnector2";if(e.cag&&e.cag.sides.length!=this.sides.length)throw"target cag needs same sides count as start cag";var a=e.cag||this,l=o.getTransformationTo(i,!1,0),c=o.getTransformationTo(s,!1,0),u=this._toVector3DPairs(l),h=a._toVector3DPairs(c),p=[];return u.forEach(function(e,t){p.push(new CSG$2.Polygon([new CSG$2.Vertex(h[t][1]),new CSG$2.Vertex(h[t][0]),new CSG$2.Vertex(e[0])])),p.push(new CSG$2.Polygon([new CSG$2.Vertex(h[t][1]),new CSG$2.Vertex(e[0]),new CSG$2.Vertex(e[1])]))}),p},union:function(e){var t;t=e instanceof Array?e:[e];var n=this._toCSGWall(-1,1),n=n.union(t.map(function(e){return e._toCSGWall(-1,1).reTesselated()}),!1,!1);return CAG$2.fromFakeCSG(n).canonicalized()},subtract:function(e){var t;t=e instanceof Array?e:[e];var n=this._toCSGWall(-1,1);return t.map(function(e){n=n.subtractSub(e._toCSGWall(-1,1),!1,!1)}),n=n.reTesselated(),n=n.canonicalized(),n=CAG$2.fromFakeCSG(n),n=n.canonicalized()},intersect:function(e){var t;t=e instanceof Array?e:[e];var n=this._toCSGWall(-1,1);return t.map(function(e){n=n.intersectSub(e._toCSGWall(-1,1),!1,!1)}),n=n.reTesselated(),n=n.canonicalized(),n=CAG$2.fromFakeCSG(n),n=n.canonicalized()},transform:function(e){var t=e.isMirroring(),n=this.sides.map(function(t){return t.transform(e)}),r=CAG$2.fromSides(n);return t&&(r=r.flipped()),r},area:function(){var e=0;return this.sides.map(function(t){e+=t.vertex0.pos.cross(t.vertex1.pos)}),e*=.5},flipped:function(){var e=this.sides.map(function(e){return e.flipped()});return e.reverse(),CAG$2.fromSides(e)},getBounds:function(){var e;e=0===this.sides.length?new CSG$2.Vector2D(0,0):this.sides[0].vertex0.pos;var t=e;return this.sides.map(function(n){e=e.min(n.vertex0.pos),e=e.min(n.vertex1.pos),t=t.max(n.vertex0.pos),t=t.max(n.vertex1.pos)}),[e,t]},isSelfIntersecting:function(e){for(var t=this,n=this.sides.length,r=0;r<n;r++)for(var o=t.sides[r],i=r+1;i<n;i++){var s=t.sides[i];if(CAG$2.linesIntersect(o.vertex0.pos,o.vertex1.pos,s.vertex0.pos,s.vertex1.pos))return e&&(OpenJsCad.log(o),OpenJsCad.log(s)),!0}return!1},expandedShell:function(e,t){(t=t||8)<4&&(t=4);var n=[],r={};this.canonicalized().sides.map(function(t){var o=t.vertex1.pos.minus(t.vertex0.pos),i=o.length();if(i>1e-5){o=o.times(1/i);var s=o.normal().times(e),a=[t.vertex1.pos.plus(s),t.vertex1.pos.minus(s),t.vertex0.pos.minus(s),t.vertex0.pos.plus(s)],l=CAG$2.fromPoints(a);n.push(l);for(var c=0;c<2;c++){var u=0===c?t.vertex0.pos:t.vertex1.pos,h=0===c?t.vertex1.pos:t.vertex0.pos,p=u.x+" "+u.y;p in r||(r[p]=[]),r[p].push({p1:u,p2:h})}}});for(var o in r){var i,s,a=r[o],l=a[0].p1;if(2==a.length){var c=a[0].p2,u=a[1].p2;if(i=c.minus(l).angleDegrees(),s=u.minus(l).angleDegrees(),s<i&&(s+=360),s>=i+360&&(s-=360),s<i+180){var h=s;s=i+360,i=h}i+=90,s-=90}else i=0,s=360;var p=s>i+359.999;if(p&&(i=0,s=360),s>i+1e-5){var f=[];p||f.push(l);var d=Math.round(t*(s-i)/360);d<1&&(d=1);for(var g=0;g<=d;g++){var m=i+g/d*(s-i);g==d&&(m=s);var v=l.plus(CSG$2.Vector2D.fromAngleDegrees(m).times(e));(!p||g>0)&&f.push(v)}var C=CAG$2.fromPointsNoCheck(f);n.push(C)}}var S=new CAG$2;return S=S.union(n)},expand:function(e,t){return this.union(this.expandedShell(e,t))},contract:function(e,t){return this.subtract(this.expandedShell(e,t))},extrudeInOrthonormalBasis:function(e,t){if(!(e instanceof CSG$2.OrthoNormalBasis))throw new Error("extrudeInPlane: the first parameter should be a CSG.OrthoNormalBasis");var n=this.extrude({offset:[0,0,t]}),r=e.getInverseProjectionMatrix();return n=n.transform(r)},extrudeInPlane:function(e,t,n){return this.extrudeInOrthonormalBasis(CSG$2.OrthoNormalBasis.GetCartesian(e,t),n)},extrude:function(e){var t=this;if(0==this.sides.length)return new CSG$2;var n=CSG$2.parseOptionAs3DVector(e,"offset",[0,0,1]),r=CSG$2.parseOptionAsFloat(e,"twistangle",0),o=CSG$2.parseOptionAsInt(e,"twiststeps",CSG$2.defaultResolution3D);if(0==n.z)throw"offset cannot be orthogonal to Z axis";(0==r||o<1)&&(o=1);var i=CSG$2.Vector3D.Create(0,1,0),s=[];s=s.concat(this._toPlanePolygons({translation:[0,0,0],normalVector:i,flipped:!(n.z<0)})),s=s.concat(this._toPlanePolygons({translation:n,normalVector:i.rotateZ(r),flipped:n.z<0}));for(var a=0;a<o;a++){var l=new CSG$2.Connector(n.times(a/o),[0,0,n.z],i.rotateZ(a*r/o)),c=new CSG$2.Connector(n.times((a+1)/o),[0,0,n.z],i.rotateZ((a+1)*r/o));s=s.concat(t._toWallPolygons({toConnector1:l,toConnector2:c}))}return CSG$2.fromPolygons(s)},rotateExtrude:function(e){var t=this,n=CSG$2.parseOptionAsFloat(e,"angle",360),r=CSG$2.parseOptionAsInt(e,"resolution",CSG$2.defaultResolution3D);n=n>360?n%360:n;var o=[0,0,0],i=CSG$2.Vector3D.Create(0,1,0),s=[0,0,1],a=[],l=new CSG$2.Connector(o,i,s);if(n>0&&n<360){var c=new CSG$2.Connector(o,i.rotateZ(-n),s);a=a.concat(this._toPlanePolygons({toConnector:l,flipped:!0})),a=a.concat(this._toPlanePolygons({toConnector:c}))}for(var u,h=l,p=n/r,f=p;f<=n+1e-5;f+=p)u=new CSG$2.Connector(o,i.rotateZ(-f),s),a=a.concat(t._toWallPolygons({toConnector1:h,toConnector2:u})),h=u;return CSG$2.fromPolygons(a).reTesselated()},check:function(){var e=[];this.isSelfIntersecting(!0)&&e.push("Self intersects");var t={};this.sides.map(function(e){function n(e){var n=e.x+" "+e.y;n in t||(t[n]=0),t[n]++}n(e.vertex0.pos),n(e.vertex1.pos)});for(var n in t){var r=t[n];1&r&&e.push("Uneven number of sides ("+r+") for point "+n)}var o=this.area();if(o<1e-5*1e-5&&e.push("Area is "+o),e.length>0){var i="";throw e.map(function(e){i+=e+"\n"}),new Error(i)}},canonicalized:function(){if(this.isCanonicalized)return this;var e=new CAG$2.fuzzyCAGFactory,t=e.getCAG(this);return t.isCanonicalized=!0,t},toCompactBinary:function(){var e=this.canonicalized(),t=e.sides.length,n={},r=[],o=0,i=new Uint32Array(2*t),s=0;e.sides.map(function(e){[e.vertex0,e.vertex1].map(function(e){var t,a=e.getTag();a in n?t=n[a]:(t=o++,n[a]=t,r.push(e)),i[s++]=t})});var a=new Float64Array(2*o),l=0;return r.map(function(e){var t=e.pos;a[l++]=t._x,a[l++]=t._y}),{class:"CAG",sideVertexIndices:i,vertexData:a}},getOutlinePaths:function(){var e=this.canonicalized(),t={},n={};e.sides.map(function(e){var r=e.getTag();t[r]=e;var o=e.vertex0.getTag();o in n||(n[o]=[]),n[o].push(r)});for(var r=[];;){var o=null;for(var i in n){var s=n[i];o=s[0],s.splice(0,1),0===s.length&&delete n[i];break}if(null===o)break;for(var a=[],l=o,c=t[l],u=c.vertex0.getTag();;){a.push(c.vertex0.pos);var h=c.vertex1.getTag();if(h==u)break;if(!(h in n))throw new Error("Area is not closed!");var p=n[h],f=-1;if(1==p.length)f=0;else for(var d=null,g=c.direction().angleDegrees(),m=0;m<p.length;m++){var v=p[m],C=t[v],S=C.direction().angleDegrees(),y=S-g;y<-180&&(y+=360),y>=180&&(y-=360),(f<0||y>d)&&(f=m,d=y)}var w=p[f];p.splice(f,1),0===p.length&&delete n[h],c=t[w]}var x=new CSG$2.Path2D(a,!0);r.push(x)}return r},overCutInsideCorners:function(e){var t=this.canonicalized(),n={};t.sides.map(function(e){e.vertex0.getTag()in n||(n[e.vertex0.getTag()]={pos:e.vertex0.pos,from:[],to:[]}),n[e.vertex0.getTag()].to.push(e.vertex1.pos),e.vertex1.getTag()in n||(n[e.vertex1.getTag()]={pos:e.vertex1.pos,from:[],to:[]}),n[e.vertex1.getTag()].from.push(e.vertex0.pos)});var r=[];for(var o in n){var i=n[o];if(1==i.from.length&&1==i.to.length){var s=i.from[0],a=i.pos,l=i.to[0],c=a.minus(s).unit(),u=l.minus(a).unit();if(c.cross(u)<.001){var h=u.angleRadians()-c.angleRadians()+Math.PI;h<0?h+=2*Math.PI:h>=2*Math.PI&&(h-=2*Math.PI);for(var p=u.minus(c).unit(),f=30/180*Math.PI,d=e/Math.cos(f/2),g=a.plus(p.times(d)),m=h+p.angleRadians(),v=2*(Math.PI-h),C=2*Math.ceil(v/f/2),S=[g],y=0;y<=C;y++){var w=m+y/C*v,x=CSG$2.Vector2D.fromAngleRadians(w).times(d).plus(g);S.push(x)}r.push(CAG$2.fromPoints(S))}}}return t.subtract(r)}},CAG$2.Vertex=function(e){this.pos=e},CAG$2.Vertex.fromObject=function(e){return new CAG$2.Vertex(new CSG$2.Vector2D(e.pos._x,e.pos._y))},CAG$2.Vertex.prototype={toString:function(){return"("+this.pos.x.toFixed(2)+","+this.pos.y.toFixed(2)+")"},getTag:function(){var e=this.tag;return e||(e=CSG$2.getTag(),this.tag=e),e}},CAG$2.Side=function(e,t){if(!(e instanceof CAG$2.Vertex))throw new Error("Assertion failed");if(!(t instanceof CAG$2.Vertex))throw new Error("Assertion failed");this.vertex0=e,this.vertex1=t},CAG$2.Side.fromObject=function(e){var t=CAG$2.Vertex.fromObject(e.vertex0),n=CAG$2.Vertex.fromObject(e.vertex1);return new CAG$2.Side(t,n)},CAG$2.Side._fromFakePolygon=function(e){if(e.vertices.forEach(function(e){if(!(e.pos.z>=-1.001&&e.pos.z<-.999||e.pos.z>=.999&&e.pos.z<1.001))throw"Assertion failed: _fromFakePolygon expects abs z values of 1"}),e.vertices.length<4)return null;var t=[],n=e.vertices.filter(function(e,n){if(e.pos.z>0)return t.push(n),!0}).map(function(e){return new CSG$2.Vector2D(e.pos.x,e.pos.y)});if(2!=n.length)throw"Assertion failed: _fromFakePolygon: not enough points found";var r=t[1]-t[0];if(1!=r&&3!=r)throw"Assertion failed: _fromFakePolygon: unknown index ordering";return 1==r&&n.reverse(),new CAG$2.Side(new CAG$2.Vertex(n[0]),new CAG$2.Vertex(n[1]))},CAG$2.Side.prototype={toString:function(){return this.vertex0+" -> "+this.vertex1},toPolygon3D:function(e,t){var n=[new CSG$2.Vertex(this.vertex0.pos.toVector3D(e)),new CSG$2.Vertex(this.vertex1.pos.toVector3D(e)),new CSG$2.Vertex(this.vertex1.pos.toVector3D(t)),new CSG$2.Vertex(this.vertex0.pos.toVector3D(t))];return new CSG$2.Polygon(n)},transform:function(e){var t=this.vertex0.pos.transform(e),n=this.vertex1.pos.transform(e);return new CAG$2.Side(new CAG$2.Vertex(t),new CAG$2.Vertex(n))},flipped:function(){return new CAG$2.Side(this.vertex1,this.vertex0)},direction:function(){return this.vertex1.pos.minus(this.vertex0.pos)},getTag:function(){var e=this.tag;return e||(e=CSG$2.getTag(),this.tag=e),e},lengthSquared:function(){var e=this.vertex1.pos.x-this.vertex0.pos.x,t=this.vertex1.pos.y-this.vertex0.pos.y;return e*e+t*t},length:function(){return Math.sqrt(this.lengthSquared())}},CAG$2.fuzzyCAGFactory=function(){this.vertexfactory=new CSG$2.fuzzyFactory(2,1e-5)},CAG$2.fuzzyCAGFactory.prototype={getVertex:function(e){var t=[e.pos._x,e.pos._y];return this.vertexfactory.lookupOrCreate(t,function(t){return e})},getSide:function(e){var t=this.getVertex(e.vertex0),n=this.getVertex(e.vertex1);return new CAG$2.Side(t,n)},getCAG:function(e){var t=this,n=e.sides.map(function(e){return t.getSide(e)}).filter(function(e){return e.length()>1e-5});return CAG$2.fromSides(n)}},CSG$2.addTransformationMethodsToPrototype(CSG$2.prototype),CSG$2.addTransformationMethodsToPrototype(CSG$2.Vector2D.prototype),CSG$2.addTransformationMethodsToPrototype(CSG$2.Vector3D.prototype),CSG$2.addTransformationMethodsToPrototype(CSG$2.Vertex.prototype),CSG$2.addTransformationMethodsToPrototype(CSG$2.Plane.prototype),CSG$2.addTransformationMethodsToPrototype(CSG$2.Polygon.prototype),CSG$2.addTransformationMethodsToPrototype(CSG$2.Line3D.prototype),CSG$2.addTransformationMethodsToPrototype(CSG$2.Connector.prototype),CSG$2.addTransformationMethodsToPrototype(CSG$2.Path2D.prototype),CSG$2.addTransformationMethodsToPrototype(CSG$2.Line2D.prototype),CSG$2.addTransformationMethodsToPrototype(CAG$2.prototype),CSG$2.addTransformationMethodsToPrototype(CAG$2.Side.prototype),CSG$2.addTransformationMethodsToPrototype(CSG$2.OrthoNormalBasis.prototype),CSG$2.addCenteringToPrototype(CSG$2.prototype,["x","y","z"]),CSG$2.addCenteringToPrototype(CAG$2.prototype,["x","y"]),CSG$2.Polygon2D=function(e){var t=CAG$2.fromPoints(e);this.sides=t.sides},CSG$2.Polygon2D.prototype=CAG$2.prototype;var csg={CSG:CSG$2,CAG:CAG$2},csg_1=csg.CSG,csg_2=csg.CAG,csg$2=Object.freeze({default:csg,__moduleExports:csg,CSG:csg_1,CAG:csg_2}),require$$0$1=csg$2&&csg$2.default||csg$2,index$1=createCommonjsModule(function(e,t){function n(e,t){return"undefined"!=typeof window?window.Blob:r}function r(e,t){var n=this;if(t=t||{},this.size=0,this.type="",this.isClosed=!1,this.encoding="utf8",this.buffer=null,this.length=32e6,e&&Array.isArray(e)){t.type&&(this.type=t.type.toLowerCase()),t.endings,t.encoding&&(this.encoding=t.encoding.toLowerCase()),t.length&&(this.length=t.length);var r,o;this.buffer=new Buffer(this.length);var i=0;for(i=0;i<e.length;i++)switch(typeof e[i]){case"string":r=n.buffer.write(e[i],n.size,n.encoding),n.size=n.size+r;break;case"object":if(o=e[i],Buffer.isBuffer(o),o instanceof ArrayBuffer){var s=new DataView(o),a=0;for(a=0;a<o.byteLength;a++){var l=s.getUint8(a);r=n.buffer.writeUInt8(l,n.size,!1),n.size++}}}return this}}function o(e){if(window.URL)window.URL.revokeObjectURL(e);else{if(!window.webkitURL)throw new Error("Your browser doesn't support window.URL");window.webkitURL.revokeObjectURL(e)}}function i(e){return s(e.getOutlinePaths())}function s(e){var t="999\nDXF generated by OpenJsCad\n";return t+="  0\nSECTION\n  2\nHEADER\n",t+="  0\nENDSEC\n",t+="  0\nSECTION\n  2\nTABLES\n",t+="  0\nTABLE\n  2\nLTYPE\n  70\n1\n",t+="  0\nLTYPE\n  2\nCONTINUOUS\n  3\nSolid Line\n  72\n65\n  73\n0\n  40\n0.0\n",t+="  0\nENDTAB\n",t+="  0\nTABLE\n  2\nLAYER\n  70\n1\n",t+="  0\nLAYER\n  2\nOpenJsCad\n  62\n7\n  6\ncontinuous\n",t+="  0\nENDTAB\n",t+="  0\nTABLE\n  2\nSTYLE\n  70\n0\n  0\nENDTAB\n",t+="  0\nTABLE\n  2\nVIEW\n  70\n0\n  0\nENDTAB\n",t+="  0\nENDSEC\n",t+="  0\nSECTION\n  2\nBLOCKS\n",t+="  0\nENDSEC\n",t+="  0\nSECTION\n  2\nENTITIES\n",e.map(function(e){var n=e.points.length+(e.closed?1:0);t+="  0\nLWPOLYLINE\n  8\nOpenJsCad\n  90\n"+n+"\n  70\n"+(e.closed?1:0)+"\n";for(var r=0;r<n;r++){var o=r;o>=e.points.length&&(o-=e.points.length);var i=e.points[o];t+=" 10\n"+i.x+"\n 20\n"+i.y+"\n 30\n0.0\n"}}),t+="  0\nENDSEC\n  0\nEOF\n",new pt([t],{type:"application/dxf"})}function a(e){var t='{ "type": "cag","sides": [',n="";return e.sides.map(function(e){t+=n,t+=JSON.stringify(e),n=","}),t+="] }",new ft([t],{type:"application/json"})}function l(e){var t=new ht.CSG.Plane(ht.CSG.Vector3D.Create(0,1,0),0),n=e.transform(ht.CSG.Matrix4x4.mirroring(t)),r=n.getBounds(),o=n.getOutlinePaths(),i=Math.round(1e3*(r[1].x-r[0].x))/1e3,s=Math.round(1e3*(r[1].y-r[0].y))/1e3,a='<?xml version="1.0" encoding="UTF-8"?>\n';return a+="\x3c!-- Generated by OpenJSCAD.org --\x3e\n",a+='<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1 Tiny//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11-tiny.dtd">\n',a+='<svg width="'+i+'mm" height="'+s+'mm" viewBox="0 0 '+i+" "+s+'" version="1.1" baseProfile="tiny" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n',a+=c(o,r),a+="</svg>",new dt([a],{type:"image/svg+xml"})}function c(e,t){var n=0-t[0].x,r=0-t[0].y,o="<g>\n";return e.map(function(e){o+='<path d="';for(var t=e.points.length+(e.closed?1:0),i=0;i<t;i++){var s=i;s>=e.points.length&&(s-=e.points.length);var a=e.points[s];o+=i>0?"L"+(a.x+n)+" "+(a.y+r):"M"+(a.x+n)+" "+(a.y+r)}o+='"/>\n'}),o+="</g>\n"}function u(e,t){var n='<?xml version="1.0" encoding="UTF-8"?>\n<amf'+(t&&t.unit?' unit="+m.unit"':"")+">\n";for(var r in t)n+='<metadata type="'+r+'">'+t[r]+"</metadata>\n";n+='<object id="0">\n<mesh>\n<vertices>\n',e.polygons.map(function(e){for(var t=0;t<e.vertices.length;t++)n+=p(e.vertices[t])}),n+="</vertices>\n";var o=0;return e.polygons.map(function(e){if(n+="<volume>\n",!(e.vertices.length<3)){var t=null;e.shared&&e.shared.color?t=e.shared.color:e.color&&(t=e.color),null!=t&&(t.length<4&&t.push(1),n+="<color><r>"+t[0]+"</r><g>"+t[1]+"</g><b>"+t[2]+"</b><a>"+t[3]+"</a></color>");for(var r=0;r<e.vertices.length-2;r++)n+="<triangle>",n+="<v1>"+o+"</v1>",n+="<v2>"+(o+r+1)+"</v2>",n+="<v3>"+(o+r+2)+"</v3>",n+="</triangle>\n";o+=e.vertices.length,n+="</volume>\n"}}),n+="</mesh>\n</object>\n",n+="</amf>\n",new gt([n],{type:"application/amf+xml"})}function h(e){return"<x>"+e._x+"</x><y>"+e._y+"</y><z>"+e._z+"</z>"}function p(e){return"<vertex><coordinates>"+h(e.pos)+"</coordinates></vertex>\n"}function f(){var e='{ "type": "csg","polygons": [',t="";return CSG.polygons.map(function(n){e+=t,e+=JSON.stringify(n),t=","}),e+="],",e+='"isCanonicalized": '+JSON.stringify(this.isCanonicalized)+",",e+='"isRetesselated": '+JSON.stringify(this.isRetesselated),e+="}",new mt([e],{type:"application/json"})}function d(e){var t="solid csg.js\n";return e.polygons.map(function(e){t+=v(e)}),t+="endsolid csg.js\n",new vt([t],{type:"application/sla"})}function g(e){return e._x+" "+e._y+" "+e._z}function m(e){return"vertex "+g(e.pos)+"\n"}function v(e){var t="";if(e.vertices.length>=3)for(var n=m(e.vertices[0]),r=0;r<e.vertices.length-2;r++)t+="facet normal "+g(e.plane.normal)+"\nouter loop\n",t+=n,t+=m(e.vertices[r+1]),t+=m(e.vertices[r+2]),t+="endloop\nendfacet\n";return t}function C(e){var t=new ArrayBuffer(4),n=new Int32Array(t,0,1),r=new Int8Array(t,0,4);if(n[0]=287454020,68!=r[0])throw new Error("Binary STL output is currently only supported on little-endian (Intel) processors");var o=0;e.polygons.map(function(e){var t=e.vertices.length;o+=t>=3?t-2:0});for(var i=new Uint8Array(80),s=0;s<80;s++)i[s]=65;var a=new Uint32Array(1);a[0]=o;var l=new ArrayBuffer(50*o),c=new Int8Array(l),u=new ArrayBuffer(50),h=new Int8Array(u),p=new Float32Array(u,0,12),f=new Uint16Array(u,48,1),d=0;return e.polygons.map(function(e){for(var t=e.vertices.length,n=0;n<t-2;n++){var r=e.plane.normal;p[0]=r._x,p[1]=r._y,p[2]=r._z;for(var o=3,i=0;i<3;i++){var s=i+(i>0?n:0),a=e.vertices[s].pos;p[o++]=a._x,p[o++]=a._y,p[o++]=a._z}f[0]=0,c.set(h,d),d+=50}}),new Ct([i.buffer,a.buffer,l],{type:"application/sla"})}function S(){}function y(e,t,n,r,o){function i(e){if(e>65535){e-=65536;var t=55296+(e>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}function s(e){var t=e.slice(1,-1);return t in n?n[t]:"#"===t.charAt(0)?i(parseInt(t.substr(1).replace("x","0x"))):(o.error("entity not found:"+e),e)}function a(t){if(t>g){var n=e.substring(g,t).replace(/&#?\w+;/g,s);p&&l(g),r.characters(n,0,t-g),g=t}}function l(t,n){for(;t>=u&&(n=h.exec(e));)c=n.index,u=c+n[0].length,p.lineNumber++;p.columnNumber=t-c+1}for(var c=0,u=0,h=/.*(?:\r\n?|\n)|.*$/g,p=r.locator,f=[{currentNSMap:t}],d={},g=0;;){try{var m=e.indexOf("<",g);if(m<0){if(!e.substr(g).match(/^\s*$/)){var v=r.doc,C=v.createTextNode(e.substr(g));v.appendChild(C),r.currentElement=C}return}switch(m>g&&a(m),e.charAt(m+1)){case"/":var S=e.indexOf(">",m+3),y=e.substring(m+2,S),T=f.pop();S<0?(y=e.substring(m+2).replace(/[\s<].*/,""),o.error("end tag name: "+y+" is not complete:"+T.tagName),S=m+1+y.length):y.match(/\s</)&&(y=y.replace(/[\s<].*/,""),o.error("end tag name: "+y+" maybe not complete"),S=m+1+y.length);var A=T.localNSMap,E=T.tagName==y;if(E||T.tagName&&T.tagName.toLowerCase()==y.toLowerCase()){if(r.endElement(T.uri,T.localName,y),A)for(var N in A)r.endPrefixMapping(N);E||o.fatalError("end tag name: "+y+" is not match the current start tagName:"+T.tagName)}else f.push(T);S++;break;case"?":p&&l(m),S=D(e,m,r);break;case"!":p&&l(m),S=_(e,m,r,o);break;default:p&&l(m);var I=new P,O=f[f.length-1].currentNSMap,S=x(e,m,I,O,s,o),V=I.length;if(!I.closed&&$(e,S,I.tagName,d)&&(I.closed=!0,n.nbsp||o.warning("unclosed xml attribute")),p&&V){for(var M=w(p,{}),F=0;F<V;F++){var k=I[F];l(k.offset),k.locator=w(p,{})}r.locator=M,G(I,r,O)&&f.push(I),r.locator=p}else G(I,r,O)&&f.push(I);"http://www.w3.org/1999/xhtml"!==I.uri||I.closed?S++:S=b(e,S,I.tagName,s,r)}}catch(e){o.error("element parse error: "+e),S=-1}S>g?g=S:a(Math.max(m,g)+1)}}function w(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function x(e,t,n,r,o,i){for(var s,a,l=++t,c=xt;;){var u=e.charAt(l);switch(u){case"=":if(c===Gt)s=e.slice(t,l),c=$t;else{if(c!==bt)throw new Error("attribute equal must after attrName");c=$t}break;case"'":case'"':if(c===$t||c===Gt){if(c===Gt&&(i.warning('attribute value must after "="'),s=e.slice(t,l)),t=l+1,!((l=e.indexOf(u,t))>0))throw new Error("attribute value no end '"+u+"' match");a=e.slice(t,l).replace(/&#?\w+;/g,o),n.add(s,a,t-1),c=_t}else{if(c!=Tt)throw new Error('attribute value must after "="');a=e.slice(t,l).replace(/&#?\w+;/g,o),n.add(s,a,t),i.warning('attribute "'+s+'" missed start quot('+u+")!!"),t=l+1,c=_t}break;case"/":switch(c){case xt:n.setTagName(e.slice(t,l));case _t:case Dt:case Pt:c=Pt,n.closed=!0;case Tt:case Gt:case bt:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return i.error("unexpected end of input"),c==xt&&n.setTagName(e.slice(t,l)),l;case">":switch(c){case xt:n.setTagName(e.slice(t,l));case _t:case Dt:case Pt:break;case Tt:case Gt:a=e.slice(t,l),"/"===a.slice(-1)&&(n.closed=!0,a=a.slice(0,-1));case bt:c===bt&&(a=s),c==Tt?(i.warning('attribute "'+a+'" missed quot(")!!'),n.add(s,a.replace(/&#?\w+;/g,o),t)):("http://www.w3.org/1999/xhtml"===r[""]&&a.match(/^(?:disabled|checked|selected)$/i)||i.warning('attribute "'+a+'" missed value!! "'+a+'" instead!!'),n.add(a,a,t));break;case $t:throw new Error("attribute value missed!!")}return l;case"":u=" ";default:if(u<=" ")switch(c){case xt:n.setTagName(e.slice(t,l)),c=Dt;break;case Gt:s=e.slice(t,l),c=bt;break;case Tt:var a=e.slice(t,l).replace(/&#?\w+;/g,o);i.warning('attribute "'+a+'" missed quot(")!!'),n.add(s,a,t);case _t:c=Dt}else switch(c){case bt:n.tagName;"http://www.w3.org/1999/xhtml"===r[""]&&s.match(/^(?:disabled|checked|selected)$/i)||i.warning('attribute "'+s+'" missed value!! "'+s+'" instead2!!'),n.add(s,s,t),t=l,c=Gt;break;case _t:i.warning('attribute space is required"'+s+'"!!');case Dt:c=Gt,t=l;break;case $t:c=Tt,t=l;break;case Pt:throw new Error("elements closed character '/' and '>' must be connected to")}}l++}}function G(e,t,n){for(var r=e.tagName,o=null,i=e.length;i--;){var s=e[i],a=s.qName,l=s.value,c=a.indexOf(":");if(c>0)var u=s.prefix=a.slice(0,c),h=a.slice(c+1),p="xmlns"===u&&h;else h=a,u=null,p="xmlns"===a&&"";s.localName=h,!1!==p&&(null==o&&(o={},T(n,n={})),n[p]=o[p]=l,s.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(p,l))}for(var i=e.length;i--;){s=e[i];var u=s.prefix;u&&("xml"===u&&(s.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==u&&(s.uri=n[u||""]))}var c=r.indexOf(":");c>0?(u=e.prefix=r.slice(0,c),h=e.localName=r.slice(c+1)):(u=null,h=e.localName=r);var f=e.uri=n[u||""];if(t.startElement(f,h,r,e),!e.closed)return e.currentNSMap=n,e.localNSMap=o,!0;if(t.endElement(f,h,r),o)for(u in o)t.endPrefixMapping(u)}function b(e,t,n,r,o){if(/^(?:script|textarea)$/i.test(n)){var i=e.indexOf("</"+n+">",t),s=e.substring(t+1,i);if(/[&<]/.test(s))return/^script$/i.test(n)?(o.characters(s,0,s.length),i):(s=s.replace(/&#?\w+;/g,r),o.characters(s,0,s.length),i)}return t+1}function $(e,t,n,r){var o=r[n];return null==o&&(o=e.lastIndexOf("</"+n+">"),o<t&&(o=e.lastIndexOf("</"+n)),r[n]=o),o<t}function T(e,t){for(var n in e)t[n]=e[n]}function _(e,t,n,r){switch(e.charAt(t+2)){case"-":if("-"===e.charAt(t+3)){var o=e.indexOf("--\x3e",t+4);return o>t?(n.comment(e,t+4,o-t-4),o+3):(r.error("Unclosed comment"),-1)}return-1;default:if("CDATA["==e.substr(t+3,6)){var o=e.indexOf("]]>",t+9);return n.startCDATA(),n.characters(e,t+9,o-t-9),n.endCDATA(),o+3}var i=E(e,t),s=i.length;if(s>1&&/!doctype/i.test(i[0][0])){var a=i[1][0],l=s>3&&/^public$/i.test(i[2][0])&&i[3][0],c=s>4&&i[4][0],u=i[s-1];return n.startDTD(a,l&&l.replace(/^(['"])(.*?)\1$/,"$2"),c&&c.replace(/^(['"])(.*?)\1$/,"$2")),n.endDTD(),u.index+u[0].length}}return-1}function D(e,t,n){var r=e.indexOf("?>",t);if(r){var o=e.substring(t,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(o){o[0].length;return n.processingInstruction(o[1],o[2]),r+2}return-1}return-1}function P(e){}function A(e,t){return e.__proto__=t,e}function E(e,t){var n,r=[],o=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(o.lastIndex=t,o.exec(e);n=o.exec(e);)if(r.push(n),n[1])return r}function N(e,t){for(var n in e)t[n]=e[n]}function I(e,t){function n(){}var r=e.prototype;if(Object.create){var o=Object.create(t.prototype);r.__proto__=o}r instanceof t||(n.prototype=t.prototype,n=new n,N(r,n),e.prototype=r=n),r.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),r.constructor=e)}function O(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,qt[e]),this.message=qt[e],Error.captureStackTrace&&Error.captureStackTrace(this,O);return n.code=e,t&&(this.message=this.message+": "+t),n}function V(){}function M(e,t){this._node=e,this._refresh=t,F(this)}function F(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var n=e._refresh(e._node);ve(e,"length",n.length),N(n,e),e._inc=t}}function k(){}function R(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function L(e,t,n,r){if(r?t[R(t,r)]=n:t[t.length++]=n,e){n.ownerElement=e;var o=e.ownerDocument;o&&(r&&W(o,e,r),q(o,e,n))}}function j(e,t,n){var r=R(t,n);if(!(r>=0))throw O(Ht,new Error(e.tagName+"@"+n));for(var o=t.length-1;r<o;)t[r]=t[++r];if(t.length=o,e){var i=e.ownerDocument;i&&(W(i,e,n),n.ownerElement=null)}}function z(e){var t=this;if(this._features={},e)for(var n in e)t._features=e[n]}function B(){}function X(e){return"<"==e&&"&lt;"||">"==e&&"&gt;"||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function Y(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(Y(e,t))return!0}while(e=e.nextSibling)}function U(){}function q(e,t,n){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&(t._nsMap[n.prefix?n.localName:""]=n.value)}function W(e,t,n,r){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&delete t._nsMap[n.prefix?n.localName:""]}function H(e,t,n){if(e&&e._inc){e._inc++;var r=t.childNodes;if(n)r[r.length++]=n;else{for(var o=t.firstChild,i=0;o;)r[i++]=o,o=o.nextSibling;r.length=i}}}function Z(e,t){var n=t.previousSibling,r=t.nextSibling;return n?n.nextSibling=r:e.firstChild=r,r?r.previousSibling=n:e.lastChild=n,H(e.ownerDocument,e),t}function J(e,t,n){var r=t.parentNode;if(r&&r.removeChild(t),t.nodeType===Xt){var o=t.firstChild;if(null==o)return t;var i=t.lastChild}else o=i=t;var s=n?n.previousSibling:e.lastChild;o.previousSibling=s,i.nextSibling=n,s?s.nextSibling=o:e.firstChild=o,null==n?e.lastChild=i:n.previousSibling=i;do{o.parentNode=e}while(o!==i&&(o=o.nextSibling));return H(e.ownerDocument||e,e),t.nodeType==Xt&&(t.firstChild=t.lastChild=null),t}function Q(e,t){var n=t.parentNode;if(n){var r=e.lastChild;n.removeChild(t);var r=e.lastChild}var r=e.lastChild;return t.parentNode=e,t.previousSibling=r,t.nextSibling=null,r?r.nextSibling=t:e.firstChild=t,e.lastChild=t,H(e.ownerDocument,e,t),t}function K(){this._nsMap={}}function ee(){}function te(){}function ne(){}function re(){}function oe(){}function ie(){}function se(){}function ae(){}function le(){}function ce(){}function ue(){}function he(){}function pe(e,t){var n=[],r=9==this.nodeType?this.documentElement:this,o=r.prefix,i=r.namespaceURI;if(i&&null==o){var o=r.lookupPrefix(i);if(null==o)var s=[{namespace:i,prefix:null}]}return de(this,n,e,t,s),n.join("")}function fe(e,t,n){var r=e.prefix||"",o=e.namespaceURI;if(!r&&!o)return!1;if("xml"===r&&"http://www.w3.org/XML/1998/namespace"===o||"http://www.w3.org/2000/xmlns/"==o)return!1;for(var i=n.length;i--;){var s=n[i];if(s.prefix==r)return s.namespace!=o}return!0}function de(e,t,n,r,o){if(r){if(!(e=r(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case Ot:o||(o=[]);var i=(o.length,e.attributes),s=i.length,a=e.firstChild,l=e.tagName;n=Nt===e.namespaceURI||n,t.push("<",l);for(var c=0;c<s;c++){var u=i.item(c);"xmlns"==u.prefix?o.push({prefix:u.localName,namespace:u.value}):"xmlns"==u.nodeName&&o.push({prefix:"",namespace:u.value})}for(var c=0;c<s;c++){var u=i.item(c);if(fe(u,n,o)){var h=u.prefix||"",p=u.namespaceURI,f=h?" xmlns:"+h:" xmlns";t.push(f,'="',p,'"'),o.push({prefix:h,namespace:p})}de(u,t,n,r,o)}if(fe(e,n,o)){var h=e.prefix||"",p=e.namespaceURI,f=h?" xmlns:"+h:" xmlns";t.push(f,'="',p,'"'),o.push({prefix:h,namespace:p})}if(a||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(l)){if(t.push(">"),n&&/^script$/i.test(l))for(;a;)a.data?t.push(a.data):de(a,t,n,r,o),
a=a.nextSibling;else for(;a;)de(a,t,n,r,o),a=a.nextSibling;t.push("</",l,">")}else t.push("/>");return;case zt:case Xt:for(var a=e.firstChild;a;)de(a,t,n,r,o),a=a.nextSibling;return;case Vt:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,X),'"');case Mt:return t.push(e.data.replace(/[<&]/g,X));case Ft:return t.push("<![CDATA[",e.data,"]]>");case jt:return t.push("\x3c!--",e.data,"--\x3e");case Bt:var d=e.publicId,g=e.systemId;if(t.push("<!DOCTYPE ",e.name),d)t.push(' PUBLIC "',d),g&&"."!=g&&t.push('" "',g),t.push('">');else if(g&&"."!=g)t.push(' SYSTEM "',g,'">');else{var m=e.internalSubset;m&&t.push(" [",m,"]"),t.push(">")}return;case Lt:return t.push("<?",e.target," ",e.data,"?>");case kt:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function ge(e,t,n){var r;switch(t.nodeType){case Ot:r=t.cloneNode(!1),r.ownerDocument=e;case Xt:break;case Vt:n=!0}if(r||(r=t.cloneNode(!1)),r.ownerDocument=e,r.parentNode=null,n)for(var o=t.firstChild;o;)r.appendChild(ge(e,o,n)),o=o.nextSibling;return r}function me(e,t,n){var r=new t.constructor;for(var o in t){var i=t[o];"object"!=typeof i&&i!=r[o]&&(r[o]=i)}switch(t.childNodes&&(r.childNodes=new V),r.ownerDocument=e,r.nodeType){case Ot:var s=t.attributes,a=r.attributes=new k,l=s.length;a._ownerElement=r;for(var c=0;c<l;c++)r.setAttributeNode(me(e,s.item(c),!0));break;case Vt:n=!0}if(n)for(var u=t.firstChild;u;)r.appendChild(me(e,u,n)),u=u.nextSibling;return r}function ve(e,t,n){e[t]=n}function Ce(e){switch(e.nodeType){case Ot:case Xt:var t=[];for(e=e.firstChild;e;)7!==e.nodeType&&8!==e.nodeType&&t.push(Ce(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}}function Se(e){var t="undefined"!=typeof document?document.implementation:new en.DOMImplementation,n={},r=[],o={};e.polygons.map(function(e){var t=0,i=0,s=1;e.shared&&e.shared.color&&(t=e.shared.color[0],i=e.shared.color[1],s=e.shared.color[2]);for(var a,l=[],c=e.vertices.length,u=0;u<c;u++)a=e.vertices[u],a.getTag()in o||(r.push(a.pos._x.toString()+" "+a.pos._y.toString()+" "+a.pos._z.toString()),o[a.getTag()]=r.length-1),l.push(o[a.getTag()]);var h=l.join(" "),p=t.toString()+" "+i.toString()+" "+s.toString();p in n||(n[p]=[]),n[p].push(h)});var i=t.createDocumentType("X3D","ISO//Web3D//DTD X3D 3.1//EN","http://www.web3d.org/specifications/x3d-3.1.dtd"),s=t.createDocument(null,"X3D",i);s.insertBefore(s.createProcessingInstruction("xml",'version="1.0" encoding="UTF-8"'),s.doctype);var a=s.getElementsByTagName("X3D")[0];a.setAttribute("profile","Interchange"),a.setAttribute("version","3.1"),a.setAttribute("xsd:noNamespaceSchemaLocation","http://www.web3d.org/specifications/x3d-3.1.xsd"),a.setAttribute("xmlns:xsd","http://www.w3.org/2001/XMLSchema-instance");var l=s.createElement("Scene");a.appendChild(l);var c=!1;for(var u in n){var h=n[u],p=s.createElement("Shape");l.appendChild(p);var f=s.createElement("Appearance");p.appendChild(f);var d=s.createElement("Material");f.appendChild(d),d.setAttribute("diffuseColor",u),d.setAttribute("ambientIntensity","1.0");var g=s.createElement("IndexedFaceSet");p.appendChild(g),g.setAttribute("solid","true"),g.setAttribute("coordIndex",h.join(" -1 ")+" -1");var m=s.createElement("Coordinate");g.appendChild(m),c?m.setAttribute("USE","coords_mesh"):(m.setAttribute("DEF","coords_mesh"),m.setAttribute("point",r.join(" ")),c=!0)}var v=(new nn).serializeToString(s);return new tn([v],{type:"model/x3d+xml"})}function ye(e){var t={type:"amf",unit:"mm",scale:1};switch("UNIT"in e&&(t.unit=e.UNIT.toLowerCase()),t.unit.toLowerCase()){case"inch":t.scale=on;break;case"foot":t.scale=12*on;break;case"meter":t.scale=1e3;break;case"micron":t.scale=.001}return t.objects=[],t}function we(e){var t={type:"mesh"};return t.objects=[],t}function xe(e){var t={type:"vertices"};return t.objects=[],t}function Ge(e){var t={type:"coordinates"};return t.objects=[],t}function be(e){var t={type:"normal"};return t.objects=[],t}function $e(e){return{type:"x",value:"0"}}function Te(e){return{type:"y",value:"0"}}function _e(e){return{type:"z",value:"0"}}function De(e){var t={type:"volume"};return"MATERIALID"in e&&(t.materialid=e.MATERIALID),t.objects=[],t}function Pe(e){var t={type:"triangle"};return t.objects=[],t}function Ae(e){return{type:"v1",value:"0"}}function Ee(e){return{type:"v2",value:"0"}}function Ne(e){return{type:"v3",value:"0"}}function Ie(e){var t={type:"vertex"};return t.objects=[],t}function Oe(e){var t={type:"edge"};return t.objects=[],t}function Ve(e){var t={type:"metadata"};return"TYPE"in e&&(t.mtype=e.TYPE),"ID"in e&&(t.id=e.ID),t}function Me(e){var t={type:"material"};return"ID"in e&&(t.id=e.ID),t.objects=[],t}function Fe(e){var t={type:"color"};return t.objects=[],t}function ke(e){return{type:"r",value:"1"}}function Re(e){return{type:"g",value:"1"}}function Le(e){return{type:"b",value:"1"}}function je(e){return{type:"a",value:"1"}}function ze(e){var t={type:"map"};return"GTEXID"in e&&(t.gtexid=e.GTEXID),"BTEXID"in e&&(t.btexid=e.BTEXID),"RTEXID"in e&&(t.rtexid=e.RTEXID),t.objects=[],t}function Be(e){return{type:"u1",value:"0"}}function Xe(e){return{type:"u2",value:"0"}}function Ye(e){return{type:"u3",value:"0"}}function Ue(e,t){var n=rn.parser(!1,{trim:!0,lowercase:!1,position:!0});return n.onerror=function(e){console.log("error: line "+e.line+", column "+e.column+", bad character ["+e.c+"]")},n.onopentag=function(e){var t=null;switch(e.name){case"AMF":t=ye(e.attributes);break;case"OBJECT":t=this.amfObject(e.attributes),0===this.amfDefinition&&(this.amfDefinition=1);break;case"MESH":t=we(e.attributes);break;case"VERTICES":t=xe(e.attributes);break;case"VERTEX":t=Ie(e.attributes);break;case"EDGE":t=Oe(e.attributes);break;case"VOLUME":t=De(e.attributes);break;case"MATERIAL":t=Me(e.attributes),0===this.amfDefinition&&(this.amfDefinition=2);break;case"COMPOSITE":break;case"TEXTURE":0===this.amfDefinition&&(this.amfDefinition=3);break;case"CONSTELLATION":0===this.amfDefinition&&(this.amfDefinition=4);break;case"METADATA":t=Ve(e.attributes),0===this.amfDefinition&&(this.amfDefinition=5);break;case"COORDINATES":t=Ge(e.attributes);break;case"NORMAL":t=be(e.attributes);break;case"X":case"NX":t=$e(e.attributes);break;case"Y":case"NY":t=Te(e.attributes);break;case"Z":case"NZ":t=_e(e.attributes);break;case"TRIANGLE":t=Pe(e.attributes);break;case"V1":case"VTEX1":t=Ae(e.attributes);break;case"V2":case"VTEX2":t=Ee(e.attributes);break;case"V3":case"VTEX3":t=Ne(e.attributes);break;case"COLOR":t=Fe(e.attributes);break;case"R":t=ke(e.attributes);break;case"G":t=Re(e.attributes);break;case"B":t=Le(e.attributes);break;case"A":t=je(e.attributes);break;case"MAP":case"TEXMAP":t=ze(e.attributes);break;case"U1":case"UTEX1":case"VTEX1":case"WTEX1":t=Be(e.attributes);break;case"U2":case"UTEX2":case"VTEX2":case"WTEX2":t=Xe(e.attributes);break;case"U3":case"UTEX3":case"VTEX3":case"WTEX3":t=Ye(e.attributes)}if(null!==t){switch(this.amfDefinition){case 0:"objects"in t&&this.amfObjects.push(t);break;case 1:if(this.amfObjects.length>0){var n=this.amfObjects.pop();"objects"in n&&n.objects.push(t),this.amfObjects.push(n),"objects"in t&&this.amfObjects.push(t)}break;case 2:if("material"===t.type)this.amfMaterials.push(t);else if(this.amfMaterials.length>0){var n=this.amfMaterials.pop();"objects"in n&&n.objects.push(t),this.amfMaterials.push(n),"objects"in t&&this.amfMaterials.push(t)}break;case 3:case 4:case 5:break;default:console.log("ERROR: invalid AMF definition")}this.amfLast=t}},n.onclosetag=function(e){switch(e){case"AMF":case"OBJECT":case"MESH":case"VERTICES":case"VERTEX":case"EDGE":case"COORDINATES":case"NORMAL":case"VOLUME":case"TRIANGLE":case"MATERIAL":case"COLOR":case"MAP":case"TEXMAP":break;case"TEXTURE":return void(3===this.amfDefinition&&(this.amfDefinition=0));case"CONSTELLATION":return void(4===this.amfDefinition&&(this.amfDefinition=0));case"METADATA":return void(5===this.amfDefinition&&(this.amfDefinition=0));default:return}var t=null;switch(this.amfDefinition){case 0:case 1:this.amfObjects.length>0&&(t=this.amfObjects.pop(),"object"===t.type&&(this.amfDefinition=0)),0===this.amfObjects.length&&(this.amfObj=t);break;case 2:this.amfMaterials.length>0&&(t=this.amfMaterials.pop(),"material"===t.type&&(this.amfMaterials.push(t),this.amfDefinition=0));break;case 3:case 4:case 5:this.amfDefinition=0}},n.ontext=function(e){null!==e&&this.amfLast&&0!==this.amfDefinition&&(this.amfLast.value=e)},n.onend=function(){},n.write(e).close(),n}function qe(e,t){function n(e){if(h&&h.id===e)return h;for(var t=0;t<u.length;t++)if(u[t].id&&u[t].id===e)return h=u[t];return null}function r(e,t){for(var n=0;n<e.length;n++)if(e[n].type===t)return e[n].value;return null}function o(e){for(var t=0;t<e.length;t++){var n=e[t];if("color"===n.type){var o=parseFloat(r(n.objects,"r")),i=parseFloat(r(n.objects,"g")),s=parseFloat(r(n.objects,"b")),a=parseFloat(r(n.objects,"a"));return Number.isNaN(o)&&(o=1),Number.isNaN(i)&&(i=1),Number.isNaN(s)&&(s=1),Number.isNaN(a)&&(a=1),[o,i,s,a]}}return null}function i(e){var t=n(e);return t?o(t.objects):null}function s(e,t){switch(e.type){case"object":a(e,t);break;case"metadata":case"material":break;default:console.log("Warning: unknown definition: "+e.type)}}function a(e,n){function s(e,t){if("coordinates"===e.type){var n=parseFloat(r(e.objects,"x")),o=parseFloat(r(e.objects,"y")),i=parseFloat(r(e.objects,"z"));p.push([n,o,i])}}function a(e,t){"vertex"===e.type&&e.objects.map(s)}function c(e,t){if("triangle"===e.type){var n=parseInt(r(e.objects,"v1")),i=parseInt(r(e.objects,"v2")),s=parseInt(r(e.objects,"v3"));f.push([n,i,s]);var a=o(e.objects);a?d.push(a):d.push(g)}}function u(e,n){switch(e.type){case"vertices":e.objects.map(a,t);break;case"volume":g=o(e.objects),e.materialid&&(g=i(e.materialid)),e.objects.map(c,t)}}function h(e,n){"mesh"===e.type&&e.objects.map(u,t)}var p=[],f=[],d=[],g=null;if(e.objects.length>0){e.objects.map(h,t);var m=f.length,v=p.length;l+="// Object "+e.id+"\n",l+="//  faces   : "+m+"\n",l+="//  vertices: "+v+"\n",l+="function createObject"+e.id+"() {\n",l+="  var polys = [];\n";for(var C=0;C<m;C++){l+="  polys.push(\n",l+="    PP([\n";for(var S=0;S<f[C].length;S++)f[C][S]<0||f[C][S]>=v?""===err.length&&(err+="bad index for vertice (out of range)"):(S&&(l+=",\n"),l+="      VV("+p[f[C][S]]+")");if(l+="])",d[C]){var y=d[C];l+=".setColor(["+y[0]+","+y[1]+","+y[2]+","+y[3]+"])"}l+=");\n"}l+="  return CSG.fromPolygons(polys);\n",l+="}\n"}}if("amf"!==e.type||!e.objects)throw new Error("AMF malformed");var l="",c=e.objects,u=t.amfMaterials,h=null;l="// Objects  : "+c.length+"\n",l+="// Materials: "+u.length+"\n",l+="\n",l+="// helper functions\n",1!==e.scale?(l+="var SCALE = "+e.scale+"; // scaling units ("+e.unit+")\n",l+="var VV = function(x,y,z) { return new CSG.Vertex(new CSG.Vector3D(x*SCALE,y*SCALE,z*SCALE)); };\n"):l+="var VV = function(x,y,z) { return new CSG.Vertex(new CSG.Vector3D(x,y,z)); };\n",l+="var PP = function(a) { return new CSG.Polygon(a); };\n",l+="\n",l+="function main() {\n",l+="  var csgs = [];\n";for(var p=0;p<c.length;p++){var f=c[p];"object"===f.type&&(l+="  csgs.push(createObject"+f.id+"());\n")}return l+="  return union(csgs);\n",l+="}\n",l+="\n",c.map(s,t),l}function We(e,t,n){t=t||"amf";var r={version:"0.0.0"};n=Object.assign({},r,n);var o=n.version,i=Ue(e),s="";return s+="//\n",s+="// producer: OpenJSCAD.org "+o+" AMF Importer\n",s+="// date: "+new Date+"\n",s+="// source: "+t+"\n",s+="//\n",null!==i.amfObj?s+=qe(i.amfObj,i):console.log("Warning: AMF parsing failed"),s}function He(e,t,n){var r={version:"0.0.0"};n=Object.assign({},r,n);for(var o=n.version,i=e.split(/[\n]/),s="",a=0,l=[],c=[],u=0,h=[],p=[-100,-100],f=0,d=.35,g=0,m=0;m<i.length;m++){var v,C="",S=0;if(!i[m].match(/^\s*;/)){for(var y=i[m].split(/\s+/),w=0;w<y.length;w++)if(y[w].match(/G(\d+)/)){var x=parseInt(RegExp.$1);1==x&&a++,90==x&&(l.type="abs"),91==x&&(l.type="rel")}else if(y[w].match(/M(\d+)/)){var x=parseInt(RegExp.$1);104!=x&&109!=x||(v="temp")}else if(y[w].match(/S([\d\.]+)/)){var G=parseInt(RegExp.$1);void 0!==v&&(C[v]=G)}else if(y[w].match(/([XYZE])([\-\d\.]+)/)){var b=RegExp.$1,G=parseFloat(RegExp.$2);"abs"==l.type?a&&(l[b]=G):a&&(l[b]+=G),a&&"E"==b&&void 0===c.E&&(c.E=l.E),a&&"E"==b&&l.E-c.E>0&&S++}a&&l.X&&l.Y&&(S&&(!u&&c.X&&c.Y&&h.push("["+(c.X+p[0])+","+(c.Y+p[1])+"]"),h.push("["+(l.X+p[0])+","+(l.Y+p[1])+"]")),!S&&u&&h.length>1&&(s.length&&(s+=",\n\t\t"),l.Z!=g&&(d=l.Z-g,f++),s+="EX(["+h.join(", ")+"],{w: "+1.1*d+", h:"+1.02*d+", fn:1, closed: false}).translate([0,0,"+l.Z+"])",h=[],g=l.Z),u=S,c.X=l.X,c.Y=l.Y,c.Z=l.Z,c.E=l.E),a}}var $="";return $+="// producer: OpenJSCAD Compatibility ("+o+") GCode Importer\n",$+="// date: "+new Date+"\n",$+="// source: "+t+"\n",$+="\n",$+="// layers: "+f+"\n",$+="function main() {\n\tvar EX = function(p,opt) { return rectangular_extrude(p,opt); }\n\treturn [",$+=s,$+="\n\t];\n}\n"}function Ze(e){return"new CSG.Vertex(new CSG.Vector3D("+e._x+","+e._y+","+e._z+"))"}function Je(e){var t="  var polygons = [];\n";return e.polygons.map(function(e){t+="  poly = new CSG.Polygon([\n";for(var n=0;n<e.vertices.length;n++)t+="                         "+Ze(e.vertices[n].pos)+",\n";t+="                         ])",e.shared&&e.shared.color&&e.shared.color.length?t+=".setColor("+JSON.stringify(e.shared.color)+");\n":t+=";\n",t+="  polygons.push(poly);\n"}),t+="  return CSG.fromPolygons(polygons);\n"}function Qe(e){return"new CAG.Vertex(new CSG.Vector2D("+e.pos._x+","+e.pos._y+"))"}function Ke(e){return"new CAG.Side("+Qe(e.vertex0)+","+Qe(e.vertex1)+")"}function et(e){var t="  var sides = [];\n";return e.sides.map(function(e){t+="  sides.push("+Ke(e)+");\n"}),t+="  return CAG.fromSides(sides);\n"}function tt(e){if(e.type&&"csg"===e.type){return Je(ht.CSG.fromObject(e))}if(e.type&&"cag"===e.type){return et(CAG.fromObject(e))}return""}function nt(e,t,n){t=t||"amf";var r={version:"0.0.0"};n=Object.assign({},r,n);var o=n.version,i=JSON.parse(e),s="";return s+="//\n",s+="// producer: OpenJSCAD.org "+o+" JSON Importer\n",s+="// date: "+new Date+"\n",s+="// source: "+t+"\n",s+="//\n",s+="function main() {\n",s+=tt(i),s+="};\n"}function rt(e,t,n,r){var o="";o+="polyhedron({ points: [\n\t";for(var i=0,s=0;i<e.length;i++)s++&&(o+=",\n\t"),o+="["+e[i]+"]";o+="],\n\tpolygons: [\n\t";for(var i=0,s=0;i<t.length;i++)s++&&(o+=",\n\t"),o+="["+t[i]+"]";if(r&&t.length==r.length){o+="],\n\tcolors: [\n\t";for(var i=0,s=0;i<r.length;i++)s++&&(o+=",\n\t"),o+="["+r[i]+"]"}return o+="] })\n"}function ot(e,t,n){var r={version:"0.0.0"};n=Object.assign({},r,n);for(var o=n.version,i=e.split(/\n/),s=[],a=[],l=0;l<i.length;l++){var c=i[l],u=c.split(/\s+/);if("v"==u[0])s.push([u[1],u[2],u[3]]);else if("f"==u[0]){for(var h=[],p=0,f=1;f<u.length;f++){var d=u[f];d=d.replace(/\/.*$/,""),d--,d>=s.length&&p++,0==p&&h.push(d)}0==p&&a.push(h)}}var g="";return g+="// producer: OpenJSCAD Compatibility ("+o+") Wavefront OBJ Importer\n",g+="// date: "+new Date+"\n",g+="// source: "+t+"\n",g+="\n",g+="// objects: 1\n// object #1: polygons: "+a.length+"\n\n",g+="function main() { return ",g+=rt(s,a),g+="; }"}function it(e,t,n){var r={version:"0.0.0"};n=Object.assign({},r,n);for(var o=n.version,i=!0,s=0;s<e.length;s++)if(0==e[s].charCodeAt(0)){i=!1;break}return i?at(e,t,o):st(e,t,o)}function st(e,t,n){for(var r=[],o=[],i=[],s=[],a=0,l=0,c=0,u=null,h=parseInt("01000000000000000",2),p=parseInt("00000000000011111",2),f=parseInt("00000001111100000",2),d=parseInt("00111110000000000",2),g=new lt(e),m=0,v=0,C=0,S=0,y=0,w=0;w<80;w++)switch(m){case 6:v=g.readUInt8(),m+=1;continue;case 7:C=g.readUInt8(),m+=1;continue;case 8:S=g.readUInt8(),m+=1;continue;case 9:y=g.readUInt8(),m+=1;continue;default:switch(g.readChar()){case"C":case"O":case"L":case"R":case"=":m+=1}}10==m&&(u=[v/255,C/255,S/255,y/255]);for(var x=g.readUInt32(),G=0;G<x;G++){var b=[];b.push(g.readFloat()),b.push(g.readFloat()),b.push(g.readFloat());var $=[];$.push(g.readFloat()),$.push(g.readFloat()),$.push(g.readFloat());var T=[];T.push(g.readFloat()),T.push(g.readFloat()),T.push(g.readFloat());var _=[];_.push(g.readFloat()),_.push(g.readFloat()),_.push(g.readFloat());for(var D=0,w=0;w<3;w++)isNaN($[w])&&D++,isNaN(T[w])&&D++,isNaN(_[w])&&D++,isNaN(b[w])&&D++;D>0&&sn("bad triangle vertice coords/normal: ",D),c+=D;var P=[];P.push(a++),P.push(a++),P.push(a++);var A=g.readUInt16(),E=null;if(10==m){var N=A&h,v=(A&p)/31,C=((A&f)>>>5)/31,S=((A&d)>>>10)/31,y=255;E=0==N?[v,C,S,y]:u,s.push(E)}if(0==D){var I=new ht.CSG.Vector3D($),O=new ht.CSG.Vector3D(T),V=new ht.CSG.Vector3D(_),M=O.minus(I),F=V.minus(I);if(new ht.CSG.Vector3D(b).dot(M.cross(F))>0){var k=_;_=$,$=k}}r.push($),r.push(T),r.push(_),o.push(P),i.push(b),l++}var R="";return R+="// producer: OpenJSCAD Compatibility ("+n+") STL Binary Importer\n",R+="// date: "+new Date+"\n",R+="// source: "+t+"\n",R+="\n",c&&(R+="// WARNING: import errors: "+c+" (some triangles might be misaligned or missing)\n"),R+="// objects: 1\n// object #1: triangles: "+x+"\n\n",R+="function main() { return ",R+=rt(r,o,i,s),R+="; }"}function at(e,t,n){var r,o="",i=0,s=0;o+="// producer: OpenJSCAD Compatibility ("+n+") STL ASCII Importer\n",o+="// date: "+new Date+"\n",o+="// source: "+t+"\n",o+="\n",o+="function main() { return union(\n";var a=e.split("endsolid");for(o+="// objects: "+(a.length-1)+"\n",r=1;r<a.length;r++){var l=[],c=[],u=[],h=0,p=0,f=e.match(/\bfacet[\s\S]*?endloop/gim);if(null!=f){for(var d=0;d<f.length;d++){var g=/\bfacet\s+normal\s+(\S+)\s+(\S+)\s+(\S+)\s+outer\s+loop\s+vertex\s+(\S+)\s+(\S+)\s+(\S+)\s+vertex\s+(\S+)\s+(\S+)\s+(\S+)\s+vertex\s+(\S+)\s+(\S+)\s+(\S+)\s*/gim,m=g.exec(f[d]);if(null!=m){if(13!=m.length){sn("Failed to parse "+f[d]);break}for(var v=0,C=0;C<m.length;C++)"NaN"==m[C]&&(sn("bad normal or triangle vertice #"+s+" "+C+": '"+m[C]+"', skipped"),v++);if(p+=v,!v){var S,y,w,x,G,b,$,S=1,T=[];T.push(parseFloat(m[S++])),T.push(parseFloat(m[S++])),T.push(parseFloat(m[S++]));var y=[];y.push(parseFloat(m[S++])),y.push(parseFloat(m[S++])),y.push(parseFloat(m[S++]));var w=[];w.push(parseFloat(m[S++])),w.push(parseFloat(m[S++])),w.push(parseFloat(m[S++]));var x=[];x.push(parseFloat(m[S++])),x.push(parseFloat(m[S++])),x.push(parseFloat(m[S++]));var _=[];if(_.push(h++),_.push(h++),_.push(h++),0==v){var G=new ht.CSG.Vector3D(y),b=new ht.CSG.Vector3D(w),$=new ht.CSG.Vector3D(x),D=b.minus(G),P=$.minus(G);if(new ht.CSG.Vector3D(T).dot(D.cross(P))>0){var A=x;x=y,y=A}}l.push(y),l.push(w),l.push(x),u.push(T),c.push(_),s++}}}i++&&(o+=","),p&&(o+="// WARNING: import errors: "+p+" (some triangles might be misaligned or missing)\n"),o+="// object #"+r+": triangles: "+f.length+"\n",o+=rt(l,c,u)}}return o+="); }\n"}function lt(e){this._buffer=e,this._pos=0}function ct(e,t){var n=an.parser(!1,{trim:!0,lowercase:!1,position:!0});return void 0!==t&&t>n.pxPmm&&(n.pxPmm=t),n.onerror=function(e){console.log("error: line "+e.line+", column "+e.column+", bad character ["+e.c+"]")},n.onopentag=function(e){var t=null;switch(e.name){case"SVG":t=this.svgSvg(e.attributes);break;case"G":t=this.svgGroup(e.attributes);break;case"RECT":t=this.svgRect(e.attributes);break;case"CIRCLE":t=this.svgCircle(e.attributes);break;case"ELLIPSE":t=this.svgEllipse(e.attributes);break;case"LINE":t=this.svgLine(e.attributes);break;case"POLYLINE":t=this.svgPolyline(e.attributes);break;case"POLYGON":t=this.svgPolygon(e.attributes);break;case"PATH":t=this.svgPath(e.attributes);break;case"USE":t=this.svgUse(e.attributes);break;case"DEFS":this.svgInDefs=!0;break;case"DESC":case"TITLE":case"STYLE":break;default:console.log("Warning: Unsupported SVG element: "+e.name)}if(null!==t)if("id"in t&&(this.svgObjects[t.id]=t),"svg"==t.type)this.svgGroups.push(t),this.svgUnitsPmm=t.unitsPmm,this.svgUnitsX=t.viewW,this.svgUnitsY=t.viewH,this.svgUnitsV=t.viewP;else{if(this.svgGroups.length>0&&0==this.svgInDefs){var n=this.svgGroups.pop();"objects"in n&&n.objects.push(t),this.svgGroups.push(n)}"group"==t.type&&this.svgGroups.push(t)}},n.onclosetag=function(e){var t=null;switch(e){case"SVG":t=this.svgGroups.pop();break;case"DEFS":this.svgInDefs=!1;break;case"USE":case"G":t=this.svgGroups.pop()}0===this.svgGroups.length&&(this.svgObj=t)},n.onend=function(){},n.write(e).close(),n}function ut(e,t,n){var t=t||"svg",r={pxPmm:void 0,version:"0.0.0"};n=Object.assign({},r,n);var o=n.version,i=n.pxPmm,s=ct(e,i),a="";return a+="//\n",a+="// producer: OpenJSCAD.org "+o+" SVG Importer\n",a+="// date: "+new Date+"\n",a+="// source: "+t+"\n",a+="//\n",null!==s.svgObj?a+=s.codify(s.svgObj):console.log("Warning: SVG parsing failed"),a}Object.defineProperty(t,"__esModule",{value:!0});var ht=require$$0$1;r.prototype={asBuffer:function(){return this.buffer.slice(0,this.size)},slice:function(e,t,n){return e=e||0,t=t||this.size,n=n||"",new r},close:function(){this.isClosed||(this.isClosed=!0)},toString:function(){return"blob blob blob"}};var pt=n(),ft=n(),dt=n(),gt=n(),mt=n(),vt=n(),Ct=n(),St=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,yt=new RegExp("[\\-\\.0-9"+St.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),wt=new RegExp("^"+St.source+yt.source+"*(?::"+St.source+yt.source+"*)?$"),xt=0,Gt=1,bt=2,$t=3,Tt=4,_t=5,Dt=6,Pt=7;S.prototype={parse:function(e,t,n){var r=this.domBuilder;r.startDocument(),T(t,t={}),y(e,t,n,r,this.errorHandler),r.endDocument()}},P.prototype={setTagName:function(e){if(!wt.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,n){if(!wt.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},A({},A.prototype)instanceof A||(A=function(e,t){function n(){}n.prototype=t,n=new n;for(t in e)n[t]=e[t];return n});var At=S,Et={XMLReader:At},Nt="http://www.w3.org/1999/xhtml",It={},Ot=It.ELEMENT_NODE=1,Vt=It.ATTRIBUTE_NODE=2,Mt=It.TEXT_NODE=3,Ft=It.CDATA_SECTION_NODE=4,kt=It.ENTITY_REFERENCE_NODE=5,Rt=It.ENTITY_NODE=6,Lt=It.PROCESSING_INSTRUCTION_NODE=7,jt=It.COMMENT_NODE=8,zt=It.DOCUMENT_NODE=9,Bt=It.DOCUMENT_TYPE_NODE=10,Xt=It.DOCUMENT_FRAGMENT_NODE=11,Yt=It.NOTATION_NODE=12,Ut={},qt={},Wt=(Ut.INDEX_SIZE_ERR=(qt[1]="Index size error",1),Ut.DOMSTRING_SIZE_ERR=(qt[2]="DOMString size error",2),Ut.HIERARCHY_REQUEST_ERR=(qt[3]="Hierarchy request error",3)),Ht=(Ut.WRONG_DOCUMENT_ERR=(qt[4]="Wrong document",4),Ut.INVALID_CHARACTER_ERR=(qt[5]="Invalid character",5),Ut.NO_DATA_ALLOWED_ERR=(qt[6]="No data allowed",6),Ut.NO_MODIFICATION_ALLOWED_ERR=(qt[7]="No modification allowed",7),Ut.NOT_FOUND_ERR=(qt[8]="Not found",8)),Zt=(Ut.NOT_SUPPORTED_ERR=(qt[9]="Not supported",9),Ut.INUSE_ATTRIBUTE_ERR=(qt[10]="Attribute in use",10));Ut.INVALID_STATE_ERR=(qt[11]="Invalid state",11),Ut.SYNTAX_ERR=(qt[12]="Syntax error",12),Ut.INVALID_MODIFICATION_ERR=(qt[13]="Invalid modification",13),Ut.NAMESPACE_ERR=(qt[14]="Invalid namespace",14),Ut.INVALID_ACCESS_ERR=(qt[15]="Invalid access",15);O.prototype=Error.prototype,N(Ut,O),V.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var n=this,r=[],o=0;o<this.length;o++)de(n[o],r,e,t);return r.join("")}},M.prototype.item=function(e){return F(this),this[e]},I(M,V),k.prototype={length:0,item:V.prototype.item,getNamedItem:function(e){for(var t=this,n=this.length;n--;){var r=t[n];if(r.nodeName==e)return r}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new O(Zt);var n=this.getNamedItem(e.nodeName);return L(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new O(Zt);return t=this.getNamedItemNS(e.namespaceURI,e.localName),L(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return j(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return j(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this,r=this.length;r--;){var o=n[r];if(o.localName==t&&o.namespaceURI==e)return o}return null}},z.prototype={hasFeature:function(e,t){var n=this._features[e.toLowerCase()];return!(!n||t&&!(t in n))},createDocument:function(e,t,n){var r=new U;if(r.implementation=this,r.childNodes=new V,r.doctype=n,n&&r.appendChild(n),t){var o=r.createElementNS(e,t);r.appendChild(o)}return r},createDocumentType:function(e,t,n){var r=new ie;return r.name=e,r.nodeName=e,r.publicId=t,r.systemId=n,r}},B.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return J(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return Z(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return me(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this,t=this.firstChild;t;){var n=t.nextSibling;n&&n.nodeType==Mt&&t.nodeType==Mt?(e.removeChild(n),t.appendData(n.data)):(t.normalize(),t=n)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n)for(var r in n)if(n[r]==e)return r;t=t.nodeType==Vt?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&e in n)return n[e];t=t.nodeType==Vt?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},N(It,B),N(It,B.prototype),U.prototype={nodeName:"#document",nodeType:zt,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){var n=this;if(e.nodeType==Xt){for(var r=e.firstChild;r;){var o=r.nextSibling;n.insertBefore(r,t),r=o}return e}return null==this.documentElement&&e.nodeType==Ot&&(this.documentElement=e),J(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),Z(this,e)},importNode:function(e,t){return ge(this,e,t)},getElementById:function(e){var t=null;return Y(this.documentElement,function(n){if(n.nodeType==Ot&&n.getAttribute("id")==e)return t=n,!0}),t},createElement:function(e){var t=new K;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new V,(t.attributes=new k)._ownerElement=t,t},createDocumentFragment:function(){var e=new ce;return e.ownerDocument=this,e.childNodes=new V,e},createTextNode:function(e){var t=new ne;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new re;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new oe;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new ue;return n.ownerDocument=this,n.tagName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new ee;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new le;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new K,r=t.split(":"),o=n.attributes=new k;return n.childNodes=new V,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,o._ownerElement=n,n},createAttributeNS:function(e,t){var n=new ee,r=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,n}},I(U,B),K.prototype={nodeType:Ot,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===Xt?this.insertBefore(e,null):Q(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var r=this.ownerDocument.createAttributeNS(e,t);r.value=r.nodeValue=""+n,this.setAttributeNode(r)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new M(this,function(t){var n=[];return Y(t,function(r){r===t||r.nodeType!=Ot||"*"!==e&&r.tagName!=e||n.push(r)}),n})},getElementsByTagNameNS:function(e,t){return new M(this,function(n){var r=[];return Y(n,function(o){o===n||o.nodeType!==Ot||"*"!==e&&o.namespaceURI!==e||"*"!==t&&o.localName!=t||r.push(o)}),r})}},U.prototype.getElementsByTagName=K.prototype.getElementsByTagName,U.prototype.getElementsByTagNameNS=K.prototype.getElementsByTagNameNS,I(K,B),ee.prototype.nodeType=Vt,I(ee,B),te.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(qt[Wt])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){n=this.data.substring(0,e)+n+this.data.substring(e+t),this.nodeValue=this.data=n,this.length=n.length}},I(te,B),ne.prototype={nodeName:"#text",nodeType:Mt,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var r=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}},I(ne,te),re.prototype={nodeName:"#comment",nodeType:jt},I(re,te),oe.prototype={nodeName:"#cdata-section",nodeType:Ft},I(oe,te),ie.prototype.nodeType=Bt,I(ie,B),se.prototype.nodeType=Yt,I(se,B),ae.prototype.nodeType=Rt,I(ae,B),le.prototype.nodeType=kt,I(le,B),ce.prototype.nodeName="#document-fragment",ce.prototype.nodeType=Xt,I(ce,B),ue.prototype.nodeType=Lt,I(ue,B),he.prototype.serializeToString=function(e,t,n){return pe.call(e,t,n)},B.prototype.toString=pe;try{Object.defineProperty&&(Object.defineProperty(M.prototype,"length",{get:function(){return F(this),this.$$length}}),Object.defineProperty(B.prototype,"textContent",{get:function(){return Ce(this)},set:function(e){var t=this;switch(this.nodeType){case Ot:case Xt:for(;this.firstChild;)t.removeChild(t.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),ve=function(e,t,n){e["$$"+t]=n})}catch(e){}var Jt=z,Qt=he,Kt={DOMImplementation:Jt,XMLSerializer:Qt},en=function(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(e,t){function n(e){this.options=e||{locator:{}}}function r(e,t,n){function r(t){var r=e[t];!r&&a&&(r=2==e.length?function(n){e(t,n)}:e),i[t]=r&&function(e){r("[xmldom "+t+"]\t"+e+s(n))}||function(){}}if(!e){if(t instanceof o)return t;e=t}var i={},a=e instanceof Function;return n=n||{},r("warning"),r("error"),r("fatalError"),i}function o(){this.cdata=!1}function i(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function s(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function a(e,t,n){return"string"==typeof e?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+"":e}function l(e,t){
e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}n.prototype.parseFromString=function(e,t){var n=this.options,i=new c,s=n.domBuilder||new o,a=n.errorHandler,l=n.locator,u=n.xmlns||{},h={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return l&&s.setDocumentLocator(l),i.errorHandler=r(a,s,l),i.domBuilder=n.domBuilder||s,/\/x?html?$/.test(t)&&(h.nbsp="",h.copy="",u[""]="http://www.w3.org/1999/xhtml"),u.xml=u.xml||"http://www.w3.org/XML/1998/namespace",e?i.parse(e,u,h):i.errorHandler.error("invalid doc source"),s.doc},o.prototype={startDocument:function(){this.doc=(new u).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,r){var o=this,s=this.doc,a=s.createElementNS(e,n||t),c=r.length;l(this,a),this.currentElement=a,this.locator&&i(this.locator,a);for(var u=0;u<c;u++){var e=r.getURI(u),h=r.getValue(u),n=r.getQName(u),p=s.createAttributeNS(e,n);o.locator&&i(r.getLocator(u),p),p.value=p.nodeValue=h,a.setAttributeNode(p)}},endElement:function(e,t,n){var r=this.currentElement;r.tagName;this.currentElement=r.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var n=this.doc.createProcessingInstruction(e,t);this.locator&&i(this.locator,n),l(this,n)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){if(e=a.apply(this,arguments)){if(this.cdata)var r=this.doc.createCDATASection(e);else var r=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(e)&&this.doc.appendChild(r),this.locator&&i(this.locator,r)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=a.apply(this,arguments);var r=this.doc.createComment(e);this.locator&&i(this.locator,r),l(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var r=this.doc.implementation;if(r&&r.createDocumentType){var o=r.createDocumentType(e,t,n);this.locator&&i(this.locator,o),l(this,o)}},warning:function(e){console.warn("[xmldom warning]\t"+e,s(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,s(this.locator))},fatalError:function(e){throw console.error("[xmldom fatalError]\t"+e,s(this.locator)),e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){o.prototype[e]=function(){return null}});var c=Et.XMLReader,u=t.DOMImplementation=Kt.DOMImplementation;t.XMLSerializer=Kt.XMLSerializer,t.DOMParser=n}),tn=n(),nn=en.XMLSerializer,rn=sax,on=1/.03937;rn.SAXParser.prototype.amfLast=null,rn.SAXParser.prototype.amfDefinition=0,rn.SAXParser.prototype.amfObjects=[],rn.SAXParser.prototype.amfMaterials=[],rn.SAXParser.prototype.amfTextures=[],rn.SAXParser.prototype.amfConstels=[],rn.SAXParser.prototype.amfMetadata=[],rn.SAXParser.prototype.amfObj=null,rn.SAXParser.prototype.amfObject=function(e){var t={type:"object",id:"JSCAD"+this.amfObjects.length};return"ID"in e&&(t.id=e.ID),t.objects=[],t};var sn=console.info;lt.prototype={readInt8:function(){return this._decodeInt(8,!0)},readUInt8:function(){return this._decodeInt(8,!1)},readInt16:function(){return this._decodeInt(16,!0)},readUInt16:function(){return this._decodeInt(16,!1)},readInt32:function(){return this._decodeInt(32,!0)},readUInt32:function(){return this._decodeInt(32,!1)},readFloat:function(){return this._decodeFloat(23,8)},readDouble:function(){return this._decodeFloat(52,11)},readChar:function(){return this.readString(1)},readString:function(e){this._checkSize(8*e);var t=this._buffer.substr(this._pos,e);return this._pos+=e,t},seek:function(e){this._pos=e,this._checkSize(0)},getPosition:function(){return this._pos},getSize:function(){return this._buffer.length},_decodeFloat:function(e,t){var n=this,r=e+t+1,o=r>>3;this._checkSize(r);var i=Math.pow(2,t-1)-1,s=this._readBits(e+t,1,o),a=this._readBits(e,t,o),l=0,c=2,u=0;do{for(var h=n._readByte(++u,o),p=e%8||8,f=1<<p;f>>=1;)h&f&&(l+=1/c),c*=2}while(e-=p);return this._pos+=o,a==1+(i<<1)?l?NaN:s?-1/0:1/0:(1+-2*s)*(a||l?a?Math.pow(2,a-i)*(1+l):Math.pow(2,1-i)*l:0)},_decodeInt:function(e,t){var n=this._readBits(0,e,e/8),r=Math.pow(2,e),o=t&&n>=r/2?n-r:n;return this._pos+=e/8,o},_shl:function(e,t){for(++t;--t;e=1073741824==(1073741824&(e%=2147483648))?2*e:2*(e-1073741824)+2147483647+1);return e},_readByte:function(e,t){return 255&this._buffer.charCodeAt(this._pos+t-e-1)},_readBits:function(e,t,n){var r=this,o=(e+t)%8,i=e%8,s=n-(e>>3)-1,a=n+(-(e+t)>>3),l=s-a,c=this._readByte(s,n)>>i&(1<<(l?8-i:t))-1;for(l&&o&&(c+=(this._readByte(a++,n)&(1<<o)-1)<<(l--<<3)-i);l;)c+=r._shl(r._readByte(a++,n),(l--<<3)-i);return c},_checkSize:function(e){this._pos,Math.ceil(e/8),this._buffer.length}};var an=sax;an.SAXParser.prototype.pxPmm=1/.2822222;var ln={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};an.SAXParser.prototype.svg2cagX=function(e){return e/this.svgUnitsPmm[0]},an.SAXParser.prototype.svg2cagY=function(e){return 0-e/this.svgUnitsPmm[1]},an.SAXParser.prototype.cagLengthX=function(e){if(e.indexOf("%")<0)return this.css2cag(e,this.svgUnitsPmm[0]);var t=parseFloat(e);return isNaN(t)?0:0==t?t:(t=t/100*this.svgUnitsX,t/=this.svgUnitsPmm[0],-1e5*Math.round(t/-1e5))},an.SAXParser.prototype.cagLengthY=function(e){if(e.indexOf("%")<0)return this.css2cag(e,this.svgUnitsPmm[1]);var t=parseFloat(e);return isNaN(t)?0:0==t?t:(t=t/100*this.svgUnitsY,t/=this.svgUnitsPmm[1],-1e5*Math.round(t/-1e5))},an.SAXParser.prototype.cagLengthP=function(e){if(e.indexOf("%")<0)return this.css2cag(e,this.svgUnitsPmm[1]);var t=parseFloat(e);return isNaN(t)?0:0==t?t:(t=t/100*this.svgUnitsV,t/=this.svgUnitsPmm[0])},an.SAXParser.prototype.css2cag=function(e,t){var n=parseFloat(e);return isNaN(n)?0:0==n?n:(e.search(/EM/i)>0?n=n:e.search(/EX/i)>0?n=n:e.search(/MM/i)>0?n=n:e.search(/CM/i)>0?n*=10:e.search(/IN/i)>0?n/=.03937:e.search(/PT/i)>0?n/=1/(1/.03937/72):e.search(/PC/i)>0?n/=.23622:n/=t,n)},an.SAXParser.prototype.cagColor=function(e){var t=null;if((e=e.toLowerCase())in ln)t=ln[e],t=[t[0]/255,t[1]/255,t[2]/255];else if("#"==e[0])4==e.length&&(e="#"+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),7==e.length&&(t=[parseInt("0x"+e.slice(1,3))/255,parseInt("0x"+e.slice(3,5))/255,parseInt("0x"+e.slice(5,7))/255]);else{var n=/rgb\(.+,.+,.+\)/,r=n.exec(e);null!==r&&(r=r[0],r=r.slice(r.indexOf("(")+1,r.indexOf(")")),t=r.split(","),r.indexOf("%")>0?(t=[parseInt(t[0]),parseInt(t[1]),parseInt(t[2])],t=[t[0]/100,t[1]/100,t[2]/100]):(t=[parseInt(t[0]),parseInt(t[1]),parseInt(t[2])],t=[t[0]/255,t[1]/255,t[2]/255]))}return t},an.SAXParser.prototype.cssStyle=function(e,t){if("STYLE"in e){var n=e.STYLE,r=t+"\\s*:\\s*\\S+;",o=new RegExp(r,"i"),i=o.exec(n);if(null!==i){i=i[0];for(var s=i.length;" "!=i[s];)s--;return i=i.slice(s+1,i.length-1)}}return null},an.SAXParser.prototype.svgCore=function(e,t){"ID"in t&&(e.id=t.ID)},an.SAXParser.prototype.svgPresentation=function(e,t){if("DISPLAY"in t&&(e.visible=t.DISPLAY),"COLOR"in t&&(e.fill=this.cagColor(t.COLOR)),"OPACITY"in t&&(e.opacity=t.OPACITY),"FILL"in t)e.fill=this.cagColor(t.FILL);else{var n=this.cssStyle(t,"fill");null!==n&&(e.fill=this.cagColor(n))}if("FILL-OPACITY"in t&&(e.opacity=t["FILL-OPACITY"]),"STROKE-WIDTH"in t)e.strokeWidth=t["STROKE-WIDTH"];else{var r=this.cssStyle(t,"stroke-width");null!==r&&(e.strokeWidth=r)}if("STROKE"in t)e.stroke=this.cagColor(t.STROKE);else{var n=this.cssStyle(t,"stroke");null!==n&&(e.stroke=this.cagColor(n))}"STROKE-OPACITY"in t&&(e.strokeOpacity=t["STROKE-OPACITY"])},an.SAXParser.prototype.svgTransforms=function(e,t){var n=null;if("TRANSFORM"in t)n=t.TRANSFORM;else{var r=this.cssStyle(t,"transform");null!==r&&(n=r)}if(null!==n){e.transforms=[];for(var o=new RegExp("\\w+\\(.+\\)","i"),i=o.exec(n);null!==i;){var r=o.lastIndex,s=n.indexOf(")")+1,a=n.slice(r,s);a=a.trim();var l=a.slice(0,a.indexOf("(")),c=a.slice(a.indexOf("(")+1,a.indexOf(")")).trim();switch(c=c.indexOf(",")>0?c.split(","):c.split(" "),l){case"translate":var u={translate:[c[0],c[1]]};e.transforms.push(u);break;case"scale":1==c.length&&c.push(c[0]);var u={scale:[c[0],c[1]]};e.transforms.push(u);break;case"rotate":var u={rotate:c};e.transforms.push(u)}n=n.slice(s,n.length),i=o.exec(n)}}},an.SAXParser.prototype.svgSvg=function(e){var t={type:"svg",x:0,y:0,width:"100%",height:"100%",strokeWidth:"1"};if(t.unitsPmm=[this.pxPmm,this.pxPmm],"PXPMM"in e&&(t.pxPmm=e.PXPMM,t.unitsPmm=[t.pxPmm,t.pxPmm]),"WIDTH"in e&&(t.width=e.WIDTH),"HEIGHT"in e&&(t.height=e.HEIGHT),"VIEWBOX"in e){var n=e.VIEWBOX.trim(),r=new RegExp("([\\d\\.\\-]+)[\\s,]+([\\d\\.\\-]+)[\\s,]+([\\d\\.\\-]+)[\\s,]+([\\d\\.\\-]+)","i"),o=r.exec(n);if(null!==o&&(t.viewX=parseFloat(o[1]),t.viewY=parseFloat(o[2]),t.viewW=parseFloat(o[3]),t.viewH=parseFloat(o[4])),t.width.indexOf("%")<0){var i=this.css2cag(t.width,this.pxPmm);i=t.viewW/i,t.unitsPmm[0]=i}else{var s=t.unitsPmm[0]*(parseFloat(t.width)/100);t.unitsPmm[0]=s}if(t.height.indexOf("%")<0){var i=this.css2cag(t.height,this.pxPmm);i=t.viewH/i,t.unitsPmm[1]=i}else{var s=t.unitsPmm[1]*(parseFloat(t.height)/100);t.unitsPmm[1]=s}}else t.viewX=0,t.viewY=0,t.viewW=1920/t.unitsPmm[0],t.viewH=1080/t.unitsPmm[1];return t.viewP=Math.sqrt(t.viewW*t.viewW+t.viewH*t.viewH)/Math.SQRT2,this.svgCore(t,e),this.svgPresentation(t,e),t.objects=[],t},an.SAXParser.prototype.svgEllipse=function(e){var t={type:"ellipse",cx:"0",cy:"0",rx:"0",ry:"0"};return"CX"in e&&(t.cx=e.CX),"CY"in e&&(t.cy=e.CY),"RX"in e&&(t.rx=e.RX),"RY"in e&&(t.ry=e.RY),this.svgTransforms(t,e),this.svgCore(t,e),this.svgPresentation(t,e),t},an.SAXParser.prototype.svgLine=function(e){var t={type:"line",x1:"0",y1:"0",x2:"0",y2:"0"};return"X1"in e&&(t.x1=e.X1),"Y1"in e&&(t.y1=e.Y1),"X2"in e&&(t.x2=e.X2),"Y2"in e&&(t.y2=e.Y2),this.svgTransforms(t,e),this.svgCore(t,e),this.svgPresentation(t,e),t},an.SAXParser.prototype.svgListOfPoints=function(e){var t=[],n=new RegExp("([\\d\\-\\+\\.]+)[\\s,]+([\\d\\-\\+\\.]+)[\\s,]*","i");e=e.trim();for(var r=n.exec(e);null!==r;){var o=r[0],i=n.lastIndex+o.length;o={x:r[1],y:r[2]},t.push(o),e=e.slice(i,e.length),r=n.exec(e)}return t},an.SAXParser.prototype.svgPolyline=function(e){var t={type:"polyline"};return this.svgTransforms(t,e),this.svgCore(t,e),this.svgPresentation(t,e),"POINTS"in e&&(t.points=this.svgListOfPoints(e.POINTS)),t},an.SAXParser.prototype.svgPolygon=function(e){var t={type:"polygon"};return this.svgTransforms(t,e),this.svgCore(t,e),this.svgPresentation(t,e),"POINTS"in e&&(t.points=this.svgListOfPoints(e.POINTS)),t},an.SAXParser.prototype.svgRect=function(e){var t={type:"rect",x:"0",y:"0",rx:"0",ry:"0",width:"0",height:"0"};return"X"in e&&(t.x=e.X),"Y"in e&&(t.y=e.Y),"RX"in e&&(t.rx=e.RX,"RY"in e||(t.ry=t.rx)),"RY"in e&&(t.ry=e.RY,"RX"in e||(t.rx=t.ry)),t.rx!=t.ry&&console.log("Warning: Unsupported RECT with RX and RY radius"),"WIDTH"in e&&(t.width=e.WIDTH),"HEIGHT"in e&&(t.height=e.HEIGHT),this.svgTransforms(t,e),this.svgCore(t,e),this.svgPresentation(t,e),t},an.SAXParser.prototype.svgCircle=function(e){var t={type:"circle",x:"0",y:"0",radius:"0"};return"CX"in e&&(t.x=e.CX),"CY"in e&&(t.y=e.CY),"R"in e&&(t.radius=e.R),this.svgTransforms(t,e),this.svgCore(t,e),this.svgPresentation(t,e),t},an.SAXParser.prototype.svgGroup=function(e){var t={type:"group"};return this.svgTransforms(t,e),this.svgCore(t,e),this.svgPresentation(t,e),t.objects=[],t},an.SAXParser.prototype.svgPath=function(e){var t={type:"path"};if(this.svgTransforms(t,e),this.svgCore(t,e),t.commands=[],"D"in e){for(var n=null,r="",o=0,i=e.D.length;o<i;){var s=e.D[o];switch(s){case"-":r.length>0&&(n.p.push(r),r=""),r+=s;break;case".":r.length>0&&r.indexOf(".")>=0&&(n.p.push(r),r=""),r+=s;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r+=s;break;case"a":case"A":case"c":case"C":case"h":case"H":case"l":case"L":case"v":case"V":case"m":case"M":case"q":case"Q":case"s":case"S":case"t":case"T":case"z":case"Z":null!==n&&(r.length>0&&(n.p.push(r),r=""),t.commands.push(n)),n={c:s,p:[]};break;case",":case" ":case"\n":null!==n&&r.length>0&&(n.p.push(r),r="")}o++}o==i&&null!==n&&(r.length>0&&n.p.push(r),t.commands.push(n))}return t},an.SAXParser.prototype.svgUse=function(e){var t={type:"group"};if(this.svgTransforms(t,e),this.svgCore(t,e),this.svgPresentation(t,e),"X"in e&&"Y"in e){"transforms"in t||(t.transforms=[]);var n={translate:[e.X,e.Y]};t.transforms.push(n)}if(t.objects=[],"XLINK:HREF"in e){var r=e["XLINK:HREF"];"#"==r[0]&&(r=r.slice(1,r.length)),void 0!==this.svgObjects[r]&&(r=this.svgObjects[r],r=JSON.parse(JSON.stringify(r)),t.objects.push(r))}return t},an.SAXParser.prototype.svgObjects=[],an.SAXParser.prototype.svgGroups=[],an.SAXParser.prototype.svgInDefs=!1,an.SAXParser.prototype.svgObj=null,an.SAXParser.prototype.svgUnitsPmm=[1,1],an.SAXParser.prototype.svgUnitsPer=0,an.SAXParser.prototype.reflect=function(e,t,n,r){var o=e-n,i=t-r;return e==n&&t==n?[e,t]:e==n?[e,r+-i]:t==r?[n+-o,t]:[n+-o,r+-i]},an.SAXParser.prototype.groupValue=function(e){for(var t=this,n=this.svgGroups.length;n>0;){var r=t.svgGroups[n-1];if(e in r)return r[e];n--}return null},an.SAXParser.prototype.codify=function(e){var t=this,n=this.svgGroups.length;this.svgGroups.push(e);for(var r="  ",o=n;o>0;)r+="  ",o--;var i="";0==n&&(i+="function main(params) {\n");var s="cag"+n;for(i+=r+"var "+s+" = new CAG();\n",o=0;o<e.objects.length;o++){var a=e.objects[o],l=s+o;switch(a.type){case"group":i+=t.codify(a),i+=r+"var "+l+" = cag"+(n+1)+";\n";break;case"rect":var c=t.cagLengthX(a.x),u=0-t.cagLengthY(a.y),h=t.cagLengthX(a.width),p=t.cagLengthY(a.height),f=t.cagLengthX(a.rx),d=t.cagLengthY(a.ry);h>0&&p>0&&(c=(c+h/2).toFixed(4),u=(u-p/2).toFixed(4),i+=0==f?r+"var "+l+" = CAG.rectangle({center: ["+c+","+u+"], radius: ["+h/2+","+p/2+"]});\n":r+"var "+l+" = CAG.roundedRectangle({center: ["+c+","+u+"], radius: ["+h/2+","+p/2+"], roundradius: "+f+"});\n");break;case"circle":var c=t.cagLengthX(a.x),u=0-t.cagLengthY(a.y),g=t.cagLengthP(a.radius);g>0&&(i+=r+"var "+l+" = CAG.circle({center: ["+c+","+u+"], radius: "+g+"});\n");break;case"ellipse":var f=t.cagLengthX(a.rx),d=t.cagLengthY(a.ry),m=t.cagLengthX(a.cx),v=0-t.cagLengthY(a.cy);f>0&&d>0&&(i+=r+"var "+l+" = CAG.ellipse({center: ["+m+","+v+"], radius: ["+f+","+d+"]});\n");break;case"line":var C=t.cagLengthX(a.x1),S=0-t.cagLengthY(a.y1),y=t.cagLengthX(a.x2),w=0-t.cagLengthY(a.y2),g=.2822222;if("strokeWidth"in a)g=t.cagLengthP(a.strokeWidth)/2;else{var x=t.groupValue("strokeWidth");null!==x&&(g=t.cagLengthP(x)/2)}i+=r+"var "+l+" = new CSG.Path2D([["+C+","+S+"],["+y+","+w+"]],false);\n",i+=r+l+" = "+l+".expandToCAG("+g+",CSG.defaultResolution2D);\n";break;case"polygon":i+=r+"var "+l+" = new CSG.Path2D([\n";var G=0;for(G=0;G<a.points.length;G++){var b=a.points[G];if("x"in b&&"y"in b){var c=t.cagLengthX(b.x),u=0-t.cagLengthY(b.y);i+=r+"  ["+c+","+u+"],\n"}}i+=r+"],true);\n",i+=r+l+" = "+l+".innerToCAG();\n";break;case"polyline":var g=.2822222;if("strokeWidth"in a)g=t.cagLengthP(a.strokeWidth)/2;else{var x=t.groupValue("strokeWidth");null!==x&&(g=t.cagLengthP(x)/2)}i+=r+"var "+l+" = new CSG.Path2D([\n";var G=0;for(G=0;G<a.points.length;G++){var b=a.points[G];if("x"in b&&"y"in b){var c=t.cagLengthX(b.x),u=0-t.cagLengthY(b.y);i+=r+"  ["+c+","+u+"],\n"}}i+=r+"],false);\n",i+=r+l+" = "+l+".expandToCAG("+g+",CSG.defaultResolution2D);\n";break;case"path":i+=r+"var "+l+" = new CAG();\n";var g=.2822222;if("strokeWidth"in a)g=t.cagLengthP(a.strokeWidth)/2;else{var x=t.groupValue("strokeWidth");null!==x&&(g=t.cagLengthP(x)/2)}var $=0,T=0,m=0,v=0,_=0,D=l+_,P=!1,A=0,E=0,N=0,I=0,G=0;for(G=0;G<a.commands.length;G++){var O=a.commands[G],V=O.p;switch(O.c){case"m":0==G&&(m=0,v=0),_>0&&!1===P&&(i+=r+D+" = "+D+".expandToCAG("+g+",CSG.defaultResolution2D);\n"),V.length>=2&&(m+=parseFloat(V.shift()),v+=parseFloat(V.shift()),_++,D=l+_,P=!1,i+=r+"var "+D+" = new CSG.Path2D([["+t.svg2cagX(m)+","+t.svg2cagY(v)+"]],false);\n",$=m,T=v);break;case"M":_>0&&!1===P&&(i+=r+D+" = "+D+".expandToCAG("+g+",CSG.defaultResolution2D);\n"),V.length>=2&&(m=parseFloat(V.shift()),v=parseFloat(V.shift()),_++,D=l+_,P=!1,i+=r+"var "+D+" = new CSG.Path2D([["+t.svg2cagX(m)+","+t.svg2cagY(v)+"]],false);\n",$=m,T=v);break;case"a":for(;V.length>=7;){var f=parseFloat(V.shift()),d=parseFloat(V.shift()),M=0-parseFloat(V.shift()),F="1"==V.shift(),k="1"==V.shift();m+=parseFloat(V.shift()),v+=parseFloat(V.shift()),i+=r+D+" = "+D+".appendArc(["+t.svg2cagX(m)+","+t.svg2cagY(v)+"],{xradius: "+t.svg2cagX(f)+",yradius: "+t.svg2cagY(d)+",xaxisrotation: "+M+",clockwise: "+k+",large: "+F+"});\n"}break;case"A":for(;V.length>=7;){var f=parseFloat(V.shift()),d=parseFloat(V.shift()),M=0-parseFloat(V.shift()),F="1"==V.shift(),k="1"==V.shift();m=parseFloat(V.shift()),v=parseFloat(V.shift()),i+=r+D+" = "+D+".appendArc(["+t.svg2cagX(m)+","+t.svg2cagY(v)+"],{xradius: "+t.svg2cagX(f)+",yradius: "+t.svg2cagY(d)+",xaxisrotation: "+M+",clockwise: "+k+",large: "+F+"});\n"}break;case"c":for(;V.length>=6;){var C=m+parseFloat(V.shift()),S=v+parseFloat(V.shift());A=m+parseFloat(V.shift()),E=v+parseFloat(V.shift()),m+=parseFloat(V.shift()),v+=parseFloat(V.shift()),i+=r+D+" = "+D+".appendBezier([["+t.svg2cagX(C)+","+t.svg2cagY(S)+"],["+t.svg2cagX(A)+","+t.svg2cagY(E)+"],["+t.svg2cagX(m)+","+t.svg2cagY(v)+"]]);\n";var R=t.reflect(A,E,m,v);A=R[0],E=R[1]}break;case"C":for(;V.length>=6;){var C=parseFloat(V.shift()),S=parseFloat(V.shift());A=parseFloat(V.shift()),E=parseFloat(V.shift()),m=parseFloat(V.shift()),v=parseFloat(V.shift()),i+=r+D+" = "+D+".appendBezier([["+t.svg2cagX(C)+","+t.svg2cagY(S)+"],["+t.svg2cagX(A)+","+t.svg2cagY(E)+"],["+t.svg2cagX(m)+","+t.svg2cagY(v)+"]]);\n";var R=t.reflect(A,E,m,v);A=R[0],E=R[1]}break;case"q":for(;V.length>=4;){N=m+parseFloat(V.shift()),I=v+parseFloat(V.shift()),m+=parseFloat(V.shift()),v+=parseFloat(V.shift()),i+=r+D+" = "+D+".appendBezier([["+t.svg2cagX(N)+","+t.svg2cagY(I)+"],["+t.svg2cagX(N)+","+t.svg2cagY(I)+"],["+t.svg2cagX(m)+","+t.svg2cagY(v)+"]]);\n";var R=t.reflect(N,I,m,v);N=R[0],I=R[1]}break;case"Q":for(;V.length>=4;){N=parseFloat(V.shift()),I=parseFloat(V.shift()),m=parseFloat(V.shift()),v=parseFloat(V.shift()),i+=r+D+" = "+D+".appendBezier([["+t.svg2cagX(N)+","+t.svg2cagY(I)+"],["+t.svg2cagX(N)+","+t.svg2cagY(I)+"],["+t.svg2cagX(m)+","+t.svg2cagY(v)+"]]);\n";var R=t.reflect(N,I,m,v);N=R[0],I=R[1]}break;case"t":for(;V.length>=2;){m+=parseFloat(V.shift()),v+=parseFloat(V.shift()),i+=r+D+" = "+D+".appendBezier([["+t.svg2cagX(N)+","+t.svg2cagY(I)+"],["+t.svg2cagX(N)+","+t.svg2cagY(I)+"],["+m+","+v+"]]);\n";var R=t.reflect(N,I,m,v);N=R[0],I=R[1]}break;case"T":for(;V.length>=2;){m=parseFloat(V.shift()),v=parseFloat(V.shift()),i+=r+D+" = "+D+".appendBezier([["+t.svg2cagX(N)+","+t.svg2cagY(I)+"],["+t.svg2cagX(N)+","+t.svg2cagY(I)+"],["+t.svg2cagX(m)+","+t.svg2cagY(v)+"]]);\n";var R=t.reflect(N,I,m,v);N=R[0],I=R[1]}break;case"s":for(;V.length>=4;){var C=A,S=E;A=m+parseFloat(V.shift()),E=v+parseFloat(V.shift()),m+=parseFloat(V.shift()),v+=parseFloat(V.shift()),i+=r+D+" = "+D+".appendBezier([["+t.svg2cagX(C)+","+t.svg2cagY(S)+"],["+t.svg2cagX(A)+","+t.svg2cagY(E)+"],["+t.svg2cagX(m)+","+t.svg2cagY(v)+"]]);\n";var R=t.reflect(A,E,m,v);A=R[0],E=R[1]}break;case"S":for(;V.length>=4;){var C=A,S=E;A=parseFloat(V.shift()),E=parseFloat(V.shift()),m=parseFloat(V.shift()),v=parseFloat(V.shift()),i+=r+D+" = "+D+".appendBezier([["+t.svg2cagX(C)+","+t.svg2cagY(S)+"],["+t.svg2cagX(A)+","+t.svg2cagY(E)+"],["+t.svg2cagX(m)+","+t.svg2cagY(v)+"]]);\n";var R=t.reflect(A,E,m,v);A=R[0],E=R[1]}break;case"h":for(;V.length>=1;)m+=parseFloat(V.shift()),i+=r+D+" = "+D+".appendPoint(["+t.svg2cagX(m)+","+t.svg2cagY(v)+"]);\n";break;case"H":for(;V.length>=1;)m=parseFloat(V.shift()),i+=r+D+" = "+D+".appendPoint(["+t.svg2cagX(m)+","+t.svg2cagY(v)+"]);\n";break;case"l":for(;V.length>=2;)m+=parseFloat(V.shift()),v+=parseFloat(V.shift()),i+=r+D+" = "+D+".appendPoint(["+t.svg2cagX(m)+","+t.svg2cagY(v)+"]);\n";break;case"L":for(;V.length>=2;)m=parseFloat(V.shift()),v=parseFloat(V.shift()),i+=r+D+" = "+D+".appendPoint(["+t.svg2cagX(m)+","+t.svg2cagY(v)+"]);\n";break;case"v":for(;V.length>=1;)v+=parseFloat(V.shift()),i+=r+D+" = "+D+".appendPoint(["+t.svg2cagX(m)+","+t.svg2cagY(v)+"]);\n";break;case"V":for(;V.length>=1;)v=parseFloat(V.shift()),i+=r+D+" = "+D+".appendPoint(["+t.svg2cagX(m)+","+t.svg2cagY(v)+"]);\n";break;case"z":case"Z":i+=r+D+" = "+D+".close();\n",i+=r+D+" = "+D+".innerToCAG();\n",i+=r+l+" = "+l+".union("+D+");\n",m=$,v=T,P=!0;break;default:console.log("Warning: Unknow PATH command ["+O.c+"]")}}_>0&&!1===P&&(i+=r+D+" = "+D+".expandToCAG("+g+",CSG.defaultResolution2D);\n",i+=r+l+" = "+l+".union("+D+");\n")}if("transforms"in a){var L=null,j=null,z=null,G=0;for(G=0;G<a.transforms.length;G++){var B=a.transforms[G];"rotate"in B&&(L=B),"scale"in B&&(j=B),"translate"in B&&(z=B)}if(null!==j){var c=j.scale[0],u=j.scale[1];i+=r+l+" = "+l+".scale(["+c+","+u+"]);\n"}if(null!==L){i+=r+l+" = "+l+".rotateZ("+(0-L.rotate)+");\n"}if(null!==z){var c=t.cagLengthX(z.translate[0]),u=0-t.cagLengthY(z.translate[1]);i+=r+l+" = "+l+".translate(["+c+","+u+"]);\n"}}i+=r+s+" = "+s+".union("+l+");\n"}return 0==n&&(i+=r+"return "+s+";\n",i+="}\n"),this.svgGroups.pop(),i},t.makeBlob=n,t.revokeBlobUrl=o,t.CAGToDxf=i,t.CAGToJson=a,t.CAGToSvg=l,t.CSGToAMF=u,t.CSGToJson=f,t.CSGToStla=d,t.CSGToStlb=C,t.CSGToX3D=Se,t.parseAMF=We,t.parseGCode=He,t.parseJSON=nt,t.parseOBJ=ot,t.parseSTL=it,t.parseSVG=ut}),index_1=index$1.makeBlob,index_3=index$1.CAGToDxf,index_4=index$1.CAGToJson,index_5=index$1.CAGToSvg,index_6=index$1.CSGToAMF,index_8=index$1.CSGToStla,index_9=index$1.CSGToStlb,index_10=index$1.CSGToX3D,Blob$1=index_1(),esprima=require("esprima"),estraverse=require("estraverse"),astring=require("astring");module.exports={generateOutput:generateOutput,compile:compile};
//# sourceMappingURL=module.js.map
